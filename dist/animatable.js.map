{"version":3,"file":"animatable.js","sources":["../node_modules/lodash.isnumber/index.js","../node_modules/lodash.isplainobject/index.js","../node_modules/lodash.isstring/index.js","../node_modules/css-tree-animatable/lib/common/List.js","../node_modules/css-tree-animatable/lib/utils/createCustomError.js","../node_modules/css-tree-animatable/lib/common/SyntaxError.js","../node_modules/css-tree-animatable/lib/tokenizer/const.js","../node_modules/css-tree-animatable/lib/tokenizer/char-code-definitions.js","../node_modules/css-tree-animatable/lib/tokenizer/utils.js","../node_modules/css-tree-animatable/lib/common/TokenStream.js","../node_modules/css-tree-animatable/lib/definition-syntax/generate.js","../node_modules/css-tree-animatable/lib/lexer/error.js","../node_modules/css-tree-animatable/lib/utils/names.js","../node_modules/css-tree-animatable/lib/common/adopt-buffer.js","../node_modules/css-tree-animatable/lib/tokenizer/index.js","../node_modules/css-tree-animatable/lib/lexer/generic-an-plus-b.js","../node_modules/css-tree-animatable/lib/lexer/generic-urange.js","../node_modules/css-tree-animatable/lib/lexer/generic.js","../node_modules/css-tree-animatable/lib/definition-syntax/SyntaxError.js","../node_modules/css-tree-animatable/lib/definition-syntax/tokenizer.js","../node_modules/css-tree-animatable/lib/definition-syntax/parse.js","../node_modules/css-tree-animatable/lib/definition-syntax/walk.js","../node_modules/css-tree-animatable/lib/lexer/prepare-tokens.js","../node_modules/css-tree-animatable/lib/lexer/match-graph.js","../node_modules/css-tree-animatable/lib/lexer/match.js","../node_modules/css-tree-animatable/lib/lexer/trace.js","../node_modules/css-tree-animatable/lib/lexer/search.js","../node_modules/css-tree-animatable/lib/lexer/structure.js","../node_modules/css-tree-animatable/lib/lexer/Lexer.js","../node_modules/css-tree-animatable/lib/definition-syntax/index.js","../node_modules/css-tree-animatable/lib/common/OffsetToLocation.js","../node_modules/css-tree-animatable/lib/parser/sequence.js","../node_modules/css-tree-animatable/lib/parser/create.js","../node_modules/css-tree-animatable/lib/generator/create.js","../node_modules/css-tree-animatable/lib/convertor/create.js","../node_modules/css-tree-animatable/lib/walker/create.js","../node_modules/css-tree-animatable/lib/utils/clone.js","../node_modules/css-tree-animatable/lib/syntax/config/mix.js","../node_modules/css-tree-animatable/lib/syntax/create.js","../node_modules/css-tree-animatable/data/index.js","../node_modules/css-tree-animatable/lib/syntax/node/AnPlusB.js","../node_modules/css-tree-animatable/lib/syntax/node/Raw.js","../node_modules/css-tree-animatable/lib/syntax/node/Atrule.js","../node_modules/css-tree-animatable/lib/syntax/node/AtrulePrelude.js","../node_modules/css-tree-animatable/lib/syntax/node/AttributeSelector.js","../node_modules/css-tree-animatable/lib/syntax/node/Block.js","../node_modules/css-tree-animatable/lib/syntax/node/Brackets.js","../node_modules/css-tree-animatable/lib/syntax/node/CDC.js","../node_modules/css-tree-animatable/lib/syntax/node/CDO.js","../node_modules/css-tree-animatable/lib/syntax/node/ClassSelector.js","../node_modules/css-tree-animatable/lib/syntax/node/Combinator.js","../node_modules/css-tree-animatable/lib/syntax/node/Comment.js","../node_modules/css-tree-animatable/lib/syntax/node/Declaration.js","../node_modules/css-tree-animatable/lib/syntax/node/DeclarationList.js","../node_modules/css-tree-animatable/lib/syntax/node/Dimension.js","../node_modules/css-tree-animatable/lib/syntax/node/Function.js","../node_modules/css-tree-animatable/lib/syntax/node/HexColor.js","../node_modules/css-tree-animatable/lib/syntax/node/Identifier.js","../node_modules/css-tree-animatable/lib/syntax/node/IdSelector.js","../node_modules/css-tree-animatable/lib/syntax/node/MediaFeature.js","../node_modules/css-tree-animatable/lib/syntax/node/MediaQuery.js","../node_modules/css-tree-animatable/lib/syntax/node/MediaQueryList.js","../node_modules/css-tree-animatable/lib/syntax/node/Number.js","../node_modules/css-tree-animatable/lib/syntax/node/Operator.js","../node_modules/css-tree-animatable/lib/syntax/node/Parentheses.js","../node_modules/css-tree-animatable/lib/syntax/node/Percentage.js","../node_modules/css-tree-animatable/lib/syntax/node/PseudoClassSelector.js","../node_modules/css-tree-animatable/lib/syntax/node/PseudoElementSelector.js","../node_modules/css-tree-animatable/lib/syntax/node/Ratio.js","../node_modules/css-tree-animatable/lib/syntax/node/Rule.js","../node_modules/css-tree-animatable/lib/syntax/node/SelectorList.js","../node_modules/css-tree-animatable/lib/syntax/node/String.js","../node_modules/css-tree-animatable/lib/syntax/node/StyleSheet.js","../node_modules/css-tree-animatable/lib/syntax/node/TypeSelector.js","../node_modules/css-tree-animatable/lib/syntax/node/UnicodeRange.js","../node_modules/css-tree-animatable/lib/syntax/node/Url.js","../node_modules/css-tree-animatable/lib/syntax/node/WhiteSpace.js","../node_modules/css-tree-animatable/lib/syntax/node/index.js","../node_modules/css-tree-animatable/lib/syntax/node/Nth.js","../node_modules/css-tree-animatable/lib/syntax/node/Selector.js","../node_modules/css-tree-animatable/lib/syntax/node/Value.js","../node_modules/css-tree-animatable/lib/syntax/config/lexer.js","../node_modules/css-tree-animatable/lib/syntax/scope/default.js","../node_modules/css-tree-animatable/lib/syntax/scope/atrulePrelude.js","../node_modules/css-tree-animatable/lib/syntax/scope/selector.js","../node_modules/css-tree-animatable/lib/syntax/function/element.js","../node_modules/css-tree-animatable/lib/syntax/function/var.js","../node_modules/css-tree-animatable/lib/syntax/scope/index.js","../node_modules/css-tree-animatable/lib/syntax/scope/value.js","../node_modules/css-tree-animatable/lib/syntax/function/expression.js","../node_modules/css-tree-animatable/lib/syntax/atrule/import.js","../node_modules/css-tree-animatable/lib/syntax/atrule/supports.js","../node_modules/css-tree-animatable/lib/syntax/pseudo/common/selectorList.js","../node_modules/css-tree-animatable/lib/syntax/pseudo/common/nthWithOfClause.js","../node_modules/css-tree-animatable/lib/syntax/pseudo/common/nth.js","../node_modules/css-tree-animatable/lib/syntax/config/parser.js","../node_modules/css-tree-animatable/lib/syntax/atrule/index.js","../node_modules/css-tree-animatable/lib/syntax/atrule/font-face.js","../node_modules/css-tree-animatable/lib/syntax/atrule/media.js","../node_modules/css-tree-animatable/lib/syntax/atrule/page.js","../node_modules/css-tree-animatable/lib/syntax/pseudo/index.js","../node_modules/css-tree-animatable/lib/syntax/pseudo/dir.js","../node_modules/css-tree-animatable/lib/syntax/pseudo/has.js","../node_modules/css-tree-animatable/lib/syntax/pseudo/lang.js","../node_modules/css-tree-animatable/lib/syntax/pseudo/matches.js","../node_modules/css-tree-animatable/lib/syntax/pseudo/not.js","../node_modules/css-tree-animatable/lib/syntax/pseudo/nth-child.js","../node_modules/css-tree-animatable/lib/syntax/pseudo/nth-last-child.js","../node_modules/css-tree-animatable/lib/syntax/pseudo/nth-last-of-type.js","../node_modules/css-tree-animatable/lib/syntax/pseudo/nth-of-type.js","../node_modules/css-tree-animatable/lib/syntax/pseudo/slotted.js","../node_modules/css-tree-animatable/lib/syntax/config/walker.js","../node_modules/css-tree-animatable/lib/index.js","../node_modules/css-tree-animatable/lib/syntax/index.js","../src/functions.js","../src/arrays.js","../src/index.js"],"sourcesContent":["/**\n * lodash 3.0.3 (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright 2012-2016 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2016 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/** `Object#toString` result references. */\nvar numberTag = '[object Number]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Number` primitive or object.\n *\n * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are classified\n * as numbers, use the `_.isFinite` method.\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n * @example\n *\n * _.isNumber(3);\n * // => true\n *\n * _.isNumber(Number.MIN_VALUE);\n * // => true\n *\n * _.isNumber(Infinity);\n * // => true\n *\n * _.isNumber('3');\n * // => false\n */\nfunction isNumber(value) {\n  return typeof value == 'number' ||\n    (isObjectLike(value) && objectToString.call(value) == numberTag);\n}\n\nmodule.exports = isNumber;\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/**\n * Checks if `value` is a host object in IE < 9.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a host object, else `false`.\n */\nfunction isHostObject(value) {\n  // Many host objects are `Object` objects that can coerce to strings\n  // despite having improperly defined `toString` methods.\n  var result = false;\n  if (value != null && typeof value.toString != 'function') {\n    try {\n      result = !!(value + '');\n    } catch (e) {}\n  }\n  return result;\n}\n\n/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) ||\n      objectToString.call(value) != objectTag || isHostObject(value)) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return (typeof Ctor == 'function' &&\n    Ctor instanceof Ctor && funcToString.call(Ctor) == objectCtorString);\n}\n\nmodule.exports = isPlainObject;\n","/**\n * lodash 4.0.1 (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright 2012-2016 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2016 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/** `Object#toString` result references. */\nvar stringTag = '[object String]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @type Function\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `String` primitive or object.\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n * @example\n *\n * _.isString('abc');\n * // => true\n *\n * _.isString(1);\n * // => false\n */\nfunction isString(value) {\n  return typeof value == 'string' ||\n    (!isArray(value) && isObjectLike(value) && objectToString.call(value) == stringTag);\n}\n\nmodule.exports = isString;\n","//\r\n//                              list\r\n//                            ┌──────┐\r\n//             ┌──────────────┼─head │\r\n//             │              │ tail─┼──────────────┐\r\n//             │              └──────┘              │\r\n//             ▼                                    ▼\r\n//            item        item        item        item\r\n//          ┌──────┐    ┌──────┐    ┌──────┐    ┌──────┐\r\n//  null ◀──┼─prev │◀───┼─prev │◀───┼─prev │◀───┼─prev │\r\n//          │ next─┼───▶│ next─┼───▶│ next─┼───▶│ next─┼──▶ null\r\n//          ├──────┤    ├──────┤    ├──────┤    ├──────┤\r\n//          │ data │    │ data │    │ data │    │ data │\r\n//          └──────┘    └──────┘    └──────┘    └──────┘\r\n//\r\n\r\nfunction createItem(data) {\r\n    return {\r\n        prev: null,\r\n        next: null,\r\n        data: data\r\n    };\r\n}\r\n\r\nfunction allocateCursor(node, prev, next) {\r\n    var cursor;\r\n\r\n    if (cursors !== null) {\r\n        cursor = cursors;\r\n        cursors = cursors.cursor;\r\n        cursor.prev = prev;\r\n        cursor.next = next;\r\n        cursor.cursor = node.cursor;\r\n    } else {\r\n        cursor = {\r\n            prev: prev,\r\n            next: next,\r\n            cursor: node.cursor\r\n        };\r\n    }\r\n\r\n    node.cursor = cursor;\r\n\r\n    return cursor;\r\n}\r\n\r\nfunction releaseCursor(node) {\r\n    var cursor = node.cursor;\r\n\r\n    node.cursor = cursor.cursor;\r\n    cursor.prev = null;\r\n    cursor.next = null;\r\n    cursor.cursor = cursors;\r\n    cursors = cursor;\r\n}\r\n\r\nvar cursors = null;\r\nvar List = function() {\r\n    this.cursor = null;\r\n    this.head = null;\r\n    this.tail = null;\r\n};\r\n\r\nList.createItem = createItem;\r\nList.prototype.createItem = createItem;\r\n\r\nList.prototype.updateCursors = function(prevOld, prevNew, nextOld, nextNew) {\r\n    var cursor = this.cursor;\r\n\r\n    while (cursor !== null) {\r\n        if (cursor.prev === prevOld) {\r\n            cursor.prev = prevNew;\r\n        }\r\n\r\n        if (cursor.next === nextOld) {\r\n            cursor.next = nextNew;\r\n        }\r\n\r\n        cursor = cursor.cursor;\r\n    }\r\n};\r\n\r\nList.prototype.getSize = function() {\r\n    var size = 0;\r\n    var cursor = this.head;\r\n\r\n    while (cursor) {\r\n        size++;\r\n        cursor = cursor.next;\r\n    }\r\n\r\n    return size;\r\n};\r\n\r\nList.prototype.fromArray = function(array) {\r\n    var cursor = null;\r\n\r\n    this.head = null;\r\n\r\n    for (var i = 0; i < array.length; i++) {\r\n        var item = createItem(array[i]);\r\n\r\n        if (cursor !== null) {\r\n            cursor.next = item;\r\n        } else {\r\n            this.head = item;\r\n        }\r\n\r\n        item.prev = cursor;\r\n        cursor = item;\r\n    }\r\n\r\n    this.tail = cursor;\r\n\r\n    return this;\r\n};\r\n\r\nList.prototype.toArray = function() {\r\n    var cursor = this.head;\r\n    var result = [];\r\n\r\n    while (cursor) {\r\n        result.push(cursor.data);\r\n        cursor = cursor.next;\r\n    }\r\n\r\n    return result;\r\n};\r\n\r\nList.prototype.toJSON = List.prototype.toArray;\r\n\r\nList.prototype.isEmpty = function() {\r\n    return this.head === null;\r\n};\r\n\r\nList.prototype.first = function() {\r\n    return this.head && this.head.data;\r\n};\r\n\r\nList.prototype.last = function() {\r\n    return this.tail && this.tail.data;\r\n};\r\n\r\nList.prototype.each = function(fn, context) {\r\n    var item;\r\n\r\n    if (context === undefined) {\r\n        context = this;\r\n    }\r\n\r\n    // push cursor\r\n    var cursor = allocateCursor(this, null, this.head);\r\n\r\n    while (cursor.next !== null) {\r\n        item = cursor.next;\r\n        cursor.next = item.next;\r\n\r\n        fn.call(context, item.data, item, this);\r\n    }\r\n\r\n    // pop cursor\r\n    releaseCursor(this);\r\n};\r\n\r\nList.prototype.forEach = List.prototype.each;\r\n\r\nList.prototype.eachRight = function(fn, context) {\r\n    var item;\r\n\r\n    if (context === undefined) {\r\n        context = this;\r\n    }\r\n\r\n    // push cursor\r\n    var cursor = allocateCursor(this, this.tail, null);\r\n\r\n    while (cursor.prev !== null) {\r\n        item = cursor.prev;\r\n        cursor.prev = item.prev;\r\n\r\n        fn.call(context, item.data, item, this);\r\n    }\r\n\r\n    // pop cursor\r\n    releaseCursor(this);\r\n};\r\n\r\nList.prototype.forEachRight = List.prototype.eachRight;\r\n\r\nList.prototype.nextUntil = function(start, fn, context) {\r\n    if (start === null) {\r\n        return;\r\n    }\r\n\r\n    var item;\r\n\r\n    if (context === undefined) {\r\n        context = this;\r\n    }\r\n\r\n    // push cursor\r\n    var cursor = allocateCursor(this, null, start);\r\n\r\n    while (cursor.next !== null) {\r\n        item = cursor.next;\r\n        cursor.next = item.next;\r\n\r\n        if (fn.call(context, item.data, item, this)) {\r\n            break;\r\n        }\r\n    }\r\n\r\n    // pop cursor\r\n    releaseCursor(this);\r\n};\r\n\r\nList.prototype.prevUntil = function(start, fn, context) {\r\n    if (start === null) {\r\n        return;\r\n    }\r\n\r\n    var item;\r\n\r\n    if (context === undefined) {\r\n        context = this;\r\n    }\r\n\r\n    // push cursor\r\n    var cursor = allocateCursor(this, start, null);\r\n\r\n    while (cursor.prev !== null) {\r\n        item = cursor.prev;\r\n        cursor.prev = item.prev;\r\n\r\n        if (fn.call(context, item.data, item, this)) {\r\n            break;\r\n        }\r\n    }\r\n\r\n    // pop cursor\r\n    releaseCursor(this);\r\n};\r\n\r\nList.prototype.some = function(fn, context) {\r\n    var cursor = this.head;\r\n\r\n    if (context === undefined) {\r\n        context = this;\r\n    }\r\n\r\n    while (cursor !== null) {\r\n        if (fn.call(context, cursor.data, cursor, this)) {\r\n            return true;\r\n        }\r\n\r\n        cursor = cursor.next;\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\nList.prototype.map = function(fn, context) {\r\n    var result = new List();\r\n    var cursor = this.head;\r\n\r\n    if (context === undefined) {\r\n        context = this;\r\n    }\r\n\r\n    while (cursor !== null) {\r\n        result.appendData(fn.call(context, cursor.data, cursor, this));\r\n        cursor = cursor.next;\r\n    }\r\n\r\n    return result;\r\n};\r\n\r\nList.prototype.filter = function(fn, context) {\r\n    var result = new List();\r\n    var cursor = this.head;\r\n\r\n    if (context === undefined) {\r\n        context = this;\r\n    }\r\n\r\n    while (cursor !== null) {\r\n        if (fn.call(context, cursor.data, cursor, this)) {\r\n            result.appendData(cursor.data);\r\n        }\r\n        cursor = cursor.next;\r\n    }\r\n\r\n    return result;\r\n};\r\n\r\nList.prototype.clear = function() {\r\n    this.head = null;\r\n    this.tail = null;\r\n};\r\n\r\nList.prototype.copy = function() {\r\n    var result = new List();\r\n    var cursor = this.head;\r\n\r\n    while (cursor !== null) {\r\n        result.insert(createItem(cursor.data));\r\n        cursor = cursor.next;\r\n    }\r\n\r\n    return result;\r\n};\r\n\r\nList.prototype.prepend = function(item) {\r\n    //      head\r\n    //    ^\r\n    // item\r\n    this.updateCursors(null, item, this.head, item);\r\n\r\n    // insert to the beginning of the list\r\n    if (this.head !== null) {\r\n        // new item <- first item\r\n        this.head.prev = item;\r\n\r\n        // new item -> first item\r\n        item.next = this.head;\r\n    } else {\r\n        // if list has no head, then it also has no tail\r\n        // in this case tail points to the new item\r\n        this.tail = item;\r\n    }\r\n\r\n    // head always points to new item\r\n    this.head = item;\r\n\r\n    return this;\r\n};\r\n\r\nList.prototype.prependData = function(data) {\r\n    return this.prepend(createItem(data));\r\n};\r\n\r\nList.prototype.append = function(item) {\r\n    return this.insert(item);\r\n};\r\n\r\nList.prototype.appendData = function(data) {\r\n    return this.insert(createItem(data));\r\n};\r\n\r\nList.prototype.insert = function(item, before) {\r\n    if (before !== undefined && before !== null) {\r\n        // prev   before\r\n        //      ^\r\n        //     item\r\n        this.updateCursors(before.prev, item, before, item);\r\n\r\n        if (before.prev === null) {\r\n            // insert to the beginning of list\r\n            if (this.head !== before) {\r\n                throw new Error('before doesn\\'t belong to list');\r\n            }\r\n\r\n            // since head points to before therefore list doesn't empty\r\n            // no need to check tail\r\n            this.head = item;\r\n            before.prev = item;\r\n            item.next = before;\r\n\r\n            this.updateCursors(null, item);\r\n        } else {\r\n\r\n            // insert between two items\r\n            before.prev.next = item;\r\n            item.prev = before.prev;\r\n\r\n            before.prev = item;\r\n            item.next = before;\r\n        }\r\n    } else {\r\n        // tail\r\n        //      ^\r\n        //      item\r\n        this.updateCursors(this.tail, item, null, item);\r\n\r\n        // insert to the ending of the list\r\n        if (this.tail !== null) {\r\n            // last item -> new item\r\n            this.tail.next = item;\r\n\r\n            // last item <- new item\r\n            item.prev = this.tail;\r\n        } else {\r\n            // if list has no tail, then it also has no head\r\n            // in this case head points to new item\r\n            this.head = item;\r\n        }\r\n\r\n        // tail always points to new item\r\n        this.tail = item;\r\n    }\r\n\r\n    return this;\r\n};\r\n\r\nList.prototype.insertData = function(data, before) {\r\n    return this.insert(createItem(data), before);\r\n};\r\n\r\nList.prototype.remove = function(item) {\r\n    //      item\r\n    //       ^\r\n    // prev     next\r\n    this.updateCursors(item, item.prev, item, item.next);\r\n\r\n    if (item.prev !== null) {\r\n        item.prev.next = item.next;\r\n    } else {\r\n        if (this.head !== item) {\r\n            throw new Error('item doesn\\'t belong to list');\r\n        }\r\n\r\n        this.head = item.next;\r\n    }\r\n\r\n    if (item.next !== null) {\r\n        item.next.prev = item.prev;\r\n    } else {\r\n        if (this.tail !== item) {\r\n            throw new Error('item doesn\\'t belong to list');\r\n        }\r\n\r\n        this.tail = item.prev;\r\n    }\r\n\r\n    item.prev = null;\r\n    item.next = null;\r\n\r\n    return item;\r\n};\r\n\r\nList.prototype.push = function(data) {\r\n    this.insert(createItem(data));\r\n};\r\n\r\nList.prototype.pop = function() {\r\n    if (this.tail !== null) {\r\n        return this.remove(this.tail);\r\n    }\r\n};\r\n\r\nList.prototype.unshift = function(data) {\r\n    this.prepend(createItem(data));\r\n};\r\n\r\nList.prototype.shift = function() {\r\n    if (this.head !== null) {\r\n        return this.remove(this.head);\r\n    }\r\n};\r\n\r\nList.prototype.prependList = function(list) {\r\n    return this.insertList(list, this.head);\r\n};\r\n\r\nList.prototype.appendList = function(list) {\r\n    return this.insertList(list);\r\n};\r\n\r\nList.prototype.insertList = function(list, before) {\r\n    // ignore empty lists\r\n    if (list.head === null) {\r\n        return this;\r\n    }\r\n\r\n    if (before !== undefined && before !== null) {\r\n        this.updateCursors(before.prev, list.tail, before, list.head);\r\n\r\n        // insert in the middle of dist list\r\n        if (before.prev !== null) {\r\n            // before.prev <-> list.head\r\n            before.prev.next = list.head;\r\n            list.head.prev = before.prev;\r\n        } else {\r\n            this.head = list.head;\r\n        }\r\n\r\n        before.prev = list.tail;\r\n        list.tail.next = before;\r\n    } else {\r\n        this.updateCursors(this.tail, list.tail, null, list.head);\r\n\r\n        // insert to end of the list\r\n        if (this.tail !== null) {\r\n            // if destination list has a tail, then it also has a head,\r\n            // but head doesn't change\r\n\r\n            // dest tail -> source head\r\n            this.tail.next = list.head;\r\n\r\n            // dest tail <- source head\r\n            list.head.prev = this.tail;\r\n        } else {\r\n            // if list has no a tail, then it also has no a head\r\n            // in this case points head to new item\r\n            this.head = list.head;\r\n        }\r\n\r\n        // tail always start point to new item\r\n        this.tail = list.tail;\r\n    }\r\n\r\n    list.head = null;\r\n    list.tail = null;\r\n\r\n    return this;\r\n};\r\n\r\nList.prototype.replace = function(oldItem, newItemOrList) {\r\n    if ('head' in newItemOrList) {\r\n        this.insertList(newItemOrList, oldItem);\r\n    } else {\r\n        this.insert(newItemOrList, oldItem);\r\n    }\r\n\r\n    this.remove(oldItem);\r\n};\r\n\r\nmodule.exports = List;\r\n","module.exports = function createCustomError(name, message) {\r\n    // use Object.create(), because some VMs prevent setting line/column otherwise\r\n    // (iOS Safari 10 even throws an exception)\r\n    var error = Object.create(SyntaxError.prototype);\r\n    var errorStack = new Error();\r\n\r\n    error.name = name;\r\n    error.message = message;\r\n\r\n    Object.defineProperty(error, 'stack', {\r\n        get: function() {\r\n            return (errorStack.stack || '').replace(/^(.+\\n){1,3}/, name + ': ' + message + '\\n');\r\n        }\r\n    });\r\n\r\n    return error;\r\n};\r\n","var createCustomError = require('../utils/createCustomError');\r\nvar MAX_LINE_LENGTH = 100;\r\nvar OFFSET_CORRECTION = 60;\r\nvar TAB_REPLACEMENT = '    ';\r\n\r\nfunction sourceFragment(error, extraLines) {\r\n    function processLines(start, end) {\r\n        return lines.slice(start, end).map(function(line, idx) {\r\n            var num = String(start + idx + 1);\r\n\r\n            while (num.length < maxNumLength) {\r\n                num = ' ' + num;\r\n            }\r\n\r\n            return num + ' |' + line;\r\n        }).join('\\n');\r\n    }\r\n\r\n    var lines = error.source.split(/\\r\\n?|\\n|\\f/);\r\n    var line = error.line;\r\n    var column = error.column;\r\n    var startLine = Math.max(1, line - extraLines) - 1;\r\n    var endLine = Math.min(line + extraLines, lines.length + 1);\r\n    var maxNumLength = Math.max(4, String(endLine).length) + 1;\r\n    var cutLeft = 0;\r\n\r\n    // column correction according to replaced tab before column\r\n    column += (TAB_REPLACEMENT.length - 1) * (lines[line - 1].substr(0, column - 1).match(/\\t/g) || []).length;\r\n\r\n    if (column > MAX_LINE_LENGTH) {\r\n        cutLeft = column - OFFSET_CORRECTION + 3;\r\n        column = OFFSET_CORRECTION - 2;\r\n    }\r\n\r\n    for (var i = startLine; i <= endLine; i++) {\r\n        if (i >= 0 && i < lines.length) {\r\n            lines[i] = lines[i].replace(/\\t/g, TAB_REPLACEMENT);\r\n            lines[i] =\r\n                (cutLeft > 0 && lines[i].length > cutLeft ? '\\u2026' : '') +\r\n                lines[i].substr(cutLeft, MAX_LINE_LENGTH - 2) +\r\n                (lines[i].length > cutLeft + MAX_LINE_LENGTH - 1 ? '\\u2026' : '');\r\n        }\r\n    }\r\n\r\n    return [\r\n        processLines(startLine, line),\r\n        new Array(column + maxNumLength + 2).join('-') + '^',\r\n        processLines(line, endLine)\r\n    ].filter(Boolean).join('\\n');\r\n}\r\n\r\nvar SyntaxError = function(message, source, offset, line, column) {\r\n    var error = createCustomError('SyntaxError', message);\r\n\r\n    error.source = source;\r\n    error.offset = offset;\r\n    error.line = line;\r\n    error.column = column;\r\n\r\n    error.sourceFragment = function(extraLines) {\r\n        return sourceFragment(error, isNaN(extraLines) ? 0 : extraLines);\r\n    };\r\n    Object.defineProperty(error, 'formattedMessage', {\r\n        get: function() {\r\n            return (\r\n                'Parse error: ' + error.message + '\\n' +\r\n                sourceFragment(error, 2)\r\n            );\r\n        }\r\n    });\r\n\r\n    // for backward capability\r\n    error.parseError = {\r\n        offset: offset,\r\n        line: line,\r\n        column: column\r\n    };\r\n\r\n    return error;\r\n};\r\n\r\nmodule.exports = SyntaxError;\r\n","// CSS Syntax Module Level 3\r\n// https://www.w3.org/TR/css-syntax-3/\r\nvar TYPE = {\r\n    EOF: 0,                 // <EOF-token>\r\n    Ident: 1,               // <ident-token>\r\n    Function: 2,            // <function-token>\r\n    AtKeyword: 3,           // <at-keyword-token>\r\n    Hash: 4,                // <hash-token>\r\n    String: 5,              // <string-token>\r\n    BadString: 6,           // <bad-string-token>\r\n    Url: 7,                 // <url-token>\r\n    BadUrl: 8,              // <bad-url-token>\r\n    Delim: 9,               // <delim-token>\r\n    Number: 10,             // <number-token>\r\n    Percentage: 11,         // <percentage-token>\r\n    Dimension: 12,          // <dimension-token>\r\n    WhiteSpace: 13,         // <whitespace-token>\r\n    CDO: 14,                // <CDO-token>\r\n    CDC: 15,                // <CDC-token>\r\n    Colon: 16,              // <colon-token>     :\r\n    Semicolon: 17,          // <semicolon-token> ;\r\n    Comma: 18,              // <comma-token>     ,\r\n    LeftSquareBracket: 19,  // <[-token>\r\n    RightSquareBracket: 20, // <]-token>\r\n    LeftParenthesis: 21,    // <(-token>\r\n    RightParenthesis: 22,   // <)-token>\r\n    LeftCurlyBracket: 23,   // <{-token>\r\n    RightCurlyBracket: 24,  // <}-token>\r\n    Comment: 25\r\n};\r\n\r\nvar NAME = Object.keys(TYPE).reduce(function(result, key) {\r\n    result[TYPE[key]] = key;\r\n    return result;\r\n}, {});\r\n\r\nmodule.exports = {\r\n    TYPE: TYPE,\r\n    NAME: NAME\r\n};\r\n","var EOF = 0;\r\n\r\n// https://drafts.csswg.org/css-syntax-3/\r\n// § 4.2. Definitions\r\n\r\n// digit\r\n// A code point between U+0030 DIGIT ZERO (0) and U+0039 DIGIT NINE (9).\r\nfunction isDigit(code) {\r\n    return code >= 0x0030 && code <= 0x0039;\r\n}\r\n\r\n// hex digit\r\n// A digit, or a code point between U+0041 LATIN CAPITAL LETTER A (A) and U+0046 LATIN CAPITAL LETTER F (F),\r\n// or a code point between U+0061 LATIN SMALL LETTER A (a) and U+0066 LATIN SMALL LETTER F (f).\r\nfunction isHexDigit(code) {\r\n    return (\r\n        isDigit(code) || // 0 .. 9\r\n        (code >= 0x0041 && code <= 0x0046) || // A .. F\r\n        (code >= 0x0061 && code <= 0x0066)    // a .. f\r\n    );\r\n}\r\n\r\n// uppercase letter\r\n// A code point between U+0041 LATIN CAPITAL LETTER A (A) and U+005A LATIN CAPITAL LETTER Z (Z).\r\nfunction isUppercaseLetter(code) {\r\n    return code >= 0x0041 && code <= 0x005A;\r\n}\r\n\r\n// lowercase letter\r\n// A code point between U+0061 LATIN SMALL LETTER A (a) and U+007A LATIN SMALL LETTER Z (z).\r\nfunction isLowercaseLetter(code) {\r\n    return code >= 0x0061 && code <= 0x007A;\r\n}\r\n\r\n// letter\r\n// An uppercase letter or a lowercase letter.\r\nfunction isLetter(code) {\r\n    return isUppercaseLetter(code) || isLowercaseLetter(code);\r\n}\r\n\r\n// non-ASCII code point\r\n// A code point with a value equal to or greater than U+0080 <control>.\r\nfunction isNonAscii(code) {\r\n    return code >= 0x0080;\r\n}\r\n\r\n// name-start code point\r\n// A letter, a non-ASCII code point, or U+005F LOW LINE (_).\r\nfunction isNameStart(code) {\r\n    return isLetter(code) || isNonAscii(code) || code === 0x005F;\r\n}\r\n\r\n// name code point\r\n// A name-start code point, a digit, or U+002D HYPHEN-MINUS (-).\r\nfunction isName(code) {\r\n    return isNameStart(code) || isDigit(code) || code === 0x002D;\r\n}\r\n\r\n// non-printable code point\r\n// A code point between U+0000 NULL and U+0008 BACKSPACE, or U+000B LINE TABULATION,\r\n// or a code point between U+000E SHIFT OUT and U+001F INFORMATION SEPARATOR ONE, or U+007F DELETE.\r\nfunction isNonPrintable(code) {\r\n    return (\r\n        (code >= 0x0000 && code <= 0x0008) ||\r\n        (code === 0x000B) ||\r\n        (code >= 0x000E && code <= 0x001F) ||\r\n        (code === 0x007F)\r\n    );\r\n}\r\n\r\n// newline\r\n// U+000A LINE FEED. Note that U+000D CARRIAGE RETURN and U+000C FORM FEED are not included in this definition,\r\n// as they are converted to U+000A LINE FEED during preprocessing.\r\n// TODO: we doesn't do a preprocessing, so check a code point for U+000D CARRIAGE RETURN and U+000C FORM FEED\r\nfunction isNewline(code) {\r\n    return code === 0x000A || code === 0x000D || code === 0x000C;\r\n}\r\n\r\n// whitespace\r\n// A newline, U+0009 CHARACTER TABULATION, or U+0020 SPACE.\r\nfunction isWhiteSpace(code) {\r\n    return isNewline(code) || code === 0x0020 || code === 0x0009;\r\n}\r\n\r\n// § 4.3.8. Check if two code points are a valid escape\r\nfunction isValidEscape(first, second) {\r\n    // If the first code point is not U+005C REVERSE SOLIDUS (\\), return false.\r\n    if (first !== 0x005C) {\r\n        return false;\r\n    }\r\n\r\n    // Otherwise, if the second code point is a newline or EOF, return false.\r\n    if (isNewline(second) || second === EOF) {\r\n        return false;\r\n    }\r\n\r\n    // Otherwise, return true.\r\n    return true;\r\n}\r\n\r\n// § 4.3.9. Check if three code points would start an identifier\r\nfunction isIdentifierStart(first, second, third) {\r\n    // Look at the first code point:\r\n\r\n    // U+002D HYPHEN-MINUS\r\n    if (first === 0x002D) {\r\n        // If the second code point is a name-start code point or a U+002D HYPHEN-MINUS,\r\n        // or the second and third code points are a valid escape, return true. Otherwise, return false.\r\n        return (\r\n            isNameStart(second) ||\r\n            second === 0x002D ||\r\n            isValidEscape(second, third)\r\n        );\r\n    }\r\n\r\n    // name-start code point\r\n    if (isNameStart(first)) {\r\n        // Return true.\r\n        return true;\r\n    }\r\n\r\n    // U+005C REVERSE SOLIDUS (\\)\r\n    if (first === 0x005C) {\r\n        // If the first and second code points are a valid escape, return true. Otherwise, return false.\r\n        return isValidEscape(first, second);\r\n    }\r\n\r\n    // anything else\r\n    // Return false.\r\n    return false;\r\n}\r\n\r\n// § 4.3.10. Check if three code points would start a number\r\nfunction isNumberStart(first, second, third) {\r\n    // Look at the first code point:\r\n\r\n    // U+002B PLUS SIGN (+)\r\n    // U+002D HYPHEN-MINUS (-)\r\n    if (first === 0x002B || first === 0x002D) {\r\n        // If the second code point is a digit, return true.\r\n        if (isDigit(second)) {\r\n            return 2;\r\n        }\r\n\r\n        // Otherwise, if the second code point is a U+002E FULL STOP (.)\r\n        // and the third code point is a digit, return true.\r\n        // Otherwise, return false.\r\n        return second === 0x002E && isDigit(third) ? 3 : 0;\r\n    }\r\n\r\n    // U+002E FULL STOP (.)\r\n    if (first === 0x002E) {\r\n        // If the second code point is a digit, return true. Otherwise, return false.\r\n        return isDigit(second) ? 2 : 0;\r\n    }\r\n\r\n    // digit\r\n    if (isDigit(first)) {\r\n        // Return true.\r\n        return 1;\r\n    }\r\n\r\n    // anything else\r\n    // Return false.\r\n    return 0;\r\n}\r\n\r\n//\r\n// Misc\r\n//\r\n\r\n// detect BOM (https://en.wikipedia.org/wiki/Byte_order_mark)\r\nfunction isBOM(code) {\r\n    // UTF-16BE\r\n    if (code === 0xFEFF) {\r\n        return 1;\r\n    }\r\n\r\n    // UTF-16LE\r\n    if (code === 0xFFFE) {\r\n        return 1;\r\n    }\r\n\r\n    return 0;\r\n}\r\n\r\n// Fast code category\r\n//\r\n// https://drafts.csswg.org/css-syntax/#tokenizer-definitions\r\n// > non-ASCII code point\r\n// >   A code point with a value equal to or greater than U+0080 <control>\r\n// > name-start code point\r\n// >   A letter, a non-ASCII code point, or U+005F LOW LINE (_).\r\n// > name code point\r\n// >   A name-start code point, a digit, or U+002D HYPHEN-MINUS (-)\r\n// That means only ASCII code points has a special meaning and we define a maps for 0..127 codes only\r\nvar CATEGORY = new Array(0x80);\r\ncharCodeCategory.Eof = 0x80;\r\ncharCodeCategory.WhiteSpace = 0x82;\r\ncharCodeCategory.Digit = 0x83;\r\ncharCodeCategory.NameStart = 0x84;\r\ncharCodeCategory.NonPrintable = 0x85;\r\n\r\nfor (var i = 0; i < CATEGORY.length; i++) {\r\n    switch (true) {\r\n        case isWhiteSpace(i):\r\n            CATEGORY[i] = charCodeCategory.WhiteSpace;\r\n            break;\r\n\r\n        case isDigit(i):\r\n            CATEGORY[i] = charCodeCategory.Digit;\r\n            break;\r\n\r\n        case isNameStart(i):\r\n            CATEGORY[i] = charCodeCategory.NameStart;\r\n            break;\r\n\r\n        case isNonPrintable(i):\r\n            CATEGORY[i] = charCodeCategory.NonPrintable;\r\n            break;\r\n\r\n        default:\r\n            CATEGORY[i] = i || charCodeCategory.Eof;\r\n    }\r\n}\r\n\r\nfunction charCodeCategory(code) {\r\n    return code < 0x80 ? CATEGORY[code] : charCodeCategory.NameStart;\r\n};\r\n\r\nmodule.exports = {\r\n    isDigit: isDigit,\r\n    isHexDigit: isHexDigit,\r\n    isUppercaseLetter: isUppercaseLetter,\r\n    isLowercaseLetter: isLowercaseLetter,\r\n    isLetter: isLetter,\r\n    isNonAscii: isNonAscii,\r\n    isNameStart: isNameStart,\r\n    isName: isName,\r\n    isNonPrintable: isNonPrintable,\r\n    isNewline: isNewline,\r\n    isWhiteSpace: isWhiteSpace,\r\n    isValidEscape: isValidEscape,\r\n    isIdentifierStart: isIdentifierStart,\r\n    isNumberStart: isNumberStart,\r\n\r\n    isBOM: isBOM,\r\n    charCodeCategory: charCodeCategory\r\n};\r\n","var charCodeDef = require('./char-code-definitions');\r\nvar isDigit = charCodeDef.isDigit;\r\nvar isHexDigit = charCodeDef.isHexDigit;\r\nvar isUppercaseLetter = charCodeDef.isUppercaseLetter;\r\nvar isName = charCodeDef.isName;\r\nvar isWhiteSpace = charCodeDef.isWhiteSpace;\r\nvar isValidEscape = charCodeDef.isValidEscape;\r\n\r\nfunction getCharCode(source, offset) {\r\n    return offset < source.length ? source.charCodeAt(offset) : 0;\r\n}\r\n\r\nfunction getNewlineLength(source, offset, code) {\r\n    if (code === 13 /* \\r */ && getCharCode(source, offset + 1) === 10 /* \\n */) {\r\n        return 2;\r\n    }\r\n\r\n    return 1;\r\n}\r\n\r\nfunction cmpChar(testStr, offset, referenceCode) {\r\n    var code = testStr.charCodeAt(offset);\r\n\r\n    // code.toLowerCase() for A..Z\r\n    if (isUppercaseLetter(code)) {\r\n        code = code | 32;\r\n    }\r\n\r\n    return code === referenceCode;\r\n}\r\n\r\nfunction cmpStr(testStr, start, end, referenceStr) {\r\n    if (end - start !== referenceStr.length) {\r\n        return false;\r\n    }\r\n\r\n    if (start < 0 || end > testStr.length) {\r\n        return false;\r\n    }\r\n\r\n    for (var i = start; i < end; i++) {\r\n        var testCode = testStr.charCodeAt(i);\r\n        var referenceCode = referenceStr.charCodeAt(i - start);\r\n\r\n        // testCode.toLowerCase() for A..Z\r\n        if (isUppercaseLetter(testCode)) {\r\n            testCode = testCode | 32;\r\n        }\r\n\r\n        if (testCode !== referenceCode) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nfunction findWhiteSpaceStart(source, offset) {\r\n    for (; offset >= 0; offset--) {\r\n        if (!isWhiteSpace(source.charCodeAt(offset))) {\r\n            break;\r\n        }\r\n    }\r\n\r\n    return offset + 1;\r\n}\r\n\r\nfunction findWhiteSpaceEnd(source, offset) {\r\n    for (; offset < source.length; offset++) {\r\n        if (!isWhiteSpace(source.charCodeAt(offset))) {\r\n            break;\r\n        }\r\n    }\r\n\r\n    return offset;\r\n}\r\n\r\nfunction findDecimalNumberEnd(source, offset) {\r\n    for (; offset < source.length; offset++) {\r\n        if (!isDigit(source.charCodeAt(offset))) {\r\n            break;\r\n        }\r\n    }\r\n\r\n    return offset;\r\n}\r\n\r\n// § 4.3.7. Consume an escaped code point\r\nfunction consumeEscaped(source, offset) {\r\n    // It assumes that the U+005C REVERSE SOLIDUS (\\) has already been consumed and\r\n    // that the next input code point has already been verified to be part of a valid escape.\r\n    offset += 2;\r\n\r\n    // hex digit\r\n    if (isHexDigit(getCharCode(source, offset - 1))) {\r\n        // Consume as many hex digits as possible, but no more than 5.\r\n        // Note that this means 1-6 hex digits have been consumed in total.\r\n        for (var maxOffset = Math.min(source.length, offset + 5); offset < maxOffset; offset++) {\r\n            if (!isHexDigit(getCharCode(source, offset))) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        // If the next input code point is whitespace, consume it as well.\r\n        var code = getCharCode(source, offset);\r\n        if (isWhiteSpace(code)) {\r\n            offset += getNewlineLength(source, offset, code);\r\n        }\r\n    }\r\n\r\n    return offset;\r\n}\r\n\r\n// §4.3.11. Consume a name\r\n// Note: This algorithm does not do the verification of the first few code points that are necessary\r\n// to ensure the returned code points would constitute an <ident-token>. If that is the intended use,\r\n// ensure that the stream starts with an identifier before calling this algorithm.\r\nfunction consumeName(source, offset) {\r\n    // Let result initially be an empty string.\r\n    // Repeatedly consume the next input code point from the stream:\r\n    for (; offset < source.length; offset++) {\r\n        var code = source.charCodeAt(offset);\r\n\r\n        // name code point\r\n        if (isName(code)) {\r\n            // Append the code point to result.\r\n            continue;\r\n        }\r\n\r\n        // the stream starts with a valid escape\r\n        if (isValidEscape(code, getCharCode(source, offset + 1))) {\r\n            // Consume an escaped code point. Append the returned code point to result.\r\n            offset = consumeEscaped(source, offset) - 1;\r\n            continue;\r\n        }\r\n\r\n        // anything else\r\n        // Reconsume the current input code point. Return result.\r\n        break;\r\n    }\r\n\r\n    return offset;\r\n}\r\n\r\n// §4.3.12. Consume a number\r\nfunction consumeNumber(source, offset) {\r\n    var code = source.charCodeAt(offset);\r\n\r\n    // 2. If the next input code point is U+002B PLUS SIGN (+) or U+002D HYPHEN-MINUS (-),\r\n    // consume it and append it to repr.\r\n    if (code === 0x002B || code === 0x002D) {\r\n        code = source.charCodeAt(offset += 1);\r\n    }\r\n\r\n    // 3. While the next input code point is a digit, consume it and append it to repr.\r\n    if (isDigit(code)) {\r\n        offset = findDecimalNumberEnd(source, offset + 1);\r\n        code = source.charCodeAt(offset);\r\n    }\r\n\r\n    // 4. If the next 2 input code points are U+002E FULL STOP (.) followed by a digit, then:\r\n    if (code === 0x002E && isDigit(source.charCodeAt(offset + 1))) {\r\n        // 4.1 Consume them.\r\n        // 4.2 Append them to repr.\r\n        code = source.charCodeAt(offset += 2);\r\n\r\n        // 4.3 Set type to \"number\".\r\n        // TODO\r\n\r\n        // 4.4 While the next input code point is a digit, consume it and append it to repr.\r\n\r\n        offset = findDecimalNumberEnd(source, offset);\r\n    }\r\n\r\n    // 5. If the next 2 or 3 input code points are U+0045 LATIN CAPITAL LETTER E (E)\r\n    // or U+0065 LATIN SMALL LETTER E (e), ... , followed by a digit, then:\r\n    if (cmpChar(source, offset, 101 /* e */)) {\r\n        var sign = 0;\r\n        code = source.charCodeAt(offset + 1);\r\n\r\n        // ... optionally followed by U+002D HYPHEN-MINUS (-) or U+002B PLUS SIGN (+) ...\r\n        if (code === 0x002D || code === 0x002B) {\r\n            sign = 1;\r\n            code = source.charCodeAt(offset + 2);\r\n        }\r\n\r\n        // ... followed by a digit\r\n        if (isDigit(code)) {\r\n            // 5.1 Consume them.\r\n            // 5.2 Append them to repr.\r\n\r\n            // 5.3 Set type to \"number\".\r\n            // TODO\r\n\r\n            // 5.4 While the next input code point is a digit, consume it and append it to repr.\r\n            offset = findDecimalNumberEnd(source, offset + 1 + sign + 1);\r\n        }\r\n    }\r\n\r\n    return offset;\r\n}\r\n\r\n// § 4.3.14. Consume the remnants of a bad url\r\n// ... its sole use is to consume enough of the input stream to reach a recovery point\r\n// where normal tokenizing can resume.\r\nfunction consumeBadUrlRemnants(source, offset) {\r\n    // Repeatedly consume the next input code point from the stream:\r\n    for (; offset < source.length; offset++) {\r\n        var code = source.charCodeAt(offset);\r\n\r\n        // U+0029 RIGHT PARENTHESIS ())\r\n        // EOF\r\n        if (code === 0x0029) {\r\n            // Return.\r\n            offset++;\r\n            break;\r\n        }\r\n\r\n        if (isValidEscape(code, getCharCode(source, offset + 1))) {\r\n            // Consume an escaped code point.\r\n            // Note: This allows an escaped right parenthesis (\"\\)\") to be encountered\r\n            // without ending the <bad-url-token>. This is otherwise identical to\r\n            // the \"anything else\" clause.\r\n            offset = consumeEscaped(source, offset);\r\n        }\r\n    }\r\n\r\n    return offset;\r\n}\r\n\r\nmodule.exports = {\r\n    consumeEscaped: consumeEscaped,\r\n    consumeName: consumeName,\r\n    consumeNumber: consumeNumber,\r\n    consumeBadUrlRemnants: consumeBadUrlRemnants,\r\n\r\n    cmpChar: cmpChar,\r\n    cmpStr: cmpStr,\r\n\r\n    getNewlineLength: getNewlineLength,\r\n    findWhiteSpaceStart: findWhiteSpaceStart,\r\n    findWhiteSpaceEnd: findWhiteSpaceEnd\r\n};\r\n","var constants = require('../tokenizer/const');\r\nvar TYPE = constants.TYPE;\r\nvar NAME = constants.NAME;\r\n\r\nvar utils = require('../tokenizer/utils');\r\nvar cmpStr = utils.cmpStr;\r\n\r\nvar EOF = TYPE.EOF;\r\nvar WHITESPACE = TYPE.WhiteSpace;\r\nvar COMMENT = TYPE.Comment;\r\n\r\nvar OFFSET_MASK = 0x00FFFFFF;\r\nvar TYPE_SHIFT = 24;\r\n\r\nvar TokenStream = function() {\r\n    this.offsetAndType = null;\r\n    this.balance = null;\r\n\r\n    this.reset();\r\n};\r\n\r\nTokenStream.prototype = {\r\n    reset: function() {\r\n        this.eof = false;\r\n        this.tokenIndex = -1;\r\n        this.tokenType = 0;\r\n        this.tokenStart = this.firstCharOffset;\r\n        this.tokenEnd = this.firstCharOffset;\r\n    },\r\n\r\n    lookupType: function(offset) {\r\n        offset += this.tokenIndex;\r\n\r\n        if (offset < this.tokenCount) {\r\n            return this.offsetAndType[offset] >> TYPE_SHIFT;\r\n        }\r\n\r\n        return EOF;\r\n    },\r\n    lookupOffset: function(offset) {\r\n        offset += this.tokenIndex;\r\n\r\n        if (offset < this.tokenCount) {\r\n            return this.offsetAndType[offset - 1] & OFFSET_MASK;\r\n        }\r\n\r\n        return this.source.length;\r\n    },\r\n    lookupValue: function(offset, referenceStr) {\r\n        offset += this.tokenIndex;\r\n\r\n        if (offset < this.tokenCount) {\r\n            return cmpStr(\r\n                this.source,\r\n                this.offsetAndType[offset - 1] & OFFSET_MASK,\r\n                this.offsetAndType[offset] & OFFSET_MASK,\r\n                referenceStr\r\n            );\r\n        }\r\n\r\n        return false;\r\n    },\r\n    getTokenStart: function(tokenIndex) {\r\n        if (tokenIndex === this.tokenIndex) {\r\n            return this.tokenStart;\r\n        }\r\n\r\n        if (tokenIndex > 0) {\r\n            return tokenIndex < this.tokenCount\r\n                ? this.offsetAndType[tokenIndex - 1] & OFFSET_MASK\r\n                : this.offsetAndType[this.tokenCount] & OFFSET_MASK;\r\n        }\r\n\r\n        return this.firstCharOffset;\r\n    },\r\n\r\n    // TODO: -> skipUntilBalanced\r\n    getRawLength: function(startToken, mode) {\r\n        var cursor = startToken;\r\n        var balanceEnd;\r\n        var offset = this.offsetAndType[Math.max(cursor - 1, 0)] & OFFSET_MASK;\r\n        var type;\r\n\r\n        loop:\r\n        for (; cursor < this.tokenCount; cursor++) {\r\n            balanceEnd = this.balance[cursor];\r\n\r\n            // stop scanning on balance edge that points to offset before start token\r\n            if (balanceEnd < startToken) {\r\n                break loop;\r\n            }\r\n\r\n            type = this.offsetAndType[cursor] >> TYPE_SHIFT;\r\n\r\n            // check token is stop type\r\n            switch (mode(type, this.source, offset)) {\r\n                case 1:\r\n                    break loop;\r\n\r\n                case 2:\r\n                    cursor++;\r\n                    break loop;\r\n\r\n                default:\r\n                    offset = this.offsetAndType[cursor] & OFFSET_MASK;\r\n\r\n                    // fast forward to the end of balanced block\r\n                    if (this.balance[balanceEnd] === cursor) {\r\n                        cursor = balanceEnd;\r\n                    }\r\n            }\r\n        }\r\n\r\n        return cursor - this.tokenIndex;\r\n    },\r\n    isBalanceEdge: function(pos) {\r\n        return this.balance[this.tokenIndex] < pos;\r\n    },\r\n    isDelim: function(code, offset) {\r\n        if (offset) {\r\n            return (\r\n                this.lookupType(offset) === TYPE.Delim &&\r\n                this.source.charCodeAt(this.lookupOffset(offset)) === code\r\n            );\r\n        }\r\n\r\n        return (\r\n            this.tokenType === TYPE.Delim &&\r\n            this.source.charCodeAt(this.tokenStart) === code\r\n        );\r\n    },\r\n\r\n    getTokenValue: function() {\r\n        return this.source.substring(this.tokenStart, this.tokenEnd);\r\n    },\r\n    getTokenLength: function() {\r\n        return this.tokenEnd - this.tokenStart;\r\n    },\r\n    substrToCursor: function(start) {\r\n        return this.source.substring(start, this.tokenStart);\r\n    },\r\n\r\n    skipWS: function() {\r\n        for (var i = this.tokenIndex, skipTokenCount = 0; i < this.tokenCount; i++, skipTokenCount++) {\r\n            if ((this.offsetAndType[i] >> TYPE_SHIFT) !== WHITESPACE) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (skipTokenCount > 0) {\r\n            this.skip(skipTokenCount);\r\n        }\r\n    },\r\n    skipSC: function() {\r\n        while (this.tokenType === WHITESPACE || this.tokenType === COMMENT) {\r\n            this.next();\r\n        }\r\n    },\r\n    skip: function(tokenCount) {\r\n        var next = this.tokenIndex + tokenCount;\r\n\r\n        if (next < this.tokenCount) {\r\n            this.tokenIndex = next;\r\n            this.tokenStart = this.offsetAndType[next - 1] & OFFSET_MASK;\r\n            next = this.offsetAndType[next];\r\n            this.tokenType = next >> TYPE_SHIFT;\r\n            this.tokenEnd = next & OFFSET_MASK;\r\n        } else {\r\n            this.tokenIndex = this.tokenCount;\r\n            this.next();\r\n        }\r\n    },\r\n    next: function() {\r\n        var next = this.tokenIndex + 1;\r\n\r\n        if (next < this.tokenCount) {\r\n            this.tokenIndex = next;\r\n            this.tokenStart = this.tokenEnd;\r\n            next = this.offsetAndType[next];\r\n            this.tokenType = next >> TYPE_SHIFT;\r\n            this.tokenEnd = next & OFFSET_MASK;\r\n        } else {\r\n            this.tokenIndex = this.tokenCount;\r\n            this.eof = true;\r\n            this.tokenType = EOF;\r\n            this.tokenStart = this.tokenEnd = this.source.length;\r\n        }\r\n    },\r\n\r\n    dump: function() {\r\n        var offset = this.firstCharOffset;\r\n\r\n        return Array.prototype.slice.call(this.offsetAndType, 0, this.tokenCount).map(function(item, idx) {\r\n            var start = offset;\r\n            var end = item & OFFSET_MASK;\r\n\r\n            offset = end;\r\n\r\n            return {\r\n                idx: idx,\r\n                type: NAME[item >> TYPE_SHIFT],\r\n                chunk: this.source.substring(start, end),\r\n                balance: this.balance[idx]\r\n            };\r\n        }, this);\r\n    }\r\n};\r\n\r\nmodule.exports = TokenStream;\r\n","function noop(value) {\n  return value\n}\n\nfunction generateMultiplier(multiplier) {\n  if (multiplier.min === 0 && multiplier.max === 0) {\n    return '*'\n  }\n\n  if (multiplier.min === 0 && multiplier.max === 1) {\n    return '?'\n  }\n\n  if (multiplier.min === 1 && multiplier.max === 0) {\n    return multiplier.comma ? '#' : '+'\n  }\n\n  if (multiplier.min === 1 && multiplier.max === 1) {\n    return ''\n  }\n\n  return (multiplier.comma ? '#' : '') + (multiplier.min === multiplier.max ? '{' + multiplier.min + '}' : '{' + multiplier.min + ',' + (multiplier.max !== 0 ? multiplier.max : '') + '}')\n}\n\nfunction generateTypeOpts(node) {\n  switch (node.type) {\n    case 'Range':\n      return ' [' + (node.min === null ? '-∞' : node.min) + ',' + (node.max === null ? '∞' : node.max) + ']'\n\n    default:\n      throw new Error('Unknown node type `' + node.type + '`')\n  }\n}\n\nfunction generateSequence(node, decorate, forceBraces, compact) {\n  var combinator = node.combinator === ' ' || compact ? node.combinator : ' ' + node.combinator + ' '\n  var result = node.terms\n    .map(function (term) {\n      return generate(term, decorate, forceBraces, compact)\n    })\n    .join(combinator)\n\n  if (node.explicit || forceBraces) {\n    result = (compact || result[0] === ',' ? '[' : '[ ') + result + (compact ? ']' : ' ]')\n  }\n\n  return result\n}\n\nfunction generate(node, decorate, forceBraces, compact) {\n  var result\n\n  switch (node.type) {\n    case 'Group':\n      result = generateSequence(node, decorate, forceBraces, compact) + (node.disallowEmpty ? '!' : '')\n      break\n\n    case 'Multiplier':\n      // return since node is a composition\n      return generate(node.term, decorate, forceBraces, compact) + decorate(generateMultiplier(node), node)\n\n    case 'Type':\n      result = '<' + node.name + (node.opts ? decorate(generateTypeOpts(node.opts), node.opts) : '') + '>'\n      break\n\n    case 'Property':\n      result = \"<'\" + node.name + \"'>\"\n      break\n\n    case 'Keyword':\n      result = node.name\n      break\n\n    case 'AtKeyword':\n      result = '@' + node.name\n      break\n\n    case 'Function':\n      result = node.name + '('\n      break\n\n    case 'String':\n    case 'Token':\n      result = node.value\n      break\n\n    case 'Comma':\n      result = ','\n      break\n\n    default:\n      throw new Error('Unknown node type `' + node.type + '`')\n  }\n\n  return decorate(result, node)\n}\n\nmodule.exports = function (node, options) {\n  var decorate = noop\n  var forceBraces = false\n  var compact = false\n\n  if (typeof options === 'function') {\n    decorate = options\n  } else if (options) {\n    forceBraces = Boolean(options.forceBraces)\n    compact = Boolean(options.compact)\n    if (typeof options.decorate === 'function') {\n      decorate = options.decorate\n    }\n  }\n\n  return generate(node, decorate, forceBraces, compact)\n}\n","var createCustomError = require('../utils/createCustomError');\r\nvar generate = require('../definition-syntax/generate');\r\n\r\nfunction fromMatchResult(matchResult) {\r\n    var tokens = matchResult.tokens;\r\n    var longestMatch = matchResult.longestMatch;\r\n    var node = longestMatch < tokens.length ? tokens[longestMatch].node : null;\r\n    var mismatchOffset = -1;\r\n    var entries = 0;\r\n    var css = '';\r\n\r\n    for (var i = 0; i < tokens.length; i++) {\r\n        if (i === longestMatch) {\r\n            mismatchOffset = css.length;\r\n        }\r\n\r\n        if (node !== null && tokens[i].node === node) {\r\n            if (i <= longestMatch) {\r\n                entries++;\r\n            } else {\r\n                entries = 0;\r\n            }\r\n        }\r\n\r\n        css += tokens[i].value;\r\n    }\r\n\r\n    return {\r\n        node: node,\r\n        css: css,\r\n        mismatchOffset: mismatchOffset === -1 ? css.length : mismatchOffset,\r\n        last: node === null || entries > 1\r\n    };\r\n}\r\n\r\nfunction getLocation(node, point) {\r\n    var loc = node && node.loc && node.loc[point];\r\n\r\n    if (loc) {\r\n        return {\r\n            offset: loc.offset,\r\n            line: loc.line,\r\n            column: loc.column\r\n        };\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\nvar SyntaxReferenceError = function(type, referenceName) {\r\n    var error = createCustomError(\r\n        'SyntaxReferenceError',\r\n        type + (referenceName ? ' `' + referenceName + '`' : '')\r\n    );\r\n\r\n    error.reference = referenceName;\r\n\r\n    return error;\r\n};\r\n\r\nvar MatchError = function(message, syntax, node, matchResult) {\r\n    var error = createCustomError('SyntaxMatchError', message);\r\n    var details = fromMatchResult(matchResult);\r\n    var mismatchOffset = details.mismatchOffset || 0;\r\n    var badNode = details.node || node;\r\n    var end = getLocation(badNode, 'end');\r\n    var start = details.last ? end : getLocation(badNode, 'start');\r\n    var css = details.css;\r\n\r\n    error.rawMessage = message;\r\n    error.syntax = syntax ? generate(syntax) : '<generic>';\r\n    error.css = css;\r\n    error.mismatchOffset = mismatchOffset;\r\n    error.loc = {\r\n        source: (badNode && badNode.loc && badNode.loc.source) || '<unknown>',\r\n        start: start,\r\n        end: end\r\n    };\r\n    error.line = start ? start.line : undefined;\r\n    error.column = start ? start.column : undefined;\r\n    error.offset = start ? start.offset : undefined;\r\n    error.message = message + '\\n' +\r\n        '  syntax: ' + error.syntax + '\\n' +\r\n        '   value: ' + (error.css || '<empty string>') + '\\n' +\r\n        '  --------' + new Array(error.mismatchOffset + 1).join('-') + '^';\r\n\r\n    return error;\r\n};\r\n\r\nmodule.exports = {\r\n    SyntaxReferenceError: SyntaxReferenceError,\r\n    MatchError: MatchError\r\n};\r\n","var hasOwnProperty = Object.prototype.hasOwnProperty;\r\nvar keywords = Object.create(null);\r\nvar properties = Object.create(null);\r\nvar HYPHENMINUS = 45; // '-'.charCodeAt()\r\n\r\nfunction isCustomProperty(str, offset) {\r\n    offset = offset || 0;\r\n\r\n    return str.length - offset >= 2 &&\r\n           str.charCodeAt(offset) === HYPHENMINUS &&\r\n           str.charCodeAt(offset + 1) === HYPHENMINUS;\r\n}\r\n\r\nfunction getVendorPrefix(str, offset) {\r\n    offset = offset || 0;\r\n\r\n    // verdor prefix should be at least 3 chars length\r\n    if (str.length - offset >= 3) {\r\n        // vendor prefix starts with hyper minus following non-hyper minus\r\n        if (str.charCodeAt(offset) === HYPHENMINUS &&\r\n            str.charCodeAt(offset + 1) !== HYPHENMINUS) {\r\n            // vendor prefix should contain a hyper minus at the ending\r\n            var secondDashIndex = str.indexOf('-', offset + 2);\r\n\r\n            if (secondDashIndex !== -1) {\r\n                return str.substring(offset, secondDashIndex + 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    return '';\r\n}\r\n\r\nfunction getKeywordDescriptor(keyword) {\r\n    if (hasOwnProperty.call(keywords, keyword)) {\r\n        return keywords[keyword];\r\n    }\r\n\r\n    var name = keyword.toLowerCase();\r\n\r\n    if (hasOwnProperty.call(keywords, name)) {\r\n        return keywords[keyword] = keywords[name];\r\n    }\r\n\r\n    var custom = isCustomProperty(name, 0);\r\n    var vendor = !custom ? getVendorPrefix(name, 0) : '';\r\n\r\n    return keywords[keyword] = Object.freeze({\r\n        basename: name.substr(vendor.length),\r\n        name: name,\r\n        vendor: vendor,\r\n        prefix: vendor,\r\n        custom: custom\r\n    });\r\n}\r\n\r\nfunction getPropertyDescriptor(property) {\r\n    if (hasOwnProperty.call(properties, property)) {\r\n        return properties[property];\r\n    }\r\n\r\n    var name = property;\r\n    var hack = property[0];\r\n\r\n    if (hack === '/') {\r\n        hack = property[1] === '/' ? '//' : '/';\r\n    } else if (hack !== '_' &&\r\n               hack !== '*' &&\r\n               hack !== '$' &&\r\n               hack !== '#' &&\r\n               hack !== '+' &&\r\n               hack !== '&') {\r\n        hack = '';\r\n    }\r\n\r\n    var custom = isCustomProperty(name, hack.length);\r\n\r\n    // re-use result when possible (the same as for lower case)\r\n    if (!custom) {\r\n        name = name.toLowerCase();\r\n        if (hasOwnProperty.call(properties, name)) {\r\n            return properties[property] = properties[name];\r\n        }\r\n    }\r\n\r\n    var vendor = !custom ? getVendorPrefix(name, hack.length) : '';\r\n    var prefix = name.substr(0, hack.length + vendor.length);\r\n\r\n    return properties[property] = Object.freeze({\r\n        basename: name.substr(prefix.length),\r\n        name: name.substr(hack.length),\r\n        hack: hack,\r\n        vendor: vendor,\r\n        prefix: prefix,\r\n        custom: custom\r\n    });\r\n}\r\n\r\nmodule.exports = {\r\n    keyword: getKeywordDescriptor,\r\n    property: getPropertyDescriptor,\r\n    isCustomProperty: isCustomProperty,\r\n    vendorPrefix: getVendorPrefix\r\n};\r\n","var MIN_SIZE = 16 * 1024;\r\nvar SafeUint32Array = typeof Uint32Array !== 'undefined' ? Uint32Array : Array; // fallback on Array when TypedArray is not supported\r\n\r\nmodule.exports = function adoptBuffer(buffer, size) {\r\n    if (buffer === null || buffer.length < size) {\r\n        return new SafeUint32Array(Math.max(size + 1024, MIN_SIZE));\r\n    }\r\n\r\n    return buffer;\r\n};\r\n","var TokenStream = require('../common/TokenStream');\r\nvar adoptBuffer = require('../common/adopt-buffer');\r\n\r\nvar constants = require('./const');\r\nvar TYPE = constants.TYPE;\r\n\r\nvar charCodeDefinitions = require('./char-code-definitions');\r\nvar isNewline = charCodeDefinitions.isNewline;\r\nvar isName = charCodeDefinitions.isName;\r\nvar isValidEscape = charCodeDefinitions.isValidEscape;\r\nvar isNumberStart = charCodeDefinitions.isNumberStart;\r\nvar isIdentifierStart = charCodeDefinitions.isIdentifierStart;\r\nvar charCodeCategory = charCodeDefinitions.charCodeCategory;\r\nvar isBOM = charCodeDefinitions.isBOM;\r\n\r\nvar utils = require('./utils');\r\nvar cmpStr = utils.cmpStr;\r\nvar getNewlineLength = utils.getNewlineLength;\r\nvar findWhiteSpaceEnd = utils.findWhiteSpaceEnd;\r\nvar consumeEscaped = utils.consumeEscaped;\r\nvar consumeName = utils.consumeName;\r\nvar consumeNumber = utils.consumeNumber;\r\nvar consumeBadUrlRemnants = utils.consumeBadUrlRemnants;\r\n\r\nvar OFFSET_MASK = 0x00FFFFFF;\r\nvar TYPE_SHIFT = 24;\r\n\r\nfunction tokenize(source, stream) {\r\n    function getCharCode(offset) {\r\n        return offset < sourceLength ? source.charCodeAt(offset) : 0;\r\n    }\r\n\r\n    // § 4.3.3. Consume a numeric token\r\n    function consumeNumericToken() {\r\n        // Consume a number and let number be the result.\r\n        offset = consumeNumber(source, offset);\r\n\r\n        // If the next 3 input code points would start an identifier, then:\r\n        if (isIdentifierStart(getCharCode(offset), getCharCode(offset + 1), getCharCode(offset + 2))) {\r\n            // Create a <dimension-token> with the same value and type flag as number, and a unit set initially to the empty string.\r\n            // Consume a name. Set the <dimension-token>’s unit to the returned value.\r\n            // Return the <dimension-token>.\r\n            type = TYPE.Dimension;\r\n            offset = consumeName(source, offset);\r\n            return;\r\n        }\r\n\r\n        // Otherwise, if the next input code point is U+0025 PERCENTAGE SIGN (%), consume it.\r\n        if (getCharCode(offset) === 0x0025) {\r\n            // Create a <percentage-token> with the same value as number, and return it.\r\n            type = TYPE.Percentage;\r\n            offset++;\r\n            return;\r\n        }\r\n\r\n        // Otherwise, create a <number-token> with the same value and type flag as number, and return it.\r\n        type = TYPE.Number;\r\n    }\r\n\r\n    // § 4.3.4. Consume an ident-like token\r\n    function consumeIdentLikeToken() {\r\n        const nameStartOffset = offset;\r\n\r\n        // Consume a name, and let string be the result.\r\n        offset = consumeName(source, offset);\r\n\r\n        // If string’s value is an ASCII case-insensitive match for \"url\",\r\n        // and the next input code point is U+0028 LEFT PARENTHESIS ((), consume it.\r\n        if (cmpStr(source, nameStartOffset, offset, 'url') && getCharCode(offset) === 0x0028) {\r\n            // While the next two input code points are whitespace, consume the next input code point.\r\n            offset = findWhiteSpaceEnd(source, offset + 1);\r\n\r\n            // If the next one or two input code points are U+0022 QUOTATION MARK (\"), U+0027 APOSTROPHE ('),\r\n            // or whitespace followed by U+0022 QUOTATION MARK (\") or U+0027 APOSTROPHE ('),\r\n            // then create a <function-token> with its value set to string and return it.\r\n            if (getCharCode(offset) === 0x0022 ||\r\n                getCharCode(offset) === 0x0027) {\r\n                type = TYPE.Function;\r\n                offset = nameStartOffset + 4;\r\n                return;\r\n            }\r\n\r\n            // Otherwise, consume a url token, and return it.\r\n            consumeUrlToken();\r\n            return;\r\n        }\r\n\r\n        // Otherwise, if the next input code point is U+0028 LEFT PARENTHESIS ((), consume it.\r\n        // Create a <function-token> with its value set to string and return it.\r\n        if (getCharCode(offset) === 0x0028) {\r\n            type = TYPE.Function;\r\n            offset++;\r\n            return;\r\n        }\r\n\r\n        // Otherwise, create an <ident-token> with its value set to string and return it.\r\n        type = TYPE.Ident;\r\n    }\r\n\r\n    // § 4.3.5. Consume a string token\r\n    function consumeStringToken(endingCodePoint) {\r\n        // This algorithm may be called with an ending code point, which denotes the code point\r\n        // that ends the string. If an ending code point is not specified,\r\n        // the current input code point is used.\r\n        if (!endingCodePoint) {\r\n            endingCodePoint = getCharCode(offset++);\r\n        }\r\n\r\n        // Initially create a <string-token> with its value set to the empty string.\r\n        type = TYPE.String;\r\n\r\n        // Repeatedly consume the next input code point from the stream:\r\n        for (; offset < source.length; offset++) {\r\n            var code = source.charCodeAt(offset);\r\n\r\n            switch (charCodeCategory(code)) {\r\n                // ending code point\r\n                case endingCodePoint:\r\n                    // Return the <string-token>.\r\n                    offset++;\r\n                    return;\r\n\r\n                // EOF\r\n                case charCodeCategory.Eof:\r\n                    // This is a parse error. Return the <string-token>.\r\n                    return;\r\n\r\n                // newline\r\n                case charCodeCategory.WhiteSpace:\r\n                    if (isNewline(code)) {\r\n                        // This is a parse error. Reconsume the current input code point,\r\n                        // create a <bad-string-token>, and return it.\r\n                        offset += getNewlineLength(source, offset, code);\r\n                        type = TYPE.BadString;\r\n                        return;\r\n                    }\r\n                    break;\r\n\r\n                // U+005C REVERSE SOLIDUS (\\)\r\n                case 0x005C:\r\n                    // If the next input code point is EOF, do nothing.\r\n                    if (offset === source.length - 1) {\r\n                        break;\r\n                    }\r\n\r\n                    var nextCode = getCharCode(offset + 1);\r\n\r\n                    // Otherwise, if the next input code point is a newline, consume it.\r\n                    if (isNewline(nextCode)) {\r\n                        offset += getNewlineLength(source, offset + 1, nextCode);\r\n                    } else if (isValidEscape(code, nextCode)) {\r\n                        // Otherwise, (the stream starts with a valid escape) consume\r\n                        // an escaped code point and append the returned code point to\r\n                        // the <string-token>’s value.\r\n                        offset = consumeEscaped(source, offset) - 1;\r\n                    }\r\n                    break;\r\n\r\n                // anything else\r\n                // Append the current input code point to the <string-token>’s value.\r\n            }\r\n        }\r\n    }\r\n\r\n    // § 4.3.6. Consume a url token\r\n    // Note: This algorithm assumes that the initial \"url(\" has already been consumed.\r\n    // This algorithm also assumes that it’s being called to consume an \"unquoted\" value, like url(foo).\r\n    // A quoted value, like url(\"foo\"), is parsed as a <function-token>. Consume an ident-like token\r\n    // automatically handles this distinction; this algorithm shouldn’t be called directly otherwise.\r\n    function consumeUrlToken() {\r\n        // Initially create a <url-token> with its value set to the empty string.\r\n        type = TYPE.Url;\r\n\r\n        // Consume as much whitespace as possible.\r\n        offset = findWhiteSpaceEnd(source, offset);\r\n\r\n        // Repeatedly consume the next input code point from the stream:\r\n        for (; offset < source.length; offset++) {\r\n            var code = source.charCodeAt(offset);\r\n\r\n            switch (charCodeCategory(code)) {\r\n                // U+0029 RIGHT PARENTHESIS ())\r\n                case 0x0029:\r\n                    // Return the <url-token>.\r\n                    offset++;\r\n                    return;\r\n\r\n                // EOF\r\n                case charCodeCategory.Eof:\r\n                    // This is a parse error. Return the <url-token>.\r\n                    return;\r\n\r\n                // whitespace\r\n                case charCodeCategory.WhiteSpace:\r\n                    // Consume as much whitespace as possible.\r\n                    offset = findWhiteSpaceEnd(source, offset);\r\n\r\n                    // If the next input code point is U+0029 RIGHT PARENTHESIS ()) or EOF,\r\n                    // consume it and return the <url-token>\r\n                    // (if EOF was encountered, this is a parse error);\r\n                    if (getCharCode(offset) === 0x0029 || offset >= source.length) {\r\n                        if (offset < source.length) {\r\n                            offset++;\r\n                        }\r\n                        return;\r\n                    }\r\n\r\n                    // otherwise, consume the remnants of a bad url, create a <bad-url-token>,\r\n                    // and return it.\r\n                    offset = consumeBadUrlRemnants(source, offset);\r\n                    type = TYPE.BadUrl;\r\n                    return;\r\n\r\n                // U+0022 QUOTATION MARK (\")\r\n                // U+0027 APOSTROPHE (')\r\n                // U+0028 LEFT PARENTHESIS (()\r\n                // non-printable code point\r\n                case 0x0022:\r\n                case 0x0027:\r\n                case 0x0028:\r\n                case charCodeCategory.NonPrintable:\r\n                    // This is a parse error. Consume the remnants of a bad url,\r\n                    // create a <bad-url-token>, and return it.\r\n                    offset = consumeBadUrlRemnants(source, offset);\r\n                    type = TYPE.BadUrl;\r\n                    return;\r\n\r\n                // U+005C REVERSE SOLIDUS (\\)\r\n                case 0x005C:\r\n                    // If the stream starts with a valid escape, consume an escaped code point and\r\n                    // append the returned code point to the <url-token>’s value.\r\n                    if (isValidEscape(code, getCharCode(offset + 1))) {\r\n                        offset = consumeEscaped(source, offset) - 1;\r\n                        break;\r\n                    }\r\n\r\n                    // Otherwise, this is a parse error. Consume the remnants of a bad url,\r\n                    // create a <bad-url-token>, and return it.\r\n                    offset = consumeBadUrlRemnants(source, offset);\r\n                    type = TYPE.BadUrl;\r\n                    return;\r\n\r\n                // anything else\r\n                // Append the current input code point to the <url-token>’s value.\r\n            }\r\n        }\r\n    }\r\n\r\n    if (!stream) {\r\n        stream = new TokenStream();\r\n    }\r\n\r\n    // ensure source is a string\r\n    source = String(source || '');\r\n\r\n    var sourceLength = source.length;\r\n    var offsetAndType = adoptBuffer(stream.offsetAndType, sourceLength + 1); // +1 because of eof-token\r\n    var balance = adoptBuffer(stream.balance, sourceLength + 1);\r\n    var tokenCount = 0;\r\n    var start = isBOM(getCharCode(0));\r\n    var offset = start;\r\n    var balanceCloseType = 0;\r\n    var balanceStart = 0;\r\n    var balancePrev = 0;\r\n\r\n    // https://drafts.csswg.org/css-syntax-3/#consume-token\r\n    // § 4.3.1. Consume a token\r\n    while (offset < sourceLength) {\r\n        var code = source.charCodeAt(offset);\r\n        var type = 0;\r\n\r\n        balance[tokenCount] = sourceLength;\r\n\r\n        switch (charCodeCategory(code)) {\r\n            // whitespace\r\n            case charCodeCategory.WhiteSpace:\r\n                // Consume as much whitespace as possible. Return a <whitespace-token>.\r\n                type = TYPE.WhiteSpace;\r\n                offset = findWhiteSpaceEnd(source, offset + 1);\r\n                break;\r\n\r\n            // U+0022 QUOTATION MARK (\")\r\n            case 0x0022:\r\n                // Consume a string token and return it.\r\n                consumeStringToken();\r\n                break;\r\n\r\n            // U+0023 NUMBER SIGN (#)\r\n            case 0x0023:\r\n                // If the next input code point is a name code point or the next two input code points are a valid escape, then:\r\n                if (isName(getCharCode(offset + 1)) || isValidEscape(getCharCode(offset + 1), getCharCode(offset + 2))) {\r\n                    // Create a <hash-token>.\r\n                    type = TYPE.Hash;\r\n\r\n                    // If the next 3 input code points would start an identifier, set the <hash-token>’s type flag to \"id\".\r\n                    // if (isIdentifierStart(getCharCode(offset + 1), getCharCode(offset + 2), getCharCode(offset + 3))) {\r\n                    //     // TODO: set id flag\r\n                    // }\r\n\r\n                    // Consume a name, and set the <hash-token>’s value to the returned string.\r\n                    offset = consumeName(source, offset + 1);\r\n\r\n                    // Return the <hash-token>.\r\n                } else {\r\n                    // Otherwise, return a <delim-token> with its value set to the current input code point.\r\n                    type = TYPE.Delim;\r\n                    offset++;\r\n                }\r\n\r\n                break;\r\n\r\n            // U+0027 APOSTROPHE (')\r\n            case 0x0027:\r\n                // Consume a string token and return it.\r\n                consumeStringToken();\r\n                break;\r\n\r\n            // U+0028 LEFT PARENTHESIS (()\r\n            case 0x0028:\r\n                // Return a <(-token>.\r\n                type = TYPE.LeftParenthesis;\r\n                offset++;\r\n                break;\r\n\r\n            // U+0029 RIGHT PARENTHESIS ())\r\n            case 0x0029:\r\n                // Return a <)-token>.\r\n                type = TYPE.RightParenthesis;\r\n                offset++;\r\n                break;\r\n\r\n            // U+002B PLUS SIGN (+)\r\n            case 0x002B:\r\n                // If the input stream starts with a number, ...\r\n                if (isNumberStart(code, getCharCode(offset + 1), getCharCode(offset + 2))) {\r\n                    // ... reconsume the current input code point, consume a numeric token, and return it.\r\n                    consumeNumericToken();\r\n                } else {\r\n                    // Otherwise, return a <delim-token> with its value set to the current input code point.\r\n                    type = TYPE.Delim;\r\n                    offset++;\r\n                }\r\n                break;\r\n\r\n            // U+002C COMMA (,)\r\n            case 0x002C:\r\n                // Return a <comma-token>.\r\n                type = TYPE.Comma;\r\n                offset++;\r\n                break;\r\n\r\n            // U+002D HYPHEN-MINUS (-)\r\n            case 0x002D:\r\n                // If the input stream starts with a number, reconsume the current input code point, consume a numeric token, and return it.\r\n                if (isNumberStart(code, getCharCode(offset + 1), getCharCode(offset + 2))) {\r\n                    consumeNumericToken();\r\n                } else {\r\n                    // Otherwise, if the next 2 input code points are U+002D HYPHEN-MINUS U+003E GREATER-THAN SIGN (->), consume them and return a <CDC-token>.\r\n                    if (getCharCode(offset + 1) === 0x002D &&\r\n                        getCharCode(offset + 2) === 0x003E) {\r\n                        type = TYPE.CDC;\r\n                        offset = offset + 3;\r\n                    } else {\r\n                        // Otherwise, if the input stream starts with an identifier, ...\r\n                        if (isIdentifierStart(code, getCharCode(offset + 1), getCharCode(offset + 2))) {\r\n                            // ... reconsume the current input code point, consume an ident-like token, and return it.\r\n                            consumeIdentLikeToken();\r\n                        } else {\r\n                            // Otherwise, return a <delim-token> with its value set to the current input code point.\r\n                            type = TYPE.Delim;\r\n                            offset++;\r\n                        }\r\n                    }\r\n                }\r\n                break;\r\n\r\n            // U+002E FULL STOP (.)\r\n            case 0x002E:\r\n                // If the input stream starts with a number, ...\r\n                if (isNumberStart(code, getCharCode(offset + 1), getCharCode(offset + 2))) {\r\n                    // ... reconsume the current input code point, consume a numeric token, and return it.\r\n                    consumeNumericToken();\r\n                } else {\r\n                    // Otherwise, return a <delim-token> with its value set to the current input code point.\r\n                    type = TYPE.Delim;\r\n                    offset++;\r\n                }\r\n\r\n                break;\r\n\r\n            // U+002F SOLIDUS (/)\r\n            case 0x002F:\r\n                // If the next two input code point are U+002F SOLIDUS (/) followed by a U+002A ASTERISK (*),\r\n                if (getCharCode(offset + 1) === 0x002A) {\r\n                    // ... consume them and all following code points up to and including the first U+002A ASTERISK (*)\r\n                    // followed by a U+002F SOLIDUS (/), or up to an EOF code point.\r\n                    type = TYPE.Comment;\r\n                    offset = source.indexOf('*/', offset + 2) + 2;\r\n                    if (offset === 1) {\r\n                        offset = source.length;\r\n                    }\r\n                } else {\r\n                    type = TYPE.Delim;\r\n                    offset++;\r\n                }\r\n                break;\r\n\r\n            // U+003A COLON (:)\r\n            case 0x003A:\r\n                // Return a <colon-token>.\r\n                type = TYPE.Colon;\r\n                offset++;\r\n                break;\r\n\r\n            // U+003B SEMICOLON (;)\r\n            case 0x003B:\r\n                // Return a <semicolon-token>.\r\n                type = TYPE.Semicolon;\r\n                offset++;\r\n                break;\r\n\r\n            // U+003C LESS-THAN SIGN (<)\r\n            case 0x003C:\r\n                // If the next 3 input code points are U+0021 EXCLAMATION MARK U+002D HYPHEN-MINUS U+002D HYPHEN-MINUS (!--), ...\r\n                if (getCharCode(offset + 1) === 0x0021 &&\r\n                    getCharCode(offset + 2) === 0x002D &&\r\n                    getCharCode(offset + 3) === 0x002D) {\r\n                    // ... consume them and return a <CDO-token>.\r\n                    type = TYPE.CDO;\r\n                    offset = offset + 4;\r\n                } else {\r\n                    // Otherwise, return a <delim-token> with its value set to the current input code point.\r\n                    type = TYPE.Delim;\r\n                    offset++;\r\n                }\r\n\r\n                break;\r\n\r\n            // U+0040 COMMERCIAL AT (@)\r\n            case 0x0040:\r\n                // If the next 3 input code points would start an identifier, ...\r\n                if (isIdentifierStart(getCharCode(offset + 1), getCharCode(offset + 2), getCharCode(offset + 3))) {\r\n                    // ... consume a name, create an <at-keyword-token> with its value set to the returned value, and return it.\r\n                    type = TYPE.AtKeyword;\r\n                    offset = consumeName(source, offset + 1);\r\n                } else {\r\n                    // Otherwise, return a <delim-token> with its value set to the current input code point.\r\n                    type = TYPE.Delim;\r\n                    offset++;\r\n                }\r\n\r\n                break;\r\n\r\n            // U+005B LEFT SQUARE BRACKET ([)\r\n            case 0x005B:\r\n                // Return a <[-token>.\r\n                type = TYPE.LeftSquareBracket;\r\n                offset++;\r\n                break;\r\n\r\n            // U+005C REVERSE SOLIDUS (\\)\r\n            case 0x005C:\r\n                // If the input stream starts with a valid escape, ...\r\n                if (isValidEscape(code, getCharCode(offset + 1))) {\r\n                    // ... reconsume the current input code point, consume an ident-like token, and return it.\r\n                    consumeIdentLikeToken();\r\n                } else {\r\n                    // Otherwise, this is a parse error. Return a <delim-token> with its value set to the current input code point.\r\n                    type = TYPE.Delim;\r\n                    offset++;\r\n                }\r\n                break;\r\n\r\n            // U+005D RIGHT SQUARE BRACKET (])\r\n            case 0x005D:\r\n                // Return a <]-token>.\r\n                type = TYPE.RightSquareBracket;\r\n                offset++;\r\n                break;\r\n\r\n            // U+007B LEFT CURLY BRACKET ({)\r\n            case 0x007B:\r\n                // Return a <{-token>.\r\n                type = TYPE.LeftCurlyBracket;\r\n                offset++;\r\n                break;\r\n\r\n            // U+007D RIGHT CURLY BRACKET (})\r\n            case 0x007D:\r\n                // Return a <}-token>.\r\n                type = TYPE.RightCurlyBracket;\r\n                offset++;\r\n                break;\r\n\r\n            // digit\r\n            case charCodeCategory.Digit:\r\n                // Reconsume the current input code point, consume a numeric token, and return it.\r\n                consumeNumericToken();\r\n                break;\r\n\r\n            // name-start code point\r\n            case charCodeCategory.NameStart:\r\n                // Reconsume the current input code point, consume an ident-like token, and return it.\r\n                consumeIdentLikeToken();\r\n                break;\r\n\r\n            // EOF\r\n            case charCodeCategory.Eof:\r\n                // Return an <EOF-token>.\r\n                break;\r\n\r\n            // anything else\r\n            default:\r\n                // Return a <delim-token> with its value set to the current input code point.\r\n                type = TYPE.Delim;\r\n                offset++;\r\n        }\r\n\r\n        switch (type) {\r\n            case balanceCloseType:\r\n                balancePrev = balanceStart & OFFSET_MASK;\r\n                balanceStart = balance[balancePrev];\r\n                balanceCloseType = balanceStart >> TYPE_SHIFT;\r\n                balance[tokenCount] = balancePrev;\r\n                balance[balancePrev++] = tokenCount;\r\n                for (; balancePrev < tokenCount; balancePrev++) {\r\n                    if (balance[balancePrev] === sourceLength) {\r\n                        balance[balancePrev] = tokenCount;\r\n                    }\r\n                }\r\n                break;\r\n\r\n            case TYPE.LeftParenthesis:\r\n            case TYPE.Function:\r\n                balance[tokenCount] = balanceStart;\r\n                balanceCloseType = TYPE.RightParenthesis;\r\n                balanceStart = (balanceCloseType << TYPE_SHIFT) | tokenCount;\r\n                break;\r\n\r\n            case TYPE.LeftSquareBracket:\r\n                balance[tokenCount] = balanceStart;\r\n                balanceCloseType = TYPE.RightSquareBracket;\r\n                balanceStart = (balanceCloseType << TYPE_SHIFT) | tokenCount;\r\n                break;\r\n\r\n            case TYPE.LeftCurlyBracket:\r\n                balance[tokenCount] = balanceStart;\r\n                balanceCloseType = TYPE.RightCurlyBracket;\r\n                balanceStart = (balanceCloseType << TYPE_SHIFT) | tokenCount;\r\n                break;\r\n        }\r\n\r\n        offsetAndType[tokenCount++] = (type << TYPE_SHIFT) | offset;\r\n    }\r\n\r\n    // finalize buffers\r\n    offsetAndType[tokenCount] = (TYPE.EOF << TYPE_SHIFT) | offset; // <EOF-token>\r\n    balance[tokenCount] = sourceLength;\r\n    balance[sourceLength] = sourceLength; // prevents false positive balance match with any token\r\n    while (balanceStart !== 0) {\r\n        balancePrev = balanceStart & OFFSET_MASK;\r\n        balanceStart = balance[balancePrev];\r\n        balance[balancePrev] = sourceLength;\r\n    }\r\n\r\n    // update stream\r\n    stream.source = source;\r\n    stream.firstCharOffset = start;\r\n    stream.offsetAndType = offsetAndType;\r\n    stream.tokenCount = tokenCount;\r\n    stream.balance = balance;\r\n    stream.reset();\r\n    stream.next();\r\n\r\n    return stream;\r\n}\r\n\r\n// extend tokenizer with constants\r\nObject.keys(constants).forEach(function(key) {\r\n    tokenize[key] = constants[key];\r\n});\r\n\r\n// extend tokenizer with static methods from utils\r\nObject.keys(charCodeDefinitions).forEach(function(key) {\r\n    tokenize[key] = charCodeDefinitions[key];\r\n});\r\nObject.keys(utils).forEach(function(key) {\r\n    tokenize[key] = utils[key];\r\n});\r\n\r\nmodule.exports = tokenize;\r\n","var isDigit = require('../tokenizer').isDigit;\r\nvar cmpChar = require('../tokenizer').cmpChar;\r\nvar TYPE = require('../tokenizer').TYPE;\r\n\r\nvar DELIM = TYPE.Delim;\r\nvar WHITESPACE = TYPE.WhiteSpace;\r\nvar COMMENT = TYPE.Comment;\r\nvar IDENT = TYPE.Ident;\r\nvar NUMBER = TYPE.Number;\r\nvar DIMENSION = TYPE.Dimension;\r\nvar PLUSSIGN = 0x002B;    // U+002B PLUS SIGN (+)\r\nvar HYPHENMINUS = 0x002D; // U+002D HYPHEN-MINUS (-)\r\nvar N = 0x006E;           // U+006E LATIN SMALL LETTER N (n)\r\nvar DISALLOW_SIGN = true;\r\nvar ALLOW_SIGN = false;\r\n\r\nfunction isDelim(token, code) {\r\n    return token !== null && token.type === DELIM && token.value.charCodeAt(0) === code;\r\n}\r\n\r\nfunction skipSC(token, offset, getNextToken) {\r\n    while (token !== null && (token.type === WHITESPACE || token.type === COMMENT)) {\r\n        token = getNextToken(++offset);\r\n    }\r\n\r\n    return offset;\r\n}\r\n\r\nfunction checkInteger(token, valueOffset, disallowSign, offset) {\r\n    if (!token) {\r\n        return 0;\r\n    }\r\n\r\n    var code = token.value.charCodeAt(valueOffset);\r\n\r\n    if (code === PLUSSIGN || code === HYPHENMINUS) {\r\n        if (disallowSign) {\r\n            // Number sign is not allowed\r\n            return 0;\r\n        }\r\n        valueOffset++;\r\n    }\r\n\r\n    for (; valueOffset < token.value.length; valueOffset++) {\r\n        if (!isDigit(token.value.charCodeAt(valueOffset))) {\r\n            // Integer is expected\r\n            return 0;\r\n        }\r\n    }\r\n\r\n    return offset + 1;\r\n}\r\n\r\n// ... <signed-integer>\r\n// ... ['+' | '-'] <signless-integer>\r\nfunction consumeB(token, offset_, getNextToken) {\r\n    var sign = false;\r\n    var offset = skipSC(token, offset_, getNextToken);\r\n\r\n    token = getNextToken(offset);\r\n\r\n    if (token === null) {\r\n        return offset_;\r\n    }\r\n\r\n    if (token.type !== NUMBER) {\r\n        if (isDelim(token, PLUSSIGN) || isDelim(token, HYPHENMINUS)) {\r\n            sign = true;\r\n            offset = skipSC(getNextToken(++offset), offset, getNextToken);\r\n            token = getNextToken(offset);\r\n\r\n            if (token === null && token.type !== NUMBER) {\r\n                return 0;\r\n            }\r\n        } else {\r\n            return offset_;\r\n        }\r\n    }\r\n\r\n    if (!sign) {\r\n        var code = token.value.charCodeAt(0);\r\n        if (code !== PLUSSIGN && code !== HYPHENMINUS) {\r\n            // Number sign is expected\r\n            return 0;\r\n        }\r\n    }\r\n\r\n    return checkInteger(token, sign ? 0 : 1, sign, offset);\r\n}\r\n\r\n// An+B microsyntax https://www.w3.org/TR/css-syntax-3/#anb\r\nmodule.exports = function anPlusB(token, getNextToken) {\r\n    /* eslint-disable brace-style*/\r\n    var offset = 0;\r\n\r\n    if (!token) {\r\n        return 0;\r\n    }\r\n\r\n    // <integer>\r\n    if (token.type === NUMBER) {\r\n        return checkInteger(token, 0, ALLOW_SIGN, offset); // b\r\n    }\r\n\r\n    // -n\r\n    // -n <signed-integer>\r\n    // -n ['+' | '-'] <signless-integer>\r\n    // -n- <signless-integer>\r\n    // <dashndashdigit-ident>\r\n    else if (token.type === IDENT && token.value.charCodeAt(0) === HYPHENMINUS) {\r\n        // expect 1st char is N\r\n        if (!cmpChar(token.value, 1, N)) {\r\n            return 0;\r\n        }\r\n\r\n        switch (token.value.length) {\r\n            // -n\r\n            // -n <signed-integer>\r\n            // -n ['+' | '-'] <signless-integer>\r\n            case 2:\r\n                return consumeB(getNextToken(++offset), offset, getNextToken);\r\n\r\n            // -n- <signless-integer>\r\n            case 3:\r\n                if (token.value.charCodeAt(2) !== HYPHENMINUS) {\r\n                    return 0;\r\n                }\r\n\r\n                offset = skipSC(getNextToken(++offset), offset, getNextToken);\r\n                token = getNextToken(offset);\r\n\r\n                return checkInteger(token, 0, DISALLOW_SIGN, offset);\r\n\r\n            // <dashndashdigit-ident>\r\n            default:\r\n                if (token.value.charCodeAt(2) !== HYPHENMINUS) {\r\n                    return 0;\r\n                }\r\n\r\n                return checkInteger(token, 3, DISALLOW_SIGN, offset);\r\n        }\r\n    }\r\n\r\n    // '+'? n\r\n    // '+'? n <signed-integer>\r\n    // '+'? n ['+' | '-'] <signless-integer>\r\n    // '+'? n- <signless-integer>\r\n    // '+'? <ndashdigit-ident>\r\n    else if (token.type === IDENT || (isDelim(token, PLUSSIGN) && getNextToken(offset + 1).type === IDENT)) {\r\n        // just ignore a plus\r\n        if (token.type !== IDENT) {\r\n            token = getNextToken(++offset);\r\n        }\r\n\r\n        if (token === null || !cmpChar(token.value, 0, N)) {\r\n            return 0;\r\n        }\r\n\r\n        switch (token.value.length) {\r\n            // '+'? n\r\n            // '+'? n <signed-integer>\r\n            // '+'? n ['+' | '-'] <signless-integer>\r\n            case 1:\r\n                return consumeB(getNextToken(++offset), offset, getNextToken);\r\n\r\n            // '+'? n- <signless-integer>\r\n            case 2:\r\n                if (token.value.charCodeAt(1) !== HYPHENMINUS) {\r\n                    return 0;\r\n                }\r\n\r\n                offset = skipSC(getNextToken(++offset), offset, getNextToken);\r\n                token = getNextToken(offset);\r\n\r\n                return checkInteger(token, 0, DISALLOW_SIGN, offset);\r\n\r\n            // '+'? <ndashdigit-ident>\r\n            default:\r\n                if (token.value.charCodeAt(1) !== HYPHENMINUS) {\r\n                    return 0;\r\n                }\r\n\r\n                return checkInteger(token, 2, DISALLOW_SIGN, offset);\r\n        }\r\n    }\r\n\r\n    // <ndashdigit-dimension>\r\n    // <ndash-dimension> <signless-integer>\r\n    // <n-dimension>\r\n    // <n-dimension> <signed-integer>\r\n    // <n-dimension> ['+' | '-'] <signless-integer>\r\n    else if (token.type === DIMENSION) {\r\n        var code = token.value.charCodeAt(0);\r\n        var sign = code === PLUSSIGN || code === HYPHENMINUS ? 1 : 0;\r\n\r\n        for (var i = sign; i < token.value.length; i++) {\r\n            if (!isDigit(token.value.charCodeAt(i))) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (i === sign) {\r\n            // Integer is expected\r\n            return 0;\r\n        }\r\n\r\n        if (!cmpChar(token.value, i, N)) {\r\n            return 0;\r\n        }\r\n\r\n        // <n-dimension>\r\n        // <n-dimension> <signed-integer>\r\n        // <n-dimension> ['+' | '-'] <signless-integer>\r\n        if (i + 1 === token.value.length) {\r\n            return consumeB(getNextToken(++offset), offset, getNextToken);\r\n        } else {\r\n            if (token.value.charCodeAt(i + 1) !== HYPHENMINUS) {\r\n                return 0;\r\n            }\r\n\r\n            // <ndash-dimension> <signless-integer>\r\n            if (i + 2 === token.value.length) {\r\n                offset = skipSC(getNextToken(++offset), offset, getNextToken);\r\n                token = getNextToken(offset);\r\n\r\n                return checkInteger(token, 0, DISALLOW_SIGN, offset);\r\n            }\r\n            // <ndashdigit-dimension>\r\n            else {\r\n                return checkInteger(token, i + 2, DISALLOW_SIGN, offset);\r\n            }\r\n        }\r\n    }\r\n\r\n    return 0;\r\n};\r\n","var isHexDigit = require('../tokenizer').isHexDigit;\r\nvar cmpChar = require('../tokenizer').cmpChar;\r\nvar TYPE = require('../tokenizer').TYPE;\r\n\r\nvar IDENT = TYPE.Ident;\r\nvar DELIM = TYPE.Delim;\r\nvar NUMBER = TYPE.Number;\r\nvar DIMENSION = TYPE.Dimension;\r\nvar PLUSSIGN = 0x002B;     // U+002B PLUS SIGN (+)\r\nvar HYPHENMINUS = 0x002D;  // U+002D HYPHEN-MINUS (-)\r\nvar QUESTIONMARK = 0x003F; // U+003F QUESTION MARK (?)\r\nvar U = 0x0075;            // U+0075 LATIN SMALL LETTER U (u)\r\n\r\nfunction isDelim(token, code) {\r\n    return token !== null && token.type === DELIM && token.value.charCodeAt(0) === code;\r\n}\r\n\r\nfunction startsWith(token, code) {\r\n    return token.value.charCodeAt(0) === code;\r\n}\r\n\r\nfunction hexSequence(token, offset, allowDash) {\r\n    for (var pos = offset, hexlen = 0; pos < token.value.length; pos++) {\r\n        var code = token.value.charCodeAt(pos);\r\n\r\n        if (code === HYPHENMINUS && allowDash && hexlen !== 0) {\r\n            if (hexSequence(token, offset + hexlen + 1, false) > 0) {\r\n                return 6; // dissallow following question marks\r\n            }\r\n\r\n            return 0; // dash at the ending of a hex sequence is not allowed\r\n        }\r\n\r\n        if (!isHexDigit(code)) {\r\n            return 0; // not a hex digit\r\n        }\r\n\r\n        if (++hexlen > 6) {\r\n            return 0; // too many hex digits\r\n        };\r\n    }\r\n\r\n    return hexlen;\r\n}\r\n\r\nfunction withQuestionMarkSequence(consumed, length, getNextToken) {\r\n    if (!consumed) {\r\n        return 0; // nothing consumed\r\n    }\r\n\r\n    while (isDelim(getNextToken(length), QUESTIONMARK)) {\r\n        if (++consumed > 6) {\r\n            return 0; // too many question marks\r\n        }\r\n\r\n        length++;\r\n    }\r\n\r\n    return length;\r\n}\r\n\r\n// https://drafts.csswg.org/css-syntax/#urange\r\n// Informally, the <urange> production has three forms:\r\n// U+0001\r\n//      Defines a range consisting of a single code point, in this case the code point \"1\".\r\n// U+0001-00ff\r\n//      Defines a range of codepoints between the first and the second value, in this case\r\n//      the range between \"1\" and \"ff\" (255 in decimal) inclusive.\r\n// U+00??\r\n//      Defines a range of codepoints where the \"?\" characters range over all hex digits,\r\n//      in this case defining the same as the value U+0000-00ff.\r\n// In each form, a maximum of 6 digits is allowed for each hexadecimal number (if you treat \"?\" as a hexadecimal digit).\r\n//\r\n// <urange> =\r\n//   u '+' <ident-token> '?'* |\r\n//   u <dimension-token> '?'* |\r\n//   u <number-token> '?'* |\r\n//   u <number-token> <dimension-token> |\r\n//   u <number-token> <number-token> |\r\n//   u '+' '?'+\r\nmodule.exports = function urange(token, getNextToken) {\r\n    var length = 0;\r\n\r\n    // should start with `u` or `U`\r\n    if (token === null || token.type !== IDENT || !cmpChar(token.value, 0, U)) {\r\n        return 0;\r\n    }\r\n\r\n    token = getNextToken(++length);\r\n    if (token === null) {\r\n        return 0;\r\n    }\r\n\r\n    // u '+' <ident-token> '?'*\r\n    // u '+' '?'+\r\n    if (isDelim(token, PLUSSIGN)) {\r\n        token = getNextToken(++length);\r\n        if (token === null) {\r\n            return 0;\r\n        }\r\n\r\n        if (token.type === IDENT) {\r\n            // u '+' <ident-token> '?'*\r\n            return withQuestionMarkSequence(hexSequence(token, 0, true), ++length, getNextToken);\r\n        }\r\n\r\n        if (isDelim(token, QUESTIONMARK)) {\r\n            // u '+' '?'+\r\n            return withQuestionMarkSequence(1, ++length, getNextToken);\r\n        }\r\n\r\n        // Hex digit or question mark is expected\r\n        return 0;\r\n    }\r\n\r\n    // u <number-token> '?'*\r\n    // u <number-token> <dimension-token>\r\n    // u <number-token> <number-token>\r\n    if (token.type === NUMBER) {\r\n        if (!startsWith(token, PLUSSIGN)) {\r\n            return 0;\r\n        }\r\n\r\n        var consumedHexLength = hexSequence(token, 1, true);\r\n        if (consumedHexLength === 0) {\r\n            return 0;\r\n        }\r\n\r\n        token = getNextToken(++length);\r\n        if (token === null) {\r\n            // u <number-token> <eof>\r\n            return length;\r\n        }\r\n\r\n        if (token.type === DIMENSION || token.type === NUMBER) {\r\n            // u <number-token> <dimension-token>\r\n            // u <number-token> <number-token>\r\n            if (!startsWith(token, HYPHENMINUS) || !hexSequence(token, 1, false)) {\r\n                return 0;\r\n            }\r\n\r\n            return length + 1;\r\n        }\r\n\r\n        // u <number-token> '?'*\r\n        return withQuestionMarkSequence(consumedHexLength, length, getNextToken);\r\n    }\r\n\r\n    // u <dimension-token> '?'*\r\n    if (token.type === DIMENSION) {\r\n        if (!startsWith(token, PLUSSIGN)) {\r\n            return 0;\r\n        }\r\n\r\n        return withQuestionMarkSequence(hexSequence(token, 1, true), ++length, getNextToken);\r\n    }\r\n\r\n    return 0;\r\n};\r\n","var tokenizer = require('../tokenizer');\r\nvar isIdentifierStart = tokenizer.isIdentifierStart;\r\nvar isHexDigit = tokenizer.isHexDigit;\r\nvar isDigit = tokenizer.isDigit;\r\nvar cmpStr = tokenizer.cmpStr;\r\nvar consumeNumber = tokenizer.consumeNumber;\r\nvar TYPE = tokenizer.TYPE;\r\nvar anPlusB = require('./generic-an-plus-b');\r\nvar urange = require('./generic-urange');\r\n\r\nvar cssWideKeywords = ['unset', 'initial', 'inherit'];\r\nvar calcFunctionNames = ['calc(', '-moz-calc(', '-webkit-calc('];\r\n\r\n// https://www.w3.org/TR/css-values-3/#lengths\r\nvar LENGTH = {\r\n    // absolute length units\r\n    'px': true,\r\n    'mm': true,\r\n    'cm': true,\r\n    'in': true,\r\n    'pt': true,\r\n    'pc': true,\r\n    'q': true,\r\n\r\n    // relative length units\r\n    'em': true,\r\n    'ex': true,\r\n    'ch': true,\r\n    'rem': true,\r\n\r\n    // viewport-percentage lengths\r\n    'vh': true,\r\n    'vw': true,\r\n    'vmin': true,\r\n    'vmax': true,\r\n    'vm': true\r\n};\r\n\r\nvar ANGLE = {\r\n    'deg': true,\r\n    'grad': true,\r\n    'rad': true,\r\n    'turn': true\r\n};\r\n\r\nvar TIME = {\r\n    's': true,\r\n    'ms': true\r\n};\r\n\r\nvar FREQUENCY = {\r\n    'hz': true,\r\n    'khz': true\r\n};\r\n\r\n// https://www.w3.org/TR/css-values-3/#resolution (https://drafts.csswg.org/css-values/#resolution)\r\nvar RESOLUTION = {\r\n    'dpi': true,\r\n    'dpcm': true,\r\n    'dppx': true,\r\n    'x': true      // https://github.com/w3c/csswg-drafts/issues/461\r\n};\r\n\r\n// https://drafts.csswg.org/css-grid/#fr-unit\r\nvar FLEX = {\r\n    'fr': true\r\n};\r\n\r\n// https://www.w3.org/TR/css3-speech/#mixing-props-voice-volume\r\nvar DECIBEL = {\r\n    'db': true\r\n};\r\n\r\n// https://www.w3.org/TR/css3-speech/#voice-props-voice-pitch\r\nvar SEMITONES = {\r\n    'st': true\r\n};\r\n\r\n// safe char code getter\r\nfunction charCode(str, index) {\r\n    return index < str.length ? str.charCodeAt(index) : 0;\r\n}\r\n\r\nfunction eqStr(actual, expected) {\r\n    return cmpStr(actual, 0, actual.length, expected);\r\n}\r\n\r\nfunction eqStrAny(actual, expected) {\r\n    for (var i = 0; i < expected.length; i++) {\r\n        if (eqStr(actual, expected[i])) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\n// IE postfix hack, i.e. 123\\0 or 123px\\9\r\nfunction isPostfixIeHack(str, offset) {\r\n    if (offset !== str.length - 2) {\r\n        return false;\r\n    }\r\n\r\n    return (\r\n        str.charCodeAt(offset) === 0x005C &&  // U+005C REVERSE SOLIDUS (\\)\r\n        isDigit(str.charCodeAt(offset + 1))\r\n    );\r\n}\r\n\r\nfunction outOfRange(opts, value, numEnd) {\r\n    if (opts && opts.type === 'Range') {\r\n        var num = Number(\r\n            numEnd !== undefined && numEnd !== value.length\r\n                ? value.substr(0, numEnd)\r\n                : value\r\n        );\r\n\r\n        if (isNaN(num)) {\r\n            return true;\r\n        }\r\n\r\n        if (opts.min !== null && num < opts.min) {\r\n            return true;\r\n        }\r\n\r\n        if (opts.max !== null && num > opts.max) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nfunction consumeFunction(token, getNextToken) {\r\n    var startIdx = token.index;\r\n    var length = 0;\r\n\r\n    // balanced token consuming\r\n    do {\r\n        length++;\r\n\r\n        if (token.balance <= startIdx) {\r\n            break;\r\n        }\r\n    } while (token = getNextToken(length));\r\n\r\n    return length;\r\n}\r\n\r\n// TODO: implement\r\n// can be used wherever <length>, <frequency>, <angle>, <time>, <percentage>, <number>, or <integer> values are allowed\r\n// https://drafts.csswg.org/css-values/#calc-notation\r\nfunction calc(next) {\r\n    return function(token, getNextToken, opts) {\r\n        if (token === null) {\r\n            return 0;\r\n        }\r\n\r\n        if (token.type === TYPE.Function && eqStrAny(token.value, calcFunctionNames)) {\r\n            return consumeFunction(token, getNextToken);\r\n        }\r\n\r\n        return next(token, getNextToken, opts);\r\n    };\r\n}\r\n\r\nfunction tokenType(expectedTokenType) {\r\n    return function(token) {\r\n        if (token === null || token.type !== expectedTokenType) {\r\n            return 0;\r\n        }\r\n\r\n        return 1;\r\n    };\r\n}\r\n\r\nfunction func(name) {\r\n    name = name + '(';\r\n\r\n    return function(token, getNextToken) {\r\n        if (token !== null && eqStr(token.value, name)) {\r\n            return consumeFunction(token, getNextToken);\r\n        }\r\n\r\n        return 0;\r\n    };\r\n}\r\n\r\n// =========================\r\n// Complex types\r\n//\r\n\r\n// https://drafts.csswg.org/css-values-4/#custom-idents\r\n// 4.2. Author-defined Identifiers: the <custom-ident> type\r\n// Some properties accept arbitrary author-defined identifiers as a component value.\r\n// This generic data type is denoted by <custom-ident>, and represents any valid CSS identifier\r\n// that would not be misinterpreted as a pre-defined keyword in that property’s value definition.\r\n//\r\n// See also: https://developer.mozilla.org/en-US/docs/Web/CSS/custom-ident\r\nfunction customIdent(token) {\r\n    if (token === null || token.type !== TYPE.Ident) {\r\n        return 0;\r\n    }\r\n\r\n    var name = token.value.toLowerCase();\r\n\r\n    // The CSS-wide keywords are not valid <custom-ident>s\r\n    if (eqStrAny(name, cssWideKeywords)) {\r\n        return 0;\r\n    }\r\n\r\n    // The default keyword is reserved and is also not a valid <custom-ident>\r\n    if (eqStr(name, 'default')) {\r\n        return 0;\r\n    }\r\n\r\n    // TODO: ignore property specific keywords (as described https://developer.mozilla.org/en-US/docs/Web/CSS/custom-ident)\r\n    // Specifications using <custom-ident> must specify clearly what other keywords\r\n    // are excluded from <custom-ident>, if any—for example by saying that any pre-defined keywords\r\n    // in that property’s value definition are excluded. Excluded keywords are excluded\r\n    // in all ASCII case permutations.\r\n\r\n    return 1;\r\n}\r\n\r\n// https://drafts.csswg.org/css-variables/#typedef-custom-property-name\r\n// A custom property is any property whose name starts with two dashes (U+002D HYPHEN-MINUS), like --foo.\r\n// The <custom-property-name> production corresponds to this: it’s defined as any valid identifier\r\n// that starts with two dashes, except -- itself, which is reserved for future use by CSS.\r\n// NOTE: Current implementation treat `--` as a valid name since most (all?) major browsers treat it as valid.\r\nfunction customPropertyName(token) {\r\n    // ... defined as any valid identifier\r\n    if (token === null || token.type !== TYPE.Ident) {\r\n        return 0;\r\n    }\r\n\r\n    // ... that starts with two dashes (U+002D HYPHEN-MINUS)\r\n    if (charCode(token.value, 0) !== 0x002D || charCode(token.value, 1) !== 0x002D) {\r\n        return 0;\r\n    }\r\n\r\n    return 1;\r\n}\r\n\r\n// https://drafts.csswg.org/css-color-4/#hex-notation\r\n// The syntax of a <hex-color> is a <hash-token> token whose value consists of 3, 4, 6, or 8 hexadecimal digits.\r\n// In other words, a hex color is written as a hash character, \"#\", followed by some number of digits 0-9 or\r\n// letters a-f (the case of the letters doesn’t matter - #00ff00 is identical to #00FF00).\r\nfunction hexColor(token) {\r\n    if (token === null || token.type !== TYPE.Hash) {\r\n        return 0;\r\n    }\r\n\r\n    var length = token.value.length;\r\n\r\n    // valid values (length): #rgb (4), #rgba (5), #rrggbb (7), #rrggbbaa (9)\r\n    if (length !== 4 && length !== 5 && length !== 7 && length !== 9) {\r\n        return 0;\r\n    }\r\n\r\n    for (var i = 1; i < length; i++) {\r\n        if (!isHexDigit(token.value.charCodeAt(i))) {\r\n            return 0;\r\n        }\r\n    }\r\n\r\n    return 1;\r\n}\r\n\r\nfunction idSelector(token) {\r\n    if (token === null || token.type !== TYPE.Hash) {\r\n        return 0;\r\n    }\r\n\r\n    if (!isIdentifierStart(charCode(token.value, 1), charCode(token.value, 2), charCode(token.value, 3))) {\r\n        return 0;\r\n    }\r\n\r\n    return 1;\r\n}\r\n\r\n// https://drafts.csswg.org/css-syntax/#any-value\r\n// It represents the entirety of what a valid declaration can have as its value.\r\nfunction declarationValue(token, getNextToken) {\r\n    if (!token) {\r\n        return 0;\r\n    }\r\n\r\n    var length = 0;\r\n    var level = 0;\r\n    var startIdx = token.index;\r\n\r\n    // The <declaration-value> production matches any sequence of one or more tokens,\r\n    // so long as the sequence ...\r\n    scan:\r\n    do {\r\n        switch (token.type) {\r\n            // ... does not contain <bad-string-token>, <bad-url-token>,\r\n            case TYPE.BadString:\r\n            case TYPE.BadUrl:\r\n                break scan;\r\n\r\n            // ... unmatched <)-token>, <]-token>, or <}-token>,\r\n            case TYPE.RightCurlyBracket:\r\n            case TYPE.RightParenthesis:\r\n            case TYPE.RightSquareBracket:\r\n                if (token.balance > token.index || token.balance < startIdx) {\r\n                    break scan;\r\n                }\r\n\r\n                level--;\r\n                break;\r\n\r\n            // ... or top-level <semicolon-token> tokens\r\n            case TYPE.Semicolon:\r\n                if (level === 0) {\r\n                    break scan;\r\n                }\r\n\r\n                break;\r\n\r\n            // ... or <delim-token> tokens with a value of \"!\"\r\n            case TYPE.Delim:\r\n                if (token.value === '!' && level === 0) {\r\n                    break scan;\r\n                }\r\n\r\n                break;\r\n\r\n            case TYPE.Function:\r\n            case TYPE.LeftParenthesis:\r\n            case TYPE.LeftSquareBracket:\r\n            case TYPE.LeftCurlyBracket:\r\n                level++;\r\n                break;\r\n        }\r\n\r\n        length++;\r\n\r\n        // until balance closing\r\n        if (token.balance <= startIdx) {\r\n            break;\r\n        }\r\n    } while (token = getNextToken(length));\r\n\r\n    return length;\r\n}\r\n\r\n// https://drafts.csswg.org/css-syntax/#any-value\r\n// The <any-value> production is identical to <declaration-value>, but also\r\n// allows top-level <semicolon-token> tokens and <delim-token> tokens\r\n// with a value of \"!\". It represents the entirety of what valid CSS can be in any context.\r\nfunction anyValue(token, getNextToken) {\r\n    if (!token) {\r\n        return 0;\r\n    }\r\n\r\n    var startIdx = token.index;\r\n    var length = 0;\r\n\r\n    // The <any-value> production matches any sequence of one or more tokens,\r\n    // so long as the sequence ...\r\n    scan:\r\n    do {\r\n        switch (token.type) {\r\n            // ... does not contain <bad-string-token>, <bad-url-token>,\r\n            case TYPE.BadString:\r\n            case TYPE.BadUrl:\r\n                break scan;\r\n\r\n            // ... unmatched <)-token>, <]-token>, or <}-token>,\r\n            case TYPE.RightCurlyBracket:\r\n            case TYPE.RightParenthesis:\r\n            case TYPE.RightSquareBracket:\r\n                if (token.balance > token.index || token.balance < startIdx) {\r\n                    break scan;\r\n                }\r\n\r\n                break;\r\n        }\r\n\r\n        length++;\r\n\r\n        // until balance closing\r\n        if (token.balance <= startIdx) {\r\n            break;\r\n        }\r\n    } while (token = getNextToken(length));\r\n\r\n    return length;\r\n}\r\n\r\n// =========================\r\n// Dimensions\r\n//\r\n\r\nfunction dimension(type) {\r\n    return function(token, getNextToken, opts) {\r\n        if (token === null || token.type !== TYPE.Dimension) {\r\n            return 0;\r\n        }\r\n\r\n        var numberEnd = consumeNumber(token.value, 0);\r\n\r\n        // check unit\r\n        if (type !== null) {\r\n            // check for IE postfix hack, i.e. 123px\\0 or 123px\\9\r\n            var reverseSolidusOffset = token.value.indexOf('\\\\', numberEnd);\r\n            var unit = reverseSolidusOffset === -1 || !isPostfixIeHack(token.value, reverseSolidusOffset)\r\n                ? token.value.substr(numberEnd)\r\n                : token.value.substring(numberEnd, reverseSolidusOffset);\r\n\r\n            if (type.hasOwnProperty(unit.toLowerCase()) === false) {\r\n                return 0;\r\n            }\r\n        }\r\n\r\n        // check range if specified\r\n        if (outOfRange(opts, token.value, numberEnd)) {\r\n            return 0;\r\n        }\r\n\r\n        return 1;\r\n    };\r\n}\r\n\r\n// =========================\r\n// Percentage\r\n//\r\n\r\n// §5.5. Percentages: the <percentage> type\r\n// https://drafts.csswg.org/css-values-4/#percentages\r\nfunction percentage(token, getNextToken, opts) {\r\n    // ... corresponds to the <percentage-token> production\r\n    if (token === null || token.type !== TYPE.Percentage) {\r\n        return 0;\r\n    }\r\n\r\n    // check range if specified\r\n    if (outOfRange(opts, token.value, token.value.length - 1)) {\r\n        return 0;\r\n    }\r\n\r\n    return 1;\r\n}\r\n\r\n// =========================\r\n// Numeric\r\n//\r\n\r\n// https://drafts.csswg.org/css-values-4/#numbers\r\n// The value <zero> represents a literal number with the value 0. Expressions that merely\r\n// evaluate to a <number> with the value 0 (for example, calc(0)) do not match <zero>;\r\n// only literal <number-token>s do.\r\nfunction zero(next) {\r\n    if (typeof next !== 'function') {\r\n        next = function() {\r\n            return 0;\r\n        };\r\n    }\r\n\r\n    return function(token, getNextToken, opts) {\r\n        if (token !== null && token.type === TYPE.Number) {\r\n            if (Number(token.value) === 0) {\r\n                return 1;\r\n            }\r\n        }\r\n\r\n        return next(token, getNextToken, opts);\r\n    };\r\n}\r\n\r\n// § 5.3. Real Numbers: the <number> type\r\n// https://drafts.csswg.org/css-values-4/#numbers\r\n// Number values are denoted by <number>, and represent real numbers, possibly with a fractional component.\r\n// ... It corresponds to the <number-token> production\r\nfunction number(token, getNextToken, opts) {\r\n    if (token === null) {\r\n        return 0;\r\n    }\r\n\r\n    var numberEnd = consumeNumber(token.value, 0);\r\n    var isNumber = numberEnd === token.value.length;\r\n    if (!isNumber && !isPostfixIeHack(token.value, numberEnd)) {\r\n        return 0;\r\n    }\r\n\r\n    // check range if specified\r\n    if (outOfRange(opts, token.value, numberEnd)) {\r\n        return 0;\r\n    }\r\n\r\n    return 1;\r\n}\r\n\r\n// §5.2. Integers: the <integer> type\r\n// https://drafts.csswg.org/css-values-4/#integers\r\nfunction integer(token, getNextToken, opts) {\r\n    // ... corresponds to a subset of the <number-token> production\r\n    if (token === null || token.type !== TYPE.Number) {\r\n        return 0;\r\n    }\r\n\r\n    // The first digit of an integer may be immediately preceded by `-` or `+` to indicate the integer’s sign.\r\n    var i = token.value.charCodeAt(0) === 0x002B ||       // U+002B PLUS SIGN (+)\r\n            token.value.charCodeAt(0) === 0x002D ? 1 : 0; // U+002D HYPHEN-MINUS (-)\r\n\r\n    // When written literally, an integer is one or more decimal digits 0 through 9 ...\r\n    for (; i < token.value.length; i++) {\r\n        if (!isDigit(token.value.charCodeAt(i))) {\r\n            return 0;\r\n        }\r\n    }\r\n\r\n    // check range if specified\r\n    if (outOfRange(opts, token.value, i)) {\r\n        return 0;\r\n    }\r\n\r\n    return 1;\r\n}\r\n\r\nmodule.exports = {\r\n    // token types\r\n    'ident-token': tokenType(TYPE.Ident),\r\n    'function-token': tokenType(TYPE.Function),\r\n    'at-keyword-token': tokenType(TYPE.AtKeyword),\r\n    'hash-token': tokenType(TYPE.Hash),\r\n    'string-token': tokenType(TYPE.String),\r\n    'bad-string-token': tokenType(TYPE.BadString),\r\n    'url-token': tokenType(TYPE.Url),\r\n    'bad-url-token': tokenType(TYPE.BadUrl),\r\n    'delim-token': tokenType(TYPE.Delim),\r\n    'number-token': tokenType(TYPE.Number),\r\n    'percentage-token': tokenType(TYPE.Percentage),\r\n    'dimension-token': tokenType(TYPE.Dimension),\r\n    'whitespace-token': tokenType(TYPE.WhiteSpace),\r\n    'CDO-token': tokenType(TYPE.CDO),\r\n    'CDC-token': tokenType(TYPE.CDC),\r\n    'colon-token': tokenType(TYPE.Colon),\r\n    'semicolon-token': tokenType(TYPE.Semicolon),\r\n    'comma-token': tokenType(TYPE.Comma),\r\n    '[-token': tokenType(TYPE.LeftSquareBracket),\r\n    ']-token': tokenType(TYPE.RightSquareBracket),\r\n    '(-token': tokenType(TYPE.LeftParenthesis),\r\n    ')-token': tokenType(TYPE.RightParenthesis),\r\n    '{-token': tokenType(TYPE.LeftCurlyBracket),\r\n    '}-token': tokenType(TYPE.RightCurlyBracket),\r\n\r\n    // token type aliases\r\n    'string': tokenType(TYPE.String),\r\n    'ident': tokenType(TYPE.Ident),\r\n\r\n    // complex types\r\n    'custom-ident': customIdent,\r\n    'custom-property-name': customPropertyName,\r\n    'hex-color': hexColor,\r\n    'id-selector': idSelector, // element( <id-selector> )\r\n    'an-plus-b': anPlusB,\r\n    'urange': urange,\r\n    'declaration-value': declarationValue,\r\n    'any-value': anyValue,\r\n\r\n    // dimensions\r\n    'dimension': calc(dimension(null)),\r\n    'angle': calc(dimension(ANGLE)),\r\n    'decibel': calc(dimension(DECIBEL)),\r\n    'frequency': calc(dimension(FREQUENCY)),\r\n    'flex': calc(dimension(FLEX)),\r\n    'length': calc(zero(dimension(LENGTH))),\r\n    'resolution': calc(dimension(RESOLUTION)),\r\n    'semitones': calc(dimension(SEMITONES)),\r\n    'time': calc(dimension(TIME)),\r\n\r\n    // percentage\r\n    'percentage': calc(percentage),\r\n\r\n    // numeric\r\n    'zero': zero(),\r\n    'number': calc(number),\r\n    'integer': calc(integer),\r\n\r\n    // old IE stuff\r\n    '-ms-legacy-expression': func('expression')\r\n};\r\n","var createCustomError = require('../utils/createCustomError');\r\n\r\nmodule.exports = function SyntaxError(message, input, offset) {\r\n    var error = createCustomError('SyntaxError', message);\r\n\r\n    error.input = input;\r\n    error.offset = offset;\r\n    error.rawMessage = message;\r\n    error.message = error.rawMessage + '\\n' +\r\n        '  ' + error.input + '\\n' +\r\n        '--' + new Array((error.offset || error.input.length) + 1).join('-') + '^';\r\n\r\n    return error;\r\n};\r\n","var SyntaxError = require('./SyntaxError');\r\n\r\nvar TAB = 9;\r\nvar N = 10;\r\nvar F = 12;\r\nvar R = 13;\r\nvar SPACE = 32;\r\n\r\nvar Tokenizer = function(str) {\r\n    this.str = str;\r\n    this.pos = 0;\r\n};\r\n\r\nTokenizer.prototype = {\r\n    charCodeAt: function(pos) {\r\n        return pos < this.str.length ? this.str.charCodeAt(pos) : 0;\r\n    },\r\n    charCode: function() {\r\n        return this.charCodeAt(this.pos);\r\n    },\r\n    nextCharCode: function() {\r\n        return this.charCodeAt(this.pos + 1);\r\n    },\r\n    nextNonWsCode: function(pos) {\r\n        return this.charCodeAt(this.findWsEnd(pos));\r\n    },\r\n    findWsEnd: function(pos) {\r\n        for (; pos < this.str.length; pos++) {\r\n            var code = this.str.charCodeAt(pos);\r\n            if (code !== R && code !== N && code !== F && code !== SPACE && code !== TAB) {\r\n                break;\r\n            }\r\n        }\r\n\r\n        return pos;\r\n    },\r\n    substringToPos: function(end) {\r\n        return this.str.substring(this.pos, this.pos = end);\r\n    },\r\n    eat: function(code) {\r\n        if (this.charCode() !== code) {\r\n            this.error('Expect `' + String.fromCharCode(code) + '`');\r\n        }\r\n\r\n        this.pos++;\r\n    },\r\n    peek: function() {\r\n        return this.pos < this.str.length ? this.str.charAt(this.pos++) : '';\r\n    },\r\n    error: function(message) {\r\n        throw new SyntaxError(message, this.str, this.pos);\r\n    }\r\n};\r\n\r\nmodule.exports = Tokenizer;\r\n","var Tokenizer = require('./tokenizer');\r\nvar TAB = 9;\r\nvar N = 10;\r\nvar F = 12;\r\nvar R = 13;\r\nvar SPACE = 32;\r\nvar EXCLAMATIONMARK = 33;    // !\r\nvar NUMBERSIGN = 35;         // #\r\nvar AMPERSAND = 38;          // &\r\nvar APOSTROPHE = 39;         // '\r\nvar LEFTPARENTHESIS = 40;    // (\r\nvar RIGHTPARENTHESIS = 41;   // )\r\nvar ASTERISK = 42;           // *\r\nvar PLUSSIGN = 43;           // +\r\nvar COMMA = 44;              // ,\r\nvar HYPERMINUS = 45;         // -\r\nvar LESSTHANSIGN = 60;       // <\r\nvar GREATERTHANSIGN = 62;    // >\r\nvar QUESTIONMARK = 63;       // ?\r\nvar COMMERCIALAT = 64;       // @\r\nvar LEFTSQUAREBRACKET = 91;  // [\r\nvar RIGHTSQUAREBRACKET = 93; // ]\r\nvar LEFTCURLYBRACKET = 123;  // {\r\nvar VERTICALLINE = 124;      // |\r\nvar RIGHTCURLYBRACKET = 125; // }\r\nvar INFINITY = 8734;         // ∞\r\nvar NAME_CHAR = createCharMap(function(ch) {\r\n    return /[a-zA-Z0-9\\-]/.test(ch);\r\n});\r\nvar COMBINATOR_PRECEDENCE = {\r\n    ' ': 1,\r\n    '&&': 2,\r\n    '||': 3,\r\n    '|': 4\r\n};\r\n\r\nfunction createCharMap(fn) {\r\n    var array = typeof Uint32Array === 'function' ? new Uint32Array(128) : new Array(128);\r\n    for (var i = 0; i < 128; i++) {\r\n        array[i] = fn(String.fromCharCode(i)) ? 1 : 0;\r\n    }\r\n    return array;\r\n}\r\n\r\nfunction scanSpaces(tokenizer) {\r\n    return tokenizer.substringToPos(\r\n        tokenizer.findWsEnd(tokenizer.pos)\r\n    );\r\n}\r\n\r\nfunction scanWord(tokenizer) {\r\n    var end = tokenizer.pos;\r\n\r\n    for (; end < tokenizer.str.length; end++) {\r\n        var code = tokenizer.str.charCodeAt(end);\r\n        if (code >= 128 || NAME_CHAR[code] === 0) {\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (tokenizer.pos === end) {\r\n        tokenizer.error('Expect a keyword');\r\n    }\r\n\r\n    return tokenizer.substringToPos(end);\r\n}\r\n\r\nfunction scanNumber(tokenizer) {\r\n    var end = tokenizer.pos;\r\n\r\n    for (; end < tokenizer.str.length; end++) {\r\n        var code = tokenizer.str.charCodeAt(end);\r\n        if (code < 48 || code > 57) {\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (tokenizer.pos === end) {\r\n        tokenizer.error('Expect a number');\r\n    }\r\n\r\n    return tokenizer.substringToPos(end);\r\n}\r\n\r\nfunction scanString(tokenizer) {\r\n    var end = tokenizer.str.indexOf('\\'', tokenizer.pos + 1);\r\n\r\n    if (end === -1) {\r\n        tokenizer.pos = tokenizer.str.length;\r\n        tokenizer.error('Expect an apostrophe');\r\n    }\r\n\r\n    return tokenizer.substringToPos(end + 1);\r\n}\r\n\r\nfunction readMultiplierRange(tokenizer) {\r\n    var min = null;\r\n    var max = null;\r\n\r\n    tokenizer.eat(LEFTCURLYBRACKET);\r\n\r\n    min = scanNumber(tokenizer);\r\n\r\n    if (tokenizer.charCode() === COMMA) {\r\n        tokenizer.pos++;\r\n        if (tokenizer.charCode() !== RIGHTCURLYBRACKET) {\r\n            max = scanNumber(tokenizer);\r\n        }\r\n    } else {\r\n        max = min;\r\n    }\r\n\r\n    tokenizer.eat(RIGHTCURLYBRACKET);\r\n\r\n    return {\r\n        min: Number(min),\r\n        max: max ? Number(max) : 0\r\n    };\r\n}\r\n\r\nfunction readMultiplier(tokenizer) {\r\n    var range = null;\r\n    var comma = false;\r\n\r\n    switch (tokenizer.charCode()) {\r\n        case ASTERISK:\r\n            tokenizer.pos++;\r\n\r\n            range = {\r\n                min: 0,\r\n                max: 0\r\n            };\r\n\r\n            break;\r\n\r\n        case PLUSSIGN:\r\n            tokenizer.pos++;\r\n\r\n            range = {\r\n                min: 1,\r\n                max: 0\r\n            };\r\n\r\n            break;\r\n\r\n        case QUESTIONMARK:\r\n            tokenizer.pos++;\r\n\r\n            range = {\r\n                min: 0,\r\n                max: 1\r\n            };\r\n\r\n            break;\r\n\r\n        case NUMBERSIGN:\r\n            tokenizer.pos++;\r\n\r\n            comma = true;\r\n\r\n            if (tokenizer.charCode() === LEFTCURLYBRACKET) {\r\n                range = readMultiplierRange(tokenizer);\r\n            } else {\r\n                range = {\r\n                    min: 1,\r\n                    max: 0\r\n                };\r\n            }\r\n\r\n            break;\r\n\r\n        case LEFTCURLYBRACKET:\r\n            range = readMultiplierRange(tokenizer);\r\n            break;\r\n\r\n        default:\r\n            return null;\r\n    }\r\n\r\n    return {\r\n        type: 'Multiplier',\r\n        comma: comma,\r\n        min: range.min,\r\n        max: range.max,\r\n        term: null\r\n    };\r\n}\r\n\r\nfunction maybeMultiplied(tokenizer, node) {\r\n    var multiplier = readMultiplier(tokenizer);\r\n\r\n    if (multiplier !== null) {\r\n        multiplier.term = node;\r\n        return multiplier;\r\n    }\r\n\r\n    return node;\r\n}\r\n\r\nfunction maybeToken(tokenizer) {\r\n    var ch = tokenizer.peek();\r\n\r\n    if (ch === '') {\r\n        return null;\r\n    }\r\n\r\n    return {\r\n        type: 'Token',\r\n        value: ch\r\n    };\r\n}\r\n\r\nfunction readProperty(tokenizer) {\r\n    var name;\r\n\r\n    tokenizer.eat(LESSTHANSIGN);\r\n    tokenizer.eat(APOSTROPHE);\r\n\r\n    name = scanWord(tokenizer);\r\n\r\n    tokenizer.eat(APOSTROPHE);\r\n    tokenizer.eat(GREATERTHANSIGN);\r\n\r\n    return maybeMultiplied(tokenizer, {\r\n        type: 'Property',\r\n        name: name\r\n    });\r\n}\r\n\r\n// https://drafts.csswg.org/css-values-3/#numeric-ranges\r\n// 4.1. Range Restrictions and Range Definition Notation\r\n//\r\n// Range restrictions can be annotated in the numeric type notation using CSS bracketed\r\n// range notation—[min,max]—within the angle brackets, after the identifying keyword,\r\n// indicating a closed range between (and including) min and max.\r\n// For example, <integer [0, 10]> indicates an integer between 0 and 10, inclusive.\r\nfunction readTypeRange(tokenizer) {\r\n    // use null for Infinity to make AST format JSON serializable/deserializable\r\n    var min = null; // -Infinity\r\n    var max = null; // Infinity\r\n    var sign = 1;\r\n\r\n    tokenizer.eat(LEFTSQUAREBRACKET);\r\n\r\n    if (tokenizer.charCode() === HYPERMINUS) {\r\n        tokenizer.peek();\r\n        sign = -1;\r\n    }\r\n\r\n    if (sign == -1 && tokenizer.charCode() === INFINITY) {\r\n        tokenizer.peek();\r\n    } else {\r\n        min = sign * Number(scanNumber(tokenizer));\r\n    }\r\n\r\n    scanSpaces(tokenizer);\r\n    tokenizer.eat(COMMA);\r\n    scanSpaces(tokenizer);\r\n\r\n    if (tokenizer.charCode() === INFINITY) {\r\n        tokenizer.peek();\r\n    } else {\r\n        sign = 1;\r\n\r\n        if (tokenizer.charCode() === HYPERMINUS) {\r\n            tokenizer.peek();\r\n            sign = -1;\r\n        }\r\n\r\n        max = sign * Number(scanNumber(tokenizer));\r\n    }\r\n\r\n    tokenizer.eat(RIGHTSQUAREBRACKET);\r\n\r\n    // If no range is indicated, either by using the bracketed range notation\r\n    // or in the property description, then [−∞,∞] is assumed.\r\n    if (min === null && max === null) {\r\n        return null;\r\n    }\r\n\r\n    return {\r\n        type: 'Range',\r\n        min: min,\r\n        max: max\r\n    };\r\n}\r\n\r\nfunction readType(tokenizer) {\r\n    var name;\r\n    var opts = null;\r\n\r\n    tokenizer.eat(LESSTHANSIGN);\r\n    name = scanWord(tokenizer);\r\n\r\n    if (tokenizer.charCode() === LEFTPARENTHESIS &&\r\n        tokenizer.nextCharCode() === RIGHTPARENTHESIS) {\r\n        tokenizer.pos += 2;\r\n        name += '()';\r\n    }\r\n\r\n    if (tokenizer.charCodeAt(tokenizer.findWsEnd(tokenizer.pos)) === LEFTSQUAREBRACKET) {\r\n        scanSpaces(tokenizer);\r\n        opts = readTypeRange(tokenizer);\r\n    }\r\n\r\n    tokenizer.eat(GREATERTHANSIGN);\r\n\r\n    return maybeMultiplied(tokenizer, {\r\n        type: 'Type',\r\n        name: name,\r\n        opts: opts\r\n    });\r\n}\r\n\r\nfunction readKeywordOrFunction(tokenizer) {\r\n    var name;\r\n\r\n    name = scanWord(tokenizer);\r\n\r\n    if (tokenizer.charCode() === LEFTPARENTHESIS) {\r\n        tokenizer.pos++;\r\n\r\n        return {\r\n            type: 'Function',\r\n            name: name\r\n        };\r\n    }\r\n\r\n    return maybeMultiplied(tokenizer, {\r\n        type: 'Keyword',\r\n        name: name\r\n    });\r\n}\r\n\r\nfunction regroupTerms(terms, combinators) {\r\n    function createGroup(terms, combinator) {\r\n        return {\r\n            type: 'Group',\r\n            terms: terms,\r\n            combinator: combinator,\r\n            disallowEmpty: false,\r\n            explicit: false\r\n        };\r\n    }\r\n\r\n    combinators = Object.keys(combinators).sort(function(a, b) {\r\n        return COMBINATOR_PRECEDENCE[a] - COMBINATOR_PRECEDENCE[b];\r\n    });\r\n\r\n    while (combinators.length > 0) {\r\n        var combinator = combinators.shift();\r\n        for (var i = 0, subgroupStart = 0; i < terms.length; i++) {\r\n            var term = terms[i];\r\n            if (term.type === 'Combinator') {\r\n                if (term.value === combinator) {\r\n                    if (subgroupStart === -1) {\r\n                        subgroupStart = i - 1;\r\n                    }\r\n                    terms.splice(i, 1);\r\n                    i--;\r\n                } else {\r\n                    if (subgroupStart !== -1 && i - subgroupStart > 1) {\r\n                        terms.splice(\r\n                            subgroupStart,\r\n                            i - subgroupStart,\r\n                            createGroup(terms.slice(subgroupStart, i), combinator)\r\n                        );\r\n                        i = subgroupStart + 1;\r\n                    }\r\n                    subgroupStart = -1;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (subgroupStart !== -1 && combinators.length) {\r\n            terms.splice(\r\n                subgroupStart,\r\n                i - subgroupStart,\r\n                createGroup(terms.slice(subgroupStart, i), combinator)\r\n            );\r\n        }\r\n    }\r\n\r\n    return combinator;\r\n}\r\n\r\nfunction readImplicitGroup(tokenizer) {\r\n    var terms = [];\r\n    var combinators = {};\r\n    var token;\r\n    var prevToken = null;\r\n    var prevTokenPos = tokenizer.pos;\r\n\r\n    while (token = peek(tokenizer)) {\r\n        if (token.type !== 'Spaces') {\r\n            if (token.type === 'Combinator') {\r\n                // check for combinator in group beginning and double combinator sequence\r\n                if (prevToken === null || prevToken.type === 'Combinator') {\r\n                    tokenizer.pos = prevTokenPos;\r\n                    tokenizer.error('Unexpected combinator');\r\n                }\r\n\r\n                combinators[token.value] = true;\r\n            } else if (prevToken !== null && prevToken.type !== 'Combinator') {\r\n                combinators[' '] = true;  // a b\r\n                terms.push({\r\n                    type: 'Combinator',\r\n                    value: ' '\r\n                });\r\n            }\r\n\r\n            terms.push(token);\r\n            prevToken = token;\r\n            prevTokenPos = tokenizer.pos;\r\n        }\r\n    }\r\n\r\n    // check for combinator in group ending\r\n    if (prevToken !== null && prevToken.type === 'Combinator') {\r\n        tokenizer.pos -= prevTokenPos;\r\n        tokenizer.error('Unexpected combinator');\r\n    }\r\n\r\n    return {\r\n        type: 'Group',\r\n        terms: terms,\r\n        combinator: regroupTerms(terms, combinators) || ' ',\r\n        disallowEmpty: false,\r\n        explicit: false\r\n    };\r\n}\r\n\r\nfunction readGroup(tokenizer) {\r\n    var result;\r\n\r\n    tokenizer.eat(LEFTSQUAREBRACKET);\r\n    result = readImplicitGroup(tokenizer);\r\n    tokenizer.eat(RIGHTSQUAREBRACKET);\r\n\r\n    result.explicit = true;\r\n\r\n    if (tokenizer.charCode() === EXCLAMATIONMARK) {\r\n        tokenizer.pos++;\r\n        result.disallowEmpty = true;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction peek(tokenizer) {\r\n    var code = tokenizer.charCode();\r\n\r\n    if (code < 128 && NAME_CHAR[code] === 1) {\r\n        return readKeywordOrFunction(tokenizer);\r\n    }\r\n\r\n    switch (code) {\r\n        case RIGHTSQUAREBRACKET:\r\n            // don't eat, stop scan a group\r\n            break;\r\n\r\n        case LEFTSQUAREBRACKET:\r\n            return maybeMultiplied(tokenizer, readGroup(tokenizer));\r\n\r\n        case LESSTHANSIGN:\r\n            return tokenizer.nextCharCode() === APOSTROPHE\r\n                ? readProperty(tokenizer)\r\n                : readType(tokenizer);\r\n\r\n        case VERTICALLINE:\r\n            return {\r\n                type: 'Combinator',\r\n                value: tokenizer.substringToPos(\r\n                    tokenizer.nextCharCode() === VERTICALLINE\r\n                        ? tokenizer.pos + 2\r\n                        : tokenizer.pos + 1\r\n                )\r\n            };\r\n\r\n        case AMPERSAND:\r\n            tokenizer.pos++;\r\n            tokenizer.eat(AMPERSAND);\r\n\r\n            return {\r\n                type: 'Combinator',\r\n                value: '&&'\r\n            };\r\n\r\n        case COMMA:\r\n            tokenizer.pos++;\r\n            return {\r\n                type: 'Comma'\r\n            };\r\n\r\n        case APOSTROPHE:\r\n            return maybeMultiplied(tokenizer, {\r\n                type: 'String',\r\n                value: scanString(tokenizer)\r\n            });\r\n\r\n        case SPACE:\r\n        case TAB:\r\n        case N:\r\n        case R:\r\n        case F:\r\n            return {\r\n                type: 'Spaces',\r\n                value: scanSpaces(tokenizer)\r\n            };\r\n\r\n        case COMMERCIALAT:\r\n            code = tokenizer.nextCharCode();\r\n\r\n            if (code < 128 && NAME_CHAR[code] === 1) {\r\n                tokenizer.pos++;\r\n                return {\r\n                    type: 'AtKeyword',\r\n                    name: scanWord(tokenizer)\r\n                };\r\n            }\r\n\r\n            return maybeToken(tokenizer);\r\n\r\n        case ASTERISK:\r\n        case PLUSSIGN:\r\n        case QUESTIONMARK:\r\n        case NUMBERSIGN:\r\n        case EXCLAMATIONMARK:\r\n            // prohibited tokens (used as a multiplier start)\r\n            break;\r\n\r\n        case LEFTCURLYBRACKET:\r\n            // LEFTCURLYBRACKET is allowed since mdn/data uses it w/o quoting\r\n            // check next char isn't a number, because it's likely a disjoined multiplier\r\n            code = tokenizer.nextCharCode();\r\n\r\n            if (code < 48 || code > 57) {\r\n                return maybeToken(tokenizer);\r\n            }\r\n\r\n            break;\r\n\r\n        default:\r\n            return maybeToken(tokenizer);\r\n    }\r\n}\r\n\r\nfunction parse(source) {\r\n    var tokenizer = new Tokenizer(source);\r\n    var result = readImplicitGroup(tokenizer);\r\n\r\n    if (tokenizer.pos !== source.length) {\r\n        tokenizer.error('Unexpected input');\r\n    }\r\n\r\n    // reduce redundant groups with single group term\r\n    if (result.terms.length === 1 && result.terms[0].type === 'Group') {\r\n        result = result.terms[0];\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n// warm up parse to elimitate code branches that never execute\r\n// fix soft deoptimizations (insufficient type feedback)\r\nparse('[a&&<b>#|<\\'c\\'>*||e() f{2} /,(% g#{1,2} h{2,})]!');\r\n\r\nmodule.exports = parse;\r\n","var noop = function() {};\r\n\r\nfunction ensureFunction(value) {\r\n    return typeof value === 'function' ? value : noop;\r\n}\r\n\r\nmodule.exports = function(node, options, context) {\r\n    function walk(node) {\r\n        enter.call(context, node);\r\n\r\n        switch (node.type) {\r\n            case 'Group':\r\n                node.terms.forEach(walk);\r\n                break;\r\n\r\n            case 'Multiplier':\r\n                walk(node.term);\r\n                break;\r\n\r\n            case 'Type':\r\n            case 'Property':\r\n            case 'Keyword':\r\n            case 'AtKeyword':\r\n            case 'Function':\r\n            case 'String':\r\n            case 'Token':\r\n            case 'Comma':\r\n                break;\r\n\r\n            default:\r\n                throw new Error('Unknown type: ' + node.type);\r\n        }\r\n\r\n        leave.call(context, node);\r\n    }\r\n\r\n    var enter = noop;\r\n    var leave = noop;\r\n\r\n    if (typeof options === 'function') {\r\n        enter = options;\r\n    } else if (options) {\r\n        enter = ensureFunction(options.enter);\r\n        leave = ensureFunction(options.leave);\r\n    }\r\n\r\n    if (enter === noop && leave === noop) {\r\n        throw new Error('Neither `enter` nor `leave` walker handler is set or both aren\\'t a function');\r\n    }\r\n\r\n    walk(node, context);\r\n};\r\n","var tokenize = require('../tokenizer');\r\nvar TokenStream = require('../common/TokenStream');\r\nvar tokenStream = new TokenStream();\r\nvar astToTokens = {\r\n    decorator: function(handlers) {\r\n        var curNode = null;\r\n        var prev = { len: 0, node: null };\r\n        var nodes = [prev];\r\n        var buffer = '';\r\n\r\n        return {\r\n            children: handlers.children,\r\n            node: function(node) {\r\n                var tmp = curNode;\r\n                curNode = node;\r\n                handlers.node.call(this, node);\r\n                curNode = tmp;\r\n            },\r\n            chunk: function(chunk) {\r\n                buffer += chunk;\r\n                if (prev.node !== curNode) {\r\n                    nodes.push({\r\n                        len: chunk.length,\r\n                        node: curNode\r\n                    });\r\n                } else {\r\n                    prev.len += chunk.length;\r\n                }\r\n            },\r\n            result: function() {\r\n                return prepareTokens(buffer, nodes);\r\n            }\r\n        };\r\n    }\r\n};\r\n\r\nfunction prepareTokens(str, nodes) {\r\n    var tokens = [];\r\n    var nodesOffset = 0;\r\n    var nodesIndex = 0;\r\n    var currentNode = nodes ? nodes[nodesIndex].node : null;\r\n\r\n    tokenize(str, tokenStream);\r\n\r\n    while (!tokenStream.eof) {\r\n        if (nodes) {\r\n            while (nodesIndex < nodes.length && nodesOffset + nodes[nodesIndex].len <= tokenStream.tokenStart) {\r\n                nodesOffset += nodes[nodesIndex++].len;\r\n                currentNode = nodes[nodesIndex].node;\r\n            }\r\n        }\r\n\r\n        tokens.push({\r\n            type: tokenStream.tokenType,\r\n            value: tokenStream.getTokenValue(),\r\n            index: tokenStream.tokenIndex, // TODO: remove it, temporary solution\r\n            balance: tokenStream.balance[tokenStream.tokenIndex], // TODO: remove it, temporary solution\r\n            node: currentNode\r\n        });\r\n        tokenStream.next();\r\n        // console.log({ ...tokens[tokens.length - 1], node: undefined });\r\n    }\r\n\r\n    return tokens;\r\n}\r\n\r\nmodule.exports = function(value, syntax) {\r\n    if (typeof value === 'string') {\r\n        return prepareTokens(value, null);\r\n    }\r\n\r\n    return syntax.generate(value, astToTokens);\r\n};\r\n","var parse = require('../definition-syntax/parse');\r\n\r\nvar MATCH = { type: 'Match' };\r\nvar MISMATCH = { type: 'Mismatch' };\r\nvar DISALLOW_EMPTY = { type: 'DisallowEmpty' };\r\nvar LEFTPARENTHESIS = 40;  // (\r\nvar RIGHTPARENTHESIS = 41; // )\r\n\r\nfunction createCondition(match, thenBranch, elseBranch) {\r\n    // reduce node count\r\n    if (thenBranch === MATCH && elseBranch === MISMATCH) {\r\n        return match;\r\n    }\r\n\r\n    if (match === MATCH && thenBranch === MATCH && elseBranch === MATCH) {\r\n        return match;\r\n    }\r\n\r\n    if (match.type === 'If' && match.else === MISMATCH && thenBranch === MATCH) {\r\n        thenBranch = match.then;\r\n        match = match.match;\r\n    }\r\n\r\n    return {\r\n        type: 'If',\r\n        match: match,\r\n        then: thenBranch,\r\n        else: elseBranch\r\n    };\r\n}\r\n\r\nfunction isFunctionType(name) {\r\n    return (\r\n        name.length > 2 &&\r\n        name.charCodeAt(name.length - 2) === LEFTPARENTHESIS &&\r\n        name.charCodeAt(name.length - 1) === RIGHTPARENTHESIS\r\n    );\r\n}\r\n\r\nfunction isEnumCapatible(term) {\r\n    return (\r\n        term.type === 'Keyword' ||\r\n        term.type === 'AtKeyword' ||\r\n        term.type === 'Function' ||\r\n        term.type === 'Type' && isFunctionType(term.name)\r\n    );\r\n}\r\n\r\nfunction buildGroupMatchGraph(combinator, terms, atLeastOneTermMatched) {\r\n    switch (combinator) {\r\n        case ' ':\r\n            // Juxtaposing components means that all of them must occur, in the given order.\r\n            //\r\n            // a b c\r\n            // =\r\n            // match a\r\n            //   then match b\r\n            //     then match c\r\n            //       then MATCH\r\n            //       else MISMATCH\r\n            //     else MISMATCH\r\n            //   else MISMATCH\r\n            var result = MATCH;\r\n\r\n            for (var i = terms.length - 1; i >= 0; i--) {\r\n                var term = terms[i];\r\n\r\n                result = createCondition(\r\n                    term,\r\n                    result,\r\n                    MISMATCH\r\n                );\r\n            };\r\n\r\n            return result;\r\n\r\n        case '|':\r\n            // A bar (|) separates two or more alternatives: exactly one of them must occur.\r\n            //\r\n            // a | b | c\r\n            // =\r\n            // match a\r\n            //   then MATCH\r\n            //   else match b\r\n            //     then MATCH\r\n            //     else match c\r\n            //       then MATCH\r\n            //       else MISMATCH\r\n\r\n            var result = MISMATCH;\r\n            var map = null;\r\n\r\n            for (var i = terms.length - 1; i >= 0; i--) {\r\n                var term = terms[i];\r\n\r\n                // reduce sequence of keywords into a Enum\r\n                if (isEnumCapatible(term)) {\r\n                    if (map === null && i > 0 && isEnumCapatible(terms[i - 1])) {\r\n                        map = Object.create(null);\r\n                        result = createCondition(\r\n                            {\r\n                                type: 'Enum',\r\n                                map: map\r\n                            },\r\n                            MATCH,\r\n                            result\r\n                        );\r\n                    }\r\n\r\n                    if (map !== null) {\r\n                        var key = (isFunctionType(term.name) ? term.name.slice(0, -1) : term.name).toLowerCase();\r\n                        if (key in map === false) {\r\n                            map[key] = term;\r\n                            continue;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                map = null;\r\n\r\n                // create a new conditonal node\r\n                result = createCondition(\r\n                    term,\r\n                    MATCH,\r\n                    result\r\n                );\r\n            };\r\n\r\n            return result;\r\n\r\n        case '&&':\r\n            // A double ampersand (&&) separates two or more components,\r\n            // all of which must occur, in any order.\r\n\r\n            // Use MatchOnce for groups with a large number of terms,\r\n            // since &&-groups produces at least N!-node trees\r\n            if (terms.length > 5) {\r\n                return {\r\n                    type: 'MatchOnce',\r\n                    terms: terms,\r\n                    all: true\r\n                };\r\n            }\r\n\r\n            // Use a combination tree for groups with small number of terms\r\n            //\r\n            // a && b && c\r\n            // =\r\n            // match a\r\n            //   then [b && c]\r\n            //   else match b\r\n            //     then [a && c]\r\n            //     else match c\r\n            //       then [a && b]\r\n            //       else MISMATCH\r\n            //\r\n            // a && b\r\n            // =\r\n            // match a\r\n            //   then match b\r\n            //     then MATCH\r\n            //     else MISMATCH\r\n            //   else match b\r\n            //     then match a\r\n            //       then MATCH\r\n            //       else MISMATCH\r\n            //     else MISMATCH\r\n            var result = MISMATCH;\r\n\r\n            for (var i = terms.length - 1; i >= 0; i--) {\r\n                var term = terms[i];\r\n                var thenClause;\r\n\r\n                if (terms.length > 1) {\r\n                    thenClause = buildGroupMatchGraph(\r\n                        combinator,\r\n                        terms.filter(function(newGroupTerm) {\r\n                            return newGroupTerm !== term;\r\n                        }),\r\n                        false\r\n                    );\r\n                } else {\r\n                    thenClause = MATCH;\r\n                }\r\n\r\n                result = createCondition(\r\n                    term,\r\n                    thenClause,\r\n                    result\r\n                );\r\n            };\r\n\r\n            return result;\r\n\r\n        case '||':\r\n            // A double bar (||) separates two or more options:\r\n            // one or more of them must occur, in any order.\r\n\r\n            // Use MatchOnce for groups with a large number of terms,\r\n            // since ||-groups produces at least N!-node trees\r\n            if (terms.length > 5) {\r\n                return {\r\n                    type: 'MatchOnce',\r\n                    terms: terms,\r\n                    all: false\r\n                };\r\n            }\r\n\r\n            // Use a combination tree for groups with small number of terms\r\n            //\r\n            // a || b || c\r\n            // =\r\n            // match a\r\n            //   then [b || c]\r\n            //   else match b\r\n            //     then [a || c]\r\n            //     else match c\r\n            //       then [a || b]\r\n            //       else MISMATCH\r\n            //\r\n            // a || b\r\n            // =\r\n            // match a\r\n            //   then match b\r\n            //     then MATCH\r\n            //     else MATCH\r\n            //   else match b\r\n            //     then match a\r\n            //       then MATCH\r\n            //       else MATCH\r\n            //     else MISMATCH\r\n            var result = atLeastOneTermMatched ? MATCH : MISMATCH;\r\n\r\n            for (var i = terms.length - 1; i >= 0; i--) {\r\n                var term = terms[i];\r\n                var thenClause;\r\n\r\n                if (terms.length > 1) {\r\n                    thenClause = buildGroupMatchGraph(\r\n                        combinator,\r\n                        terms.filter(function(newGroupTerm) {\r\n                            return newGroupTerm !== term;\r\n                        }),\r\n                        true\r\n                    );\r\n                } else {\r\n                    thenClause = MATCH;\r\n                }\r\n\r\n                result = createCondition(\r\n                    term,\r\n                    thenClause,\r\n                    result\r\n                );\r\n            };\r\n\r\n            return result;\r\n    }\r\n}\r\n\r\nfunction buildMultiplierMatchGraph(node) {\r\n    var result = MATCH;\r\n    var matchTerm = buildMatchGraph(node.term);\r\n\r\n    if (node.max === 0) {\r\n        // disable repeating of empty match to prevent infinite loop\r\n        matchTerm = createCondition(\r\n            matchTerm,\r\n            DISALLOW_EMPTY,\r\n            MISMATCH\r\n        );\r\n\r\n        // an occurrence count is not limited, make a cycle;\r\n        // to collect more terms on each following matching mismatch\r\n        result = createCondition(\r\n            matchTerm,\r\n            null, // will be a loop\r\n            MISMATCH\r\n        );\r\n\r\n        result.then = createCondition(\r\n            MATCH,\r\n            MATCH,\r\n            result // make a loop\r\n        );\r\n\r\n        if (node.comma) {\r\n            result.then.else = createCondition(\r\n                { type: 'Comma', syntax: node },\r\n                result,\r\n                MISMATCH\r\n            );\r\n        }\r\n    } else {\r\n        // create a match node chain for [min .. max] interval with optional matches\r\n        for (var i = node.min || 1; i <= node.max; i++) {\r\n            if (node.comma && result !== MATCH) {\r\n                result = createCondition(\r\n                    { type: 'Comma', syntax: node },\r\n                    result,\r\n                    MISMATCH\r\n                );\r\n            }\r\n\r\n            result = createCondition(\r\n                matchTerm,\r\n                createCondition(\r\n                    MATCH,\r\n                    MATCH,\r\n                    result\r\n                ),\r\n                MISMATCH\r\n            );\r\n        }\r\n    }\r\n\r\n    if (node.min === 0) {\r\n        // allow zero match\r\n        result = createCondition(\r\n            MATCH,\r\n            MATCH,\r\n            result\r\n        );\r\n    } else {\r\n        // create a match node chain to collect [0 ... min - 1] required matches\r\n        for (var i = 0; i < node.min - 1; i++) {\r\n            if (node.comma && result !== MATCH) {\r\n                result = createCondition(\r\n                    { type: 'Comma', syntax: node },\r\n                    result,\r\n                    MISMATCH\r\n                );\r\n            }\r\n\r\n            result = createCondition(\r\n                matchTerm,\r\n                result,\r\n                MISMATCH\r\n            );\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction buildMatchGraph(node) {\r\n    if (typeof node === 'function') {\r\n        return {\r\n            type: 'Generic',\r\n            fn: node\r\n        };\r\n    }\r\n\r\n    switch (node.type) {\r\n        case 'Group':\r\n            var result = buildGroupMatchGraph(\r\n                node.combinator,\r\n                node.terms.map(buildMatchGraph),\r\n                false\r\n            );\r\n\r\n            if (node.disallowEmpty) {\r\n                result = createCondition(\r\n                    result,\r\n                    DISALLOW_EMPTY,\r\n                    MISMATCH\r\n                );\r\n            }\r\n\r\n            return result;\r\n\r\n        case 'Multiplier':\r\n            return buildMultiplierMatchGraph(node);\r\n\r\n        case 'Type':\r\n        case 'Property':\r\n            return {\r\n                type: node.type,\r\n                name: node.name,\r\n                syntax: node\r\n            };\r\n\r\n        case 'Keyword':\r\n            return {\r\n                type: node.type,\r\n                name: node.name.toLowerCase(),\r\n                syntax: node\r\n            };\r\n\r\n        case 'AtKeyword':\r\n            return {\r\n                type: node.type,\r\n                name: '@' + node.name.toLowerCase(),\r\n                syntax: node\r\n            };\r\n\r\n        case 'Function':\r\n            return {\r\n                type: node.type,\r\n                name: node.name.toLowerCase() + '(',\r\n                syntax: node\r\n            };\r\n\r\n        case 'String':\r\n            // convert a one char length String to a Token\r\n            if (node.value.length === 3) {\r\n                return {\r\n                    type: 'Token',\r\n                    value: node.value.charAt(1),\r\n                    syntax: node\r\n                };\r\n            }\r\n\r\n            // otherwise use it as is\r\n            return {\r\n                type: node.type,\r\n                value: node.value.substr(1, node.value.length - 2).replace(/\\\\'/g, '\\''),\r\n                syntax: node\r\n            };\r\n\r\n        case 'Token':\r\n            return {\r\n                type: node.type,\r\n                value: node.value,\r\n                syntax: node\r\n            };\r\n\r\n        case 'Comma':\r\n            return {\r\n                type: node.type,\r\n                syntax: node\r\n            };\r\n\r\n        default:\r\n            throw new Error('Unknown node type:', node.type);\r\n    }\r\n}\r\n\r\nmodule.exports = {\r\n    MATCH: MATCH,\r\n    MISMATCH: MISMATCH,\r\n    DISALLOW_EMPTY: DISALLOW_EMPTY,\r\n    buildMatchGraph: function(syntaxTree, ref) {\r\n        if (typeof syntaxTree === 'string') {\r\n            syntaxTree = parse(syntaxTree);\r\n        }\r\n\r\n        return {\r\n            type: 'MatchGraph',\r\n            match: buildMatchGraph(syntaxTree),\r\n            syntax: ref || null,\r\n            source: syntaxTree\r\n        };\r\n    }\r\n};\r\n","var hasOwnProperty = Object.prototype.hasOwnProperty;\r\nvar matchGraph = require('./match-graph');\r\nvar MATCH = matchGraph.MATCH;\r\nvar MISMATCH = matchGraph.MISMATCH;\r\nvar DISALLOW_EMPTY = matchGraph.DISALLOW_EMPTY;\r\nvar TYPE = require('../tokenizer/const').TYPE;\r\n\r\nvar STUB = 0;\r\nvar TOKEN = 1;\r\nvar OPEN_SYNTAX = 2;\r\nvar CLOSE_SYNTAX = 3;\r\n\r\nvar EXIT_REASON_MATCH = 'Match';\r\nvar EXIT_REASON_MISMATCH = 'Mismatch';\r\nvar EXIT_REASON_ITERATION_LIMIT = 'Maximum iteration number exceeded (please fill an issue on https://github.com/csstree/csstree/issues)';\r\n\r\nvar ITERATION_LIMIT = 15000;\r\nvar totalIterationCount = 0;\r\n\r\nfunction reverseList(list) {\r\n    var prev = null;\r\n    var next = null;\r\n    var item = list;\r\n\r\n    while (item !== null) {\r\n        next = item.prev;\r\n        item.prev = prev;\r\n        prev = item;\r\n        item = next;\r\n    }\r\n\r\n    return prev;\r\n}\r\n\r\nfunction areStringsEqualCaseInsensitive(testStr, referenceStr) {\r\n    if (testStr.length !== referenceStr.length) {\r\n        return false;\r\n    }\r\n\r\n    for (var i = 0; i < testStr.length; i++) {\r\n        var testCode = testStr.charCodeAt(i);\r\n        var referenceCode = referenceStr.charCodeAt(i);\r\n\r\n        // testCode.toLowerCase() for U+0041 LATIN CAPITAL LETTER A (A) .. U+005A LATIN CAPITAL LETTER Z (Z).\r\n        if (testCode >= 0x0041 && testCode <= 0x005A) {\r\n            testCode = testCode | 32;\r\n        }\r\n\r\n        if (testCode !== referenceCode) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nfunction isCommaContextStart(token) {\r\n    if (token === null) {\r\n        return true;\r\n    }\r\n\r\n    return (\r\n        token.type === TYPE.Comma ||\r\n        token.type === TYPE.Function ||\r\n        token.type === TYPE.LeftParenthesis ||\r\n        token.type === TYPE.LeftSquareBracket ||\r\n        token.type === TYPE.LeftCurlyBracket ||\r\n        token.type === TYPE.Delim\r\n    );\r\n}\r\n\r\nfunction isCommaContextEnd(token) {\r\n    if (token === null) {\r\n        return true;\r\n    }\r\n\r\n    return (\r\n        token.type === TYPE.RightParenthesis ||\r\n        token.type === TYPE.RightSquareBracket ||\r\n        token.type === TYPE.RightCurlyBracket ||\r\n        token.type === TYPE.Delim\r\n    );\r\n}\r\n\r\nfunction internalMatch(tokens, state, syntaxes) {\r\n    function moveToNextToken() {\r\n        do {\r\n            tokenIndex++;\r\n            token = tokenIndex < tokens.length ? tokens[tokenIndex] : null;\r\n        } while (token !== null && (token.type === TYPE.WhiteSpace || token.type === TYPE.Comment));\r\n    }\r\n\r\n    function getNextToken(offset) {\r\n        var nextIndex = tokenIndex + offset;\r\n\r\n        return nextIndex < tokens.length ? tokens[nextIndex] : null;\r\n    }\r\n\r\n    function stateSnapshotFromSyntax(nextState, prev) {\r\n        return {\r\n            nextState: nextState,\r\n            matchStack: matchStack,\r\n            syntaxStack: syntaxStack,\r\n            thenStack: thenStack,\r\n            tokenIndex: tokenIndex,\r\n            prev: prev\r\n        };\r\n    }\r\n\r\n    function pushThenStack(nextState) {\r\n        thenStack = {\r\n            nextState: nextState,\r\n            matchStack: matchStack,\r\n            syntaxStack: syntaxStack,\r\n            prev: thenStack\r\n        };\r\n    }\r\n\r\n    function pushElseStack(nextState) {\r\n        elseStack = stateSnapshotFromSyntax(nextState, elseStack);\r\n    }\r\n\r\n    function addTokenToMatch() {\r\n        matchStack = {\r\n            type: TOKEN,\r\n            syntax: state.syntax,\r\n            token: token,\r\n            prev: matchStack\r\n        };\r\n\r\n        moveToNextToken();\r\n        syntaxStash = null;\r\n\r\n        if (tokenIndex > longestMatch) {\r\n            longestMatch = tokenIndex;\r\n        }\r\n    }\r\n\r\n    function openSyntax() {\r\n        syntaxStack = {\r\n            syntax: state.syntax,\r\n            opts: state.syntax.opts || (syntaxStack !== null && syntaxStack.opts) || null,\r\n            prev: syntaxStack\r\n        };\r\n\r\n        matchStack = {\r\n            type: OPEN_SYNTAX,\r\n            syntax: state.syntax,\r\n            token: matchStack.token,\r\n            prev: matchStack\r\n        };\r\n    }\r\n\r\n    function closeSyntax() {\r\n        if (matchStack.type === OPEN_SYNTAX) {\r\n            matchStack = matchStack.prev;\r\n        } else {\r\n            matchStack = {\r\n                type: CLOSE_SYNTAX,\r\n                syntax: syntaxStack.syntax,\r\n                token: matchStack.token,\r\n                prev: matchStack\r\n            };\r\n        }\r\n\r\n        syntaxStack = syntaxStack.prev;\r\n    }\r\n\r\n    var syntaxStack = null;\r\n    var thenStack = null;\r\n    var elseStack = null;\r\n\r\n    // null – stashing allowed, nothing stashed\r\n    // false – stashing disabled, nothing stashed\r\n    // anithing else – fail stashable syntaxes, some syntax stashed\r\n    var syntaxStash = null;\r\n\r\n    var iterationCount = 0; // count iterations and prevent infinite loop\r\n    var exitReason = null;\r\n\r\n    var token = null;\r\n    var tokenIndex = -1;\r\n    var longestMatch = 0;\r\n    var matchStack = {\r\n        type: STUB,\r\n        syntax: null,\r\n        token: null,\r\n        prev: null\r\n    };\r\n\r\n    moveToNextToken();\r\n\r\n    while (exitReason === null && ++iterationCount < ITERATION_LIMIT) {\r\n        // function mapList(list, fn) {\r\n        //     var result = [];\r\n        //     while (list) {\r\n        //         result.unshift(fn(list));\r\n        //         list = list.prev;\r\n        //     }\r\n        //     return result;\r\n        // }\r\n        // console.log('--\\n',\r\n        //     '#' + iterationCount,\r\n        //     require('util').inspect({\r\n        //         match: mapList(matchStack, x => x.type === TOKEN ? x.token && x.token.value : x.syntax ? ({ [OPEN_SYNTAX]: '<', [CLOSE_SYNTAX]: '</' }[x.type] || x.type) + '!' + x.syntax.name : null),\r\n        //         token: token && token.value,\r\n        //         tokenIndex,\r\n        //         syntax: syntax.type + (syntax.id ? ' #' + syntax.id : '')\r\n        //     }, { depth: null })\r\n        // );\r\n        switch (state.type) {\r\n            case 'Match':\r\n                if (thenStack === null) {\r\n                    // turn to MISMATCH when some tokens left unmatched\r\n                    if (token !== null) {\r\n                        // doesn't mismatch if just one token left and it's an IE hack\r\n                        if (tokenIndex !== tokens.length - 1 || (token.value !== '\\\\0' && token.value !== '\\\\9')) {\r\n                            state = MISMATCH;\r\n                            break;\r\n                        }\r\n                    }\r\n\r\n                    // break the main loop, return a result - MATCH\r\n                    exitReason = EXIT_REASON_MATCH;\r\n                    break;\r\n                }\r\n\r\n                // go to next syntax (`then` branch)\r\n                state = thenStack.nextState;\r\n\r\n                // check match is not empty\r\n                if (state === DISALLOW_EMPTY) {\r\n                    if (thenStack.matchStack === matchStack) {\r\n                        state = MISMATCH;\r\n                        break;\r\n                    } else {\r\n                        state = MATCH;\r\n                    }\r\n                }\r\n\r\n                // close syntax if needed\r\n                while (thenStack.syntaxStack !== syntaxStack) {\r\n                    closeSyntax();\r\n                }\r\n\r\n                // pop stack\r\n                thenStack = thenStack.prev;\r\n                break;\r\n\r\n            case 'Mismatch':\r\n                // when some syntax is stashed\r\n                if (syntaxStash !== null && syntaxStash !== false) {\r\n                    // there is no else branches or a branch reduce match stack\r\n                    if (elseStack === null || tokenIndex > elseStack.tokenIndex) {\r\n                        // restore state from the stash\r\n                        elseStack = syntaxStash;\r\n                        syntaxStash = false; // disable stashing\r\n                    }\r\n                } else if (elseStack === null) {\r\n                    // no else branches -> break the main loop\r\n                    // return a result - MISMATCH\r\n                    exitReason = EXIT_REASON_MISMATCH;\r\n                    break;\r\n                }\r\n\r\n                // go to next syntax (`else` branch)\r\n                state = elseStack.nextState;\r\n\r\n                // restore all the rest stack states\r\n                thenStack = elseStack.thenStack;\r\n                syntaxStack = elseStack.syntaxStack;\r\n                matchStack = elseStack.matchStack;\r\n                tokenIndex = elseStack.tokenIndex;\r\n                token = tokenIndex < tokens.length ? tokens[tokenIndex] : null;\r\n\r\n                // pop stack\r\n                elseStack = elseStack.prev;\r\n                break;\r\n\r\n            case 'MatchGraph':\r\n                state = state.match;\r\n                break;\r\n\r\n            case 'If':\r\n                // IMPORTANT: else stack push must go first,\r\n                // since it stores the state of thenStack before changes\r\n                if (state.else !== MISMATCH) {\r\n                    pushElseStack(state.else);\r\n                }\r\n\r\n                if (state.then !== MATCH) {\r\n                    pushThenStack(state.then);\r\n                }\r\n\r\n                state = state.match;\r\n                break;\r\n\r\n            case 'MatchOnce':\r\n                state = {\r\n                    type: 'MatchOnceBuffer',\r\n                    syntax: state,\r\n                    index: 0,\r\n                    mask: 0\r\n                };\r\n                break;\r\n\r\n            case 'MatchOnceBuffer':\r\n                var terms = state.syntax.terms;\r\n\r\n                if (state.index === terms.length) {\r\n                    // no matches at all or it's required all terms to be matched\r\n                    if (state.mask === 0 || state.syntax.all) {\r\n                        state = MISMATCH;\r\n                        break;\r\n                    }\r\n\r\n                    // a partial match is ok\r\n                    state = MATCH;\r\n                    break;\r\n                }\r\n\r\n                // all terms are matched\r\n                if (state.mask === (1 << terms.length) - 1) {\r\n                    state = MATCH;\r\n                    break;\r\n                }\r\n\r\n                for (; state.index < terms.length; state.index++) {\r\n                    var matchFlag = 1 << state.index;\r\n\r\n                    if ((state.mask & matchFlag) === 0) {\r\n                        // IMPORTANT: else stack push must go first,\r\n                        // since it stores the state of thenStack before changes\r\n                        pushElseStack(state);\r\n                        pushThenStack({\r\n                            type: 'AddMatchOnce',\r\n                            syntax: state.syntax,\r\n                            mask: state.mask | matchFlag\r\n                        });\r\n\r\n                        // match\r\n                        state = terms[state.index++];\r\n                        break;\r\n                    }\r\n                }\r\n                break;\r\n\r\n            case 'AddMatchOnce':\r\n                state = {\r\n                    type: 'MatchOnceBuffer',\r\n                    syntax: state.syntax,\r\n                    index: 0,\r\n                    mask: state.mask\r\n                };\r\n                break;\r\n\r\n            case 'Enum':\r\n                if (token !== null) {\r\n                    var name = token.value.toLowerCase();\r\n\r\n                    // drop \\0 and \\9 hack from keyword name\r\n                    if (name.indexOf('\\\\') !== -1) {\r\n                        name = name.replace(/\\\\[09].*$/, '');\r\n                    }\r\n\r\n                    if (hasOwnProperty.call(state.map, name)) {\r\n                        state = state.map[name];\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                state = MISMATCH;\r\n                break;\r\n\r\n            case 'Generic':\r\n                var opts = syntaxStack !== null ? syntaxStack.opts : null;\r\n                var lastTokenIndex = tokenIndex + Math.floor(state.fn(token, getNextToken, opts));\r\n\r\n                if (!isNaN(lastTokenIndex) && lastTokenIndex > tokenIndex) {\r\n                    while (tokenIndex < lastTokenIndex) {\r\n                        addTokenToMatch();\r\n                    }\r\n\r\n                    state = MATCH;\r\n                } else {\r\n                    state = MISMATCH;\r\n                }\r\n\r\n                break;\r\n\r\n            case 'Type':\r\n            case 'Property':\r\n                var syntaxDict = state.type === 'Type' ? 'types' : 'properties';\r\n                var dictSyntax = hasOwnProperty.call(syntaxes, syntaxDict) ? syntaxes[syntaxDict][state.name] : null;\r\n\r\n                if (!dictSyntax || !dictSyntax.match) {\r\n                    throw new Error(\r\n                        'Bad syntax reference: ' +\r\n                        (state.type === 'Type'\r\n                            ? '<' + state.name + '>'\r\n                            : '<\\'' + state.name + '\\'>')\r\n                    );\r\n                }\r\n\r\n                // stash a syntax for types with low priority\r\n                if (syntaxStash !== false && token !== null && state.type === 'Type') {\r\n                    var lowPriorityMatching =\r\n                        // https://drafts.csswg.org/css-values-4/#custom-idents\r\n                        // When parsing positionally-ambiguous keywords in a property value, a <custom-ident> production\r\n                        // can only claim the keyword if no other unfulfilled production can claim it.\r\n                        (state.name === 'custom-ident' && token.type === TYPE.Ident) ||\r\n\r\n                        // https://drafts.csswg.org/css-values-4/#lengths\r\n                        // ... if a `0` could be parsed as either a <number> or a <length> in a property (such as line-height),\r\n                        // it must parse as a <number>\r\n                        (state.name === 'length' && token.value === '0');\r\n\r\n                    if (lowPriorityMatching) {\r\n                        if (syntaxStash === null) {\r\n                            syntaxStash = stateSnapshotFromSyntax(state, elseStack);\r\n                        }\r\n\r\n                        state = MISMATCH;\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                openSyntax();\r\n                state = dictSyntax.match;\r\n                break;\r\n\r\n            case 'Keyword':\r\n                var name = state.name;\r\n\r\n                if (token !== null) {\r\n                    var keywordName = token.value;\r\n\r\n                    // drop \\0 and \\9 hack from keyword name\r\n                    if (keywordName.indexOf('\\\\') !== -1) {\r\n                        keywordName = keywordName.replace(/\\\\[09].*$/, '');\r\n                    }\r\n\r\n                    if (areStringsEqualCaseInsensitive(keywordName, name)) {\r\n                        addTokenToMatch();\r\n                        state = MATCH;\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                state = MISMATCH;\r\n                break;\r\n\r\n            case 'AtKeyword':\r\n            case 'Function':\r\n                if (token !== null && areStringsEqualCaseInsensitive(token.value, state.name)) {\r\n                    addTokenToMatch();\r\n                    state = MATCH;\r\n                    break;\r\n                }\r\n\r\n                state = MISMATCH;\r\n                break;\r\n\r\n            case 'Token':\r\n                if (token !== null && token.value === state.value) {\r\n                    addTokenToMatch();\r\n                    state = MATCH;\r\n                    break;\r\n                }\r\n\r\n                state = MISMATCH;\r\n                break;\r\n\r\n            case 'Comma':\r\n                if (token !== null && token.type === TYPE.Comma) {\r\n                    if (isCommaContextStart(matchStack.token)) {\r\n                        state = MISMATCH;\r\n                    } else {\r\n                        addTokenToMatch();\r\n                        state = isCommaContextEnd(token) ? MISMATCH : MATCH;\r\n                    }\r\n                } else {\r\n                    state = isCommaContextStart(matchStack.token) || isCommaContextEnd(token) ? MATCH : MISMATCH;\r\n                }\r\n\r\n                break;\r\n\r\n            case 'String':\r\n                var string = '';\r\n\r\n                for (var lastTokenIndex = tokenIndex; lastTokenIndex < tokens.length && string.length < state.value.length; lastTokenIndex++) {\r\n                    string += tokens[lastTokenIndex].value;\r\n                }\r\n\r\n                if (areStringsEqualCaseInsensitive(string, state.value)) {\r\n                    while (tokenIndex < lastTokenIndex) {\r\n                        addTokenToMatch();\r\n                    }\r\n\r\n                    state = MATCH;\r\n                } else {\r\n                    state = MISMATCH;\r\n                }\r\n\r\n                break;\r\n\r\n            default:\r\n                throw new Error('Unknown node type: ' + state.type);\r\n        }\r\n    }\r\n\r\n    totalIterationCount += iterationCount;\r\n\r\n    switch (exitReason) {\r\n        case null:\r\n            console.warn('[csstree-match] BREAK after ' + ITERATION_LIMIT + ' iterations');\r\n            exitReason = EXIT_REASON_ITERATION_LIMIT;\r\n            matchStack = null;\r\n            break;\r\n\r\n        case EXIT_REASON_MATCH:\r\n            while (syntaxStack !== null) {\r\n                closeSyntax();\r\n            }\r\n            break;\r\n\r\n        default:\r\n            matchStack = null;\r\n    }\r\n\r\n    return {\r\n        tokens: tokens,\r\n        reason: exitReason,\r\n        iterations: iterationCount,\r\n        match: matchStack,\r\n        longestMatch: longestMatch\r\n    };\r\n}\r\n\r\nfunction matchAsList(tokens, matchGraph, syntaxes) {\r\n    var matchResult = internalMatch(tokens, matchGraph, syntaxes || {});\r\n\r\n    if (matchResult.match !== null) {\r\n        var item = reverseList(matchResult.match).prev;\r\n\r\n        matchResult.match = [];\r\n\r\n        while (item !== null) {\r\n            switch (item.type) {\r\n                case STUB:\r\n                    break;\r\n\r\n                case OPEN_SYNTAX:\r\n                case CLOSE_SYNTAX:\r\n                    matchResult.match.push({\r\n                        type: item.type,\r\n                        syntax: item.syntax\r\n                    });\r\n                    break;\r\n\r\n                default:\r\n                    matchResult.match.push({\r\n                        token: item.token.value,\r\n                        node: item.token.node\r\n                    });\r\n                    break;\r\n            }\r\n\r\n            item = item.prev;\r\n        }\r\n    }\r\n\r\n    return matchResult;\r\n}\r\n\r\nfunction matchAsTree(tokens, matchGraph, syntaxes) {\r\n    var matchResult = internalMatch(tokens, matchGraph, syntaxes || {});\r\n\r\n    if (matchResult.match === null) {\r\n        return matchResult;\r\n    }\r\n\r\n    var item = matchResult.match;\r\n    var host = matchResult.match = {\r\n        syntax: matchGraph.syntax || null,\r\n        match: []\r\n    };\r\n    var hostStack = [host];\r\n\r\n    // revert a list and start with 2nd item since 1st is a stub item\r\n    item = reverseList(item).prev;\r\n\r\n    // build a tree\r\n    while (item !== null) {\r\n        switch (item.type) {\r\n            case OPEN_SYNTAX:\r\n                host.match.push(host = {\r\n                    syntax: item.syntax,\r\n                    match: []\r\n                });\r\n                hostStack.push(host);\r\n                break;\r\n\r\n            case CLOSE_SYNTAX:\r\n                hostStack.pop();\r\n                host = hostStack[hostStack.length - 1];\r\n                break;\r\n\r\n            default:\r\n                host.match.push({\r\n                    syntax: item.syntax || null,\r\n                    token: item.token.value,\r\n                    node: item.token.node\r\n                });\r\n        }\r\n\r\n        item = item.prev;\r\n    }\r\n\r\n    return matchResult;\r\n}\r\n\r\nmodule.exports = {\r\n    matchAsList: matchAsList,\r\n    matchAsTree: matchAsTree,\r\n    getTotalIterationCount: function() {\r\n        return totalIterationCount;\r\n    }\r\n};\r\n","function getTrace(node) {\r\n    function shouldPutToTrace(syntax) {\r\n        if (syntax === null) {\r\n            return false;\r\n        }\r\n\r\n        return (\r\n            syntax.type === 'Type' ||\r\n            syntax.type === 'Property' ||\r\n            syntax.type === 'Keyword'\r\n        );\r\n    }\r\n\r\n    function hasMatch(matchNode) {\r\n        if (Array.isArray(matchNode.match)) {\r\n            // use for-loop for better perfomance\r\n            for (var i = 0; i < matchNode.match.length; i++) {\r\n                if (hasMatch(matchNode.match[i])) {\r\n                    if (shouldPutToTrace(matchNode.syntax)) {\r\n                        result.unshift(matchNode.syntax);\r\n                    }\r\n\r\n                    return true;\r\n                }\r\n            }\r\n        } else if (matchNode.node === node) {\r\n            result = shouldPutToTrace(matchNode.syntax)\r\n                ? [matchNode.syntax]\r\n                : [];\r\n\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    var result = null;\r\n\r\n    if (this.matched !== null) {\r\n        hasMatch(this.matched);\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction testNode(match, node, fn) {\r\n    var trace = getTrace.call(match, node);\r\n\r\n    if (trace === null) {\r\n        return false;\r\n    }\r\n\r\n    return trace.some(fn);\r\n}\r\n\r\nfunction isType(node, type) {\r\n    return testNode(this, node, function(matchNode) {\r\n        return matchNode.type === 'Type' && matchNode.name === type;\r\n    });\r\n}\r\n\r\nfunction isProperty(node, property) {\r\n    return testNode(this, node, function(matchNode) {\r\n        return matchNode.type === 'Property' && matchNode.name === property;\r\n    });\r\n}\r\n\r\nfunction isKeyword(node) {\r\n    return testNode(this, node, function(matchNode) {\r\n        return matchNode.type === 'Keyword';\r\n    });\r\n}\r\n\r\nmodule.exports = {\r\n    getTrace: getTrace,\r\n    isType: isType,\r\n    isProperty: isProperty,\r\n    isKeyword: isKeyword\r\n};\r\n","var List = require('../common/List');\r\n\r\nfunction getFirstMatchNode(matchNode) {\r\n    if ('node' in matchNode) {\r\n        return matchNode.node;\r\n    }\r\n\r\n    return getFirstMatchNode(matchNode.match[0]);\r\n}\r\n\r\nfunction getLastMatchNode(matchNode) {\r\n    if ('node' in matchNode) {\r\n        return matchNode.node;\r\n    }\r\n\r\n    return getLastMatchNode(matchNode.match[matchNode.match.length - 1]);\r\n}\r\n\r\nfunction matchFragments(lexer, ast, match, type, name) {\r\n    function findFragments(matchNode) {\r\n        if (matchNode.syntax !== null &&\r\n            matchNode.syntax.type === type &&\r\n            matchNode.syntax.name === name) {\r\n            var start = getFirstMatchNode(matchNode);\r\n            var end = getLastMatchNode(matchNode);\r\n\r\n            lexer.syntax.walk(ast, function(node, item, list) {\r\n                if (node === start) {\r\n                    var nodes = new List();\r\n\r\n                    do {\r\n                        nodes.appendData(item.data);\r\n\r\n                        if (item.data === end) {\r\n                            break;\r\n                        }\r\n\r\n                        item = item.next;\r\n                    } while (item !== null);\r\n\r\n                    fragments.push({\r\n                        parent: list,\r\n                        nodes: nodes\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\r\n        if (Array.isArray(matchNode.match)) {\r\n            matchNode.match.forEach(findFragments);\r\n        }\r\n    }\r\n\r\n    var fragments = [];\r\n\r\n    if (match.matched !== null) {\r\n        findFragments(match.matched);\r\n    }\r\n\r\n    return fragments;\r\n}\r\n\r\nmodule.exports = {\r\n    matchFragments: matchFragments\r\n};\r\n","var List = require('../common/List');\r\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\r\n\r\nfunction isValidNumber(value) {\r\n    // Number.isInteger(value) && value >= 0\r\n    return (\r\n        typeof value === 'number' &&\r\n        isFinite(value) &&\r\n        Math.floor(value) === value &&\r\n        value >= 0\r\n    );\r\n}\r\n\r\nfunction isValidLocation(loc) {\r\n    return (\r\n        Boolean(loc) &&\r\n        isValidNumber(loc.offset) &&\r\n        isValidNumber(loc.line) &&\r\n        isValidNumber(loc.column)\r\n    );\r\n}\r\n\r\nfunction createNodeStructureChecker(type, fields) {\r\n    return function checkNode(node, warn) {\r\n        if (!node || node.constructor !== Object) {\r\n            return warn(node, 'Type of node should be an Object');\r\n        }\r\n\r\n        for (var key in node) {\r\n            var valid = true;\r\n\r\n            if (hasOwnProperty.call(node, key) === false) {\r\n                continue;\r\n            }\r\n\r\n            if (key === 'type') {\r\n                if (node.type !== type) {\r\n                    warn(node, 'Wrong node type `' + node.type + '`, expected `' + type + '`');\r\n                }\r\n            } else if (key === 'loc') {\r\n                if (node.loc === null) {\r\n                    continue;\r\n                } else if (node.loc && node.loc.constructor === Object) {\r\n                    if (typeof node.loc.source !== 'string') {\r\n                        key += '.source';\r\n                    } else if (!isValidLocation(node.loc.start)) {\r\n                        key += '.start';\r\n                    } else if (!isValidLocation(node.loc.end)) {\r\n                        key += '.end';\r\n                    } else {\r\n                        continue;\r\n                    }\r\n                }\r\n\r\n                valid = false;\r\n            } else if (fields.hasOwnProperty(key)) {\r\n                for (var i = 0, valid = false; !valid && i < fields[key].length; i++) {\r\n                    var fieldType = fields[key][i];\r\n\r\n                    switch (fieldType) {\r\n                        case String:\r\n                            valid = typeof node[key] === 'string';\r\n                            break;\r\n\r\n                        case Boolean:\r\n                            valid = typeof node[key] === 'boolean';\r\n                            break;\r\n\r\n                        case null:\r\n                            valid = node[key] === null;\r\n                            break;\r\n\r\n                        default:\r\n                            if (typeof fieldType === 'string') {\r\n                                valid = node[key] && node[key].type === fieldType;\r\n                            } else if (Array.isArray(fieldType)) {\r\n                                valid = node[key] instanceof List;\r\n                            }\r\n                    }\r\n                }\r\n            } else {\r\n                warn(node, 'Unknown field `' + key + '` for ' + type + ' node type');\r\n            }\r\n\r\n            if (!valid) {\r\n                warn(node, 'Bad value for `' + type + '.' + key + '`');\r\n            }\r\n        }\r\n\r\n        for (var key in fields) {\r\n            if (hasOwnProperty.call(fields, key) &&\r\n                hasOwnProperty.call(node, key) === false) {\r\n                warn(node, 'Field `' + type + '.' + key + '` is missed');\r\n            }\r\n        }\r\n    };\r\n}\r\n\r\nfunction processStructure(name, nodeType) {\r\n    var structure = nodeType.structure;\r\n    var fields = {\r\n        type: String,\r\n        loc: true\r\n    };\r\n    var docs = {\r\n        type: '\"' + name + '\"'\r\n    };\r\n\r\n    for (var key in structure) {\r\n        if (hasOwnProperty.call(structure, key) === false) {\r\n            continue;\r\n        }\r\n\r\n        var docsTypes = [];\r\n        var fieldTypes = fields[key] = Array.isArray(structure[key])\r\n            ? structure[key].slice()\r\n            : [structure[key]];\r\n\r\n        for (var i = 0; i < fieldTypes.length; i++) {\r\n            var fieldType = fieldTypes[i];\r\n            if (fieldType === String || fieldType === Boolean) {\r\n                docsTypes.push(fieldType.name);\r\n            } else if (fieldType === null) {\r\n                docsTypes.push('null');\r\n            } else if (typeof fieldType === 'string') {\r\n                docsTypes.push('<' + fieldType + '>');\r\n            } else if (Array.isArray(fieldType)) {\r\n                docsTypes.push('List'); // TODO: use type enum\r\n            } else {\r\n                throw new Error('Wrong value `' + fieldType + '` in `' + name + '.' + key + '` structure definition');\r\n            }\r\n        }\r\n\r\n        docs[key] = docsTypes.join(' | ');\r\n    }\r\n\r\n    return {\r\n        docs: docs,\r\n        check: createNodeStructureChecker(name, fields)\r\n    };\r\n}\r\n\r\nmodule.exports = {\r\n    getStructureFromConfig: function(config) {\r\n        var structure = {};\r\n\r\n        if (config.node) {\r\n            for (var name in config.node) {\r\n                if (hasOwnProperty.call(config.node, name)) {\r\n                    var nodeType = config.node[name];\r\n\r\n                    if (nodeType.structure) {\r\n                        structure[name] = processStructure(name, nodeType);\r\n                    } else {\r\n                        throw new Error('Missed `structure` field in `' + name + '` node type definition');\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return structure;\r\n    }\r\n};\r\n","var SyntaxReferenceError = require('./error').SyntaxReferenceError;\r\nvar MatchError = require('./error').MatchError;\r\nvar names = require('../utils/names');\r\nvar generic = require('./generic');\r\nvar parse = require('../definition-syntax/parse');\r\nvar generate = require('../definition-syntax/generate');\r\nvar walk = require('../definition-syntax/walk');\r\nvar prepareTokens = require('./prepare-tokens');\r\nvar buildMatchGraph = require('./match-graph').buildMatchGraph;\r\nvar matchAsTree = require('./match').matchAsTree;\r\nvar trace = require('./trace');\r\nvar search = require('./search');\r\nvar getStructureFromConfig = require('./structure').getStructureFromConfig;\r\nvar cssWideKeywords = buildMatchGraph('inherit | initial | unset');\r\nvar cssWideKeywordsWithExpression = buildMatchGraph('inherit | initial | unset | <-ms-legacy-expression>');\r\n\r\nfunction dumpMapSyntax(map, compact, syntaxAsAst) {\r\n    var result = {};\r\n\r\n    for (var name in map) {\r\n        if (map[name].syntax) {\r\n            result[name] = syntaxAsAst\r\n                ? map[name].syntax\r\n                : generate(map[name].syntax, { compact: compact });\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction valueHasVar(tokens) {\r\n    for (var i = 0; i < tokens.length; i++) {\r\n        if (tokens[i].value.toLowerCase() === 'var(') {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nfunction buildMatchResult(match, error, iterations) {\r\n    return {\r\n        matched: match,\r\n        iterations: iterations,\r\n        error: error,\r\n        getTrace: trace.getTrace,\r\n        isType: trace.isType,\r\n        isProperty: trace.isProperty,\r\n        isKeyword: trace.isKeyword\r\n    };\r\n}\r\n\r\nfunction matchSyntax(lexer, syntax, value, useCommon) {\r\n    var tokens = prepareTokens(value, lexer.syntax);\r\n    var result;\r\n\r\n    if (valueHasVar(tokens)) {\r\n        return buildMatchResult(null, new Error('Matching for a tree with var() is not supported'));\r\n    }\r\n\r\n    if (useCommon) {\r\n        result = matchAsTree(tokens, lexer.valueCommonSyntax, lexer);\r\n    }\r\n\r\n    if (!useCommon || !result.match) {\r\n        result = matchAsTree(tokens, syntax.match, lexer);\r\n        if (!result.match) {\r\n            return buildMatchResult(\r\n                null,\r\n                new MatchError(result.reason, syntax.syntax, value, result),\r\n                result.iterations\r\n            );\r\n        }\r\n    }\r\n\r\n    return buildMatchResult(result.match, null, result.iterations);\r\n}\r\n\r\nvar Lexer = function(config, syntax, structure) {\r\n    this.valueCommonSyntax = cssWideKeywords;\r\n    this.syntax = syntax;\r\n    this.generic = false;\r\n    this.atrules = {};\r\n    this.properties = {};\r\n    this.types = {};\r\n    this.structure = structure || getStructureFromConfig(config);\r\n\r\n    if (config) {\r\n        if (config.types) {\r\n            for (var name in config.types) {\r\n                this.addType_(name, config.types[name]);\r\n            }\r\n        }\r\n\r\n        if (config.generic) {\r\n            this.generic = true;\r\n            for (var name in generic) {\r\n                this.addType_(name, generic[name]);\r\n            }\r\n        }\r\n\r\n        if (config.atrules) {\r\n            for (var name in config.atrules) {\r\n                this.addAtrule_(name, config.atrules[name]);\r\n            }\r\n        }\r\n\r\n        if (config.properties) {\r\n            for (var name in config.properties) {\r\n                this.addProperty_(name, config.properties[name]);\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nLexer.prototype = {\r\n    structure: {},\r\n    checkStructure: function(ast) {\r\n        function collectWarning(node, message) {\r\n            warns.push({\r\n                node: node,\r\n                message: message\r\n            });\r\n        }\r\n\r\n        var structure = this.structure;\r\n        var warns = [];\r\n\r\n        this.syntax.walk(ast, function(node) {\r\n            if (structure.hasOwnProperty(node.type)) {\r\n                structure[node.type].check(node, collectWarning);\r\n            } else {\r\n                collectWarning(node, 'Unknown node type `' + node.type + '`');\r\n            }\r\n        });\r\n\r\n        return warns.length ? warns : false;\r\n    },\r\n\r\n    createDescriptor: function(syntax, type, name) {\r\n        var ref = {\r\n            type: type,\r\n            name: name\r\n        };\r\n        var descriptor = {\r\n            type: type,\r\n            name: name,\r\n            syntax: null,\r\n            match: null\r\n        };\r\n\r\n        if (typeof syntax === 'function') {\r\n            descriptor.match = buildMatchGraph(syntax, ref);\r\n        } else {\r\n            if (typeof syntax === 'string') {\r\n                // lazy parsing on first access\r\n                Object.defineProperty(descriptor, 'syntax', {\r\n                    get: function() {\r\n                        Object.defineProperty(descriptor, 'syntax', {\r\n                            value: parse(syntax)\r\n                        });\r\n\r\n                        return descriptor.syntax;\r\n                    }\r\n                });\r\n            } else {\r\n                descriptor.syntax = syntax;\r\n            }\r\n\r\n            // lazy graph build on first access\r\n            Object.defineProperty(descriptor, 'match', {\r\n                get: function() {\r\n                    Object.defineProperty(descriptor, 'match', {\r\n                        value: buildMatchGraph(descriptor.syntax, ref)\r\n                    });\r\n\r\n                    return descriptor.match;\r\n                }\r\n            });\r\n        }\r\n\r\n        return descriptor;\r\n    },\r\n    addAtrule_: function(name, syntax) {\r\n        this.atrules[name] = {\r\n            prelude: syntax.prelude ? this.createDescriptor(syntax.prelude, 'AtrulePrelude', name) : null,\r\n            descriptors: syntax.descriptors\r\n                ? Object.keys(syntax.descriptors).reduce((res, name) => {\r\n                    res[name] = this.createDescriptor(syntax.descriptors[name], 'AtruleDescriptor', name);\r\n                    return res;\r\n                }, {})\r\n                : null\r\n        };\r\n    },\r\n    addProperty_: function(name, syntax) {\r\n        this.properties[name] = this.createDescriptor(syntax, 'Property', name);\r\n    },\r\n    addType_: function(name, syntax) {\r\n        this.types[name] = this.createDescriptor(syntax, 'Type', name);\r\n\r\n        if (syntax === generic['-ms-legacy-expression']) {\r\n            this.valueCommonSyntax = cssWideKeywordsWithExpression;\r\n        }\r\n    },\r\n\r\n    matchAtrulePrelude: function(atruleName, prelude) {\r\n        var atrule = names.keyword(atruleName);\r\n\r\n        var atrulePreludeSyntax = atrule.vendor\r\n            ? this.getAtrulePrelude(atrule.name) || this.getAtrulePrelude(atrule.basename)\r\n            : this.getAtrulePrelude(atrule.name);\r\n\r\n        if (!atrulePreludeSyntax) {\r\n            if (atrule.basename in this.atrules) {\r\n                return buildMatchResult(null, new Error('At-rule `' + atruleName + '` should not contain a prelude'));\r\n            }\r\n\r\n            return buildMatchResult(null, new SyntaxReferenceError('Unknown at-rule', atruleName));\r\n        }\r\n\r\n        return matchSyntax(this, atrulePreludeSyntax, prelude, true);\r\n    },\r\n    matchAtruleDescriptor: function(atruleName, descriptorName, value) {\r\n        var atrule = names.keyword(atruleName);\r\n        var descriptor = names.keyword(descriptorName);\r\n\r\n        var atruleEntry = atrule.vendor\r\n            ? this.atrules[atrule.name] || this.atrules[atrule.basename]\r\n            : this.atrules[atrule.name];\r\n\r\n        if (!atruleEntry) {\r\n            return buildMatchResult(null, new SyntaxReferenceError('Unknown at-rule', atruleName));\r\n        }\r\n\r\n        if (!atruleEntry.descriptors) {\r\n            return buildMatchResult(null, new Error('At-rule `' + atruleName + '` has no known descriptors'));\r\n        }\r\n\r\n        var atruleDescriptorSyntax = descriptor.vendor\r\n            ? atruleEntry.descriptors[descriptor.name] || atruleEntry.descriptors[descriptor.basename]\r\n            : atruleEntry.descriptors[descriptor.name];\r\n\r\n        if (!atruleDescriptorSyntax) {\r\n            return buildMatchResult(null, new SyntaxReferenceError('Unknown at-rule descriptor', descriptorName));\r\n        }\r\n\r\n        return matchSyntax(this, atruleDescriptorSyntax, value, true);\r\n    },\r\n    matchDeclaration: function(node) {\r\n        if (node.type !== 'Declaration') {\r\n            return buildMatchResult(null, new Error('Not a Declaration node'));\r\n        }\r\n\r\n        return this.matchProperty(node.property, node.value);\r\n    },\r\n    matchProperty: function(propertyName, value) {\r\n        var property = names.property(propertyName);\r\n\r\n        // don't match syntax for a custom property\r\n        if (property.custom) {\r\n            return buildMatchResult(null, new Error('Lexer matching doesn\\'t applicable for custom properties'));\r\n        }\r\n\r\n        var propertySyntax = property.vendor\r\n            ? this.getProperty(property.name) || this.getProperty(property.basename)\r\n            : this.getProperty(property.name);\r\n\r\n        if (!propertySyntax) {\r\n            return buildMatchResult(null, new SyntaxReferenceError('Unknown property', propertyName));\r\n        }\r\n\r\n        return matchSyntax(this, propertySyntax, value, true);\r\n    },\r\n    matchType: function(typeName, value) {\r\n        var typeSyntax = this.getType(typeName);\r\n\r\n        if (!typeSyntax) {\r\n            return buildMatchResult(null, new SyntaxReferenceError('Unknown type', typeName));\r\n        }\r\n\r\n        return matchSyntax(this, typeSyntax, value, false);\r\n    },\r\n    match: function(syntax, value) {\r\n        if (typeof syntax !== 'string' && (!syntax || !syntax.type)) {\r\n            return buildMatchResult(null, new SyntaxReferenceError('Bad syntax'));\r\n        }\r\n\r\n        if (typeof syntax === 'string' || !syntax.match) {\r\n            syntax = this.createDescriptor(syntax, 'Type', 'anonymous');\r\n        }\r\n\r\n        return matchSyntax(this, syntax, value, false);\r\n    },\r\n\r\n    findValueFragments: function(propertyName, value, type, name) {\r\n        return search.matchFragments(this, value, this.matchProperty(propertyName, value), type, name);\r\n    },\r\n    findDeclarationValueFragments: function(declaration, type, name) {\r\n        return search.matchFragments(this, declaration.value, this.matchDeclaration(declaration), type, name);\r\n    },\r\n    findAllFragments: function(ast, type, name) {\r\n        var result = [];\r\n\r\n        this.syntax.walk(ast, {\r\n            visit: 'Declaration',\r\n            enter: function(declaration) {\r\n                result.push.apply(result, this.findDeclarationValueFragments(declaration, type, name));\r\n            }.bind(this)\r\n        });\r\n\r\n        return result;\r\n    },\r\n\r\n    getAtrulePrelude: function(atruleName) {\r\n        return this.atrules.hasOwnProperty(atruleName) ? this.atrules[atruleName].prelude : null;\r\n    },\r\n    getAtruleDescriptor: function(atruleName, name) {\r\n        return this.atrules.hasOwnProperty(atruleName) && this.atrules.declarators\r\n            ? this.atrules[atruleName].declarators[name] || null\r\n            : null;\r\n    },\r\n    getProperty: function(name) {\r\n        return this.properties.hasOwnProperty(name) ? this.properties[name] : null;\r\n    },\r\n    getType: function(name) {\r\n        return this.types.hasOwnProperty(name) ? this.types[name] : null;\r\n    },\r\n\r\n    validate: function() {\r\n        function validate(syntax, name, broken, descriptor) {\r\n            if (broken.hasOwnProperty(name)) {\r\n                return broken[name];\r\n            }\r\n\r\n            broken[name] = false;\r\n            if (descriptor.syntax !== null) {\r\n                walk(descriptor.syntax, function(node) {\r\n                    if (node.type !== 'Type' && node.type !== 'Property') {\r\n                        return;\r\n                    }\r\n\r\n                    var map = node.type === 'Type' ? syntax.types : syntax.properties;\r\n                    var brokenMap = node.type === 'Type' ? brokenTypes : brokenProperties;\r\n\r\n                    if (!map.hasOwnProperty(node.name) || validate(syntax, node.name, brokenMap, map[node.name])) {\r\n                        broken[name] = true;\r\n                    }\r\n                }, this);\r\n            }\r\n        }\r\n\r\n        var brokenTypes = {};\r\n        var brokenProperties = {};\r\n\r\n        for (var key in this.types) {\r\n            validate(this, key, brokenTypes, this.types[key]);\r\n        }\r\n\r\n        for (var key in this.properties) {\r\n            validate(this, key, brokenProperties, this.properties[key]);\r\n        }\r\n\r\n        brokenTypes = Object.keys(brokenTypes).filter(function(name) {\r\n            return brokenTypes[name];\r\n        });\r\n        brokenProperties = Object.keys(brokenProperties).filter(function(name) {\r\n            return brokenProperties[name];\r\n        });\r\n\r\n        if (brokenTypes.length || brokenProperties.length) {\r\n            return {\r\n                types: brokenTypes,\r\n                properties: brokenProperties\r\n            };\r\n        }\r\n\r\n        return null;\r\n    },\r\n    dump: function(syntaxAsAst, pretty) {\r\n        return {\r\n            generic: this.generic,\r\n            types: dumpMapSyntax(this.types, !pretty, syntaxAsAst),\r\n            properties: dumpMapSyntax(this.properties, !pretty, syntaxAsAst)\r\n        };\r\n    },\r\n    toString: function() {\r\n        return JSON.stringify(this.dump());\r\n    }\r\n};\r\n\r\nmodule.exports = Lexer;\r\n","module.exports = {\r\n    SyntaxError: require('./SyntaxError'),\r\n    parse: require('./parse'),\r\n    generate: require('./generate'),\r\n    walk: require('./walk')\r\n};\r\n","var adoptBuffer = require('./adopt-buffer');\r\nvar isBOM = require('../tokenizer').isBOM;\r\n\r\nvar N = 10;\r\nvar F = 12;\r\nvar R = 13;\r\n\r\nfunction computeLinesAndColumns(host, source) {\r\n    var sourceLength = source.length;\r\n    var lines = adoptBuffer(host.lines, sourceLength); // +1\r\n    var line = host.startLine;\r\n    var columns = adoptBuffer(host.columns, sourceLength);\r\n    var column = host.startColumn;\r\n    var startOffset = source.length > 0 ? isBOM(source.charCodeAt(0)) : 0;\r\n\r\n    for (var i = startOffset; i < sourceLength; i++) { // -1\r\n        var code = source.charCodeAt(i);\r\n\r\n        lines[i] = line;\r\n        columns[i] = column++;\r\n\r\n        if (code === N || code === R || code === F) {\r\n            if (code === R && i + 1 < sourceLength && source.charCodeAt(i + 1) === N) {\r\n                i++;\r\n                lines[i] = line;\r\n                columns[i] = column;\r\n            }\r\n\r\n            line++;\r\n            column = 1;\r\n        }\r\n    }\r\n\r\n    lines[i] = line;\r\n    columns[i] = column;\r\n\r\n    host.lines = lines;\r\n    host.columns = columns;\r\n}\r\n\r\nvar OffsetToLocation = function() {\r\n    this.lines = null;\r\n    this.columns = null;\r\n    this.linesAndColumnsComputed = false;\r\n};\r\n\r\nOffsetToLocation.prototype = {\r\n    setSource: function(source, startOffset, startLine, startColumn) {\r\n        this.source = source;\r\n        this.startOffset = typeof startOffset === 'undefined' ? 0 : startOffset;\r\n        this.startLine = typeof startLine === 'undefined' ? 1 : startLine;\r\n        this.startColumn = typeof startColumn === 'undefined' ? 1 : startColumn;\r\n        this.linesAndColumnsComputed = false;\r\n    },\r\n\r\n    ensureLinesAndColumnsComputed: function() {\r\n        if (!this.linesAndColumnsComputed) {\r\n            computeLinesAndColumns(this, this.source);\r\n            this.linesAndColumnsComputed = true;\r\n        }\r\n    },\r\n    getLocation: function(offset, filename) {\r\n        this.ensureLinesAndColumnsComputed();\r\n\r\n        return {\r\n            source: filename,\r\n            offset: this.startOffset + offset,\r\n            line: this.lines[offset],\r\n            column: this.columns[offset]\r\n        };\r\n    },\r\n    getLocationRange: function(start, end, filename) {\r\n        this.ensureLinesAndColumnsComputed();\r\n\r\n        return {\r\n            source: filename,\r\n            start: {\r\n                offset: this.startOffset + start,\r\n                line: this.lines[start],\r\n                column: this.columns[start]\r\n            },\r\n            end: {\r\n                offset: this.startOffset + end,\r\n                line: this.lines[end],\r\n                column: this.columns[end]\r\n            }\r\n        };\r\n    }\r\n};\r\n\r\nmodule.exports = OffsetToLocation;\r\n","var TYPE = require('../tokenizer').TYPE;\r\nvar WHITESPACE = TYPE.WhiteSpace;\r\nvar COMMENT = TYPE.Comment;\r\n\r\nmodule.exports = function readSequence(recognizer) {\r\n    var children = this.createList();\r\n    var child = null;\r\n    var context = {\r\n        recognizer: recognizer,\r\n        space: null,\r\n        ignoreWS: false,\r\n        ignoreWSAfter: false\r\n    };\r\n\r\n    this.scanner.skipSC();\r\n\r\n    while (!this.scanner.eof) {\r\n        switch (this.scanner.tokenType) {\r\n            case COMMENT:\r\n                this.scanner.next();\r\n                continue;\r\n\r\n            case WHITESPACE:\r\n                if (context.ignoreWS) {\r\n                    this.scanner.next();\r\n                } else {\r\n                    context.space = this.WhiteSpace();\r\n                }\r\n                continue;\r\n        }\r\n\r\n        child = recognizer.getNode.call(this, context);\r\n\r\n        if (child === undefined) {\r\n            break;\r\n        }\r\n\r\n        if (context.space !== null) {\r\n            children.push(context.space);\r\n            context.space = null;\r\n        }\r\n\r\n        children.push(child);\r\n\r\n        if (context.ignoreWSAfter) {\r\n            context.ignoreWSAfter = false;\r\n            context.ignoreWS = true;\r\n        } else {\r\n            context.ignoreWS = false;\r\n        }\r\n    }\r\n\r\n    return children;\r\n};\r\n","var OffsetToLocation = require('../common/OffsetToLocation');\r\nvar SyntaxError = require('../common/SyntaxError');\r\nvar TokenStream = require('../common/TokenStream');\r\nvar List = require('../common/List');\r\nvar tokenize = require('../tokenizer');\r\nvar constants = require('../tokenizer/const');\r\nvar findWhiteSpaceStart = require('../tokenizer/utils').findWhiteSpaceStart;\r\nvar sequence = require('./sequence');\r\nvar noop = function() {};\r\n\r\nvar TYPE = constants.TYPE;\r\nvar NAME = constants.NAME;\r\nvar WHITESPACE = TYPE.WhiteSpace;\r\nvar IDENT = TYPE.Ident;\r\nvar FUNCTION = TYPE.Function;\r\nvar URL = TYPE.Url;\r\nvar HASH = TYPE.Hash;\r\nvar PERCENTAGE = TYPE.Percentage;\r\nvar NUMBER = TYPE.Number;\r\nvar NUMBERSIGN = 0x0023; // U+0023 NUMBER SIGN (#)\r\nvar NULL = 0;\r\n\r\nfunction createParseContext(name) {\r\n    return function() {\r\n        return this[name]();\r\n    };\r\n}\r\n\r\nfunction processConfig(config) {\r\n    var parserConfig = {\r\n        context: {},\r\n        scope: {},\r\n        atrule: {},\r\n        pseudo: {}\r\n    };\r\n\r\n    if (config.parseContext) {\r\n        for (var name in config.parseContext) {\r\n            switch (typeof config.parseContext[name]) {\r\n                case 'function':\r\n                    parserConfig.context[name] = config.parseContext[name];\r\n                    break;\r\n\r\n                case 'string':\r\n                    parserConfig.context[name] = createParseContext(config.parseContext[name]);\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (config.scope) {\r\n        for (var name in config.scope) {\r\n            parserConfig.scope[name] = config.scope[name];\r\n        }\r\n    }\r\n\r\n    if (config.atrule) {\r\n        for (var name in config.atrule) {\r\n            var atrule = config.atrule[name];\r\n\r\n            if (atrule.parse) {\r\n                parserConfig.atrule[name] = atrule.parse;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (config.pseudo) {\r\n        for (var name in config.pseudo) {\r\n            var pseudo = config.pseudo[name];\r\n\r\n            if (pseudo.parse) {\r\n                parserConfig.pseudo[name] = pseudo.parse;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (config.node) {\r\n        for (var name in config.node) {\r\n            parserConfig[name] = config.node[name].parse;\r\n        }\r\n    }\r\n\r\n    return parserConfig;\r\n}\r\n\r\nmodule.exports = function createParser(config) {\r\n    var parser = {\r\n        scanner: new TokenStream(),\r\n        locationMap: new OffsetToLocation(),\r\n\r\n        filename: '<unknown>',\r\n        needPositions: false,\r\n        onParseError: noop,\r\n        onParseErrorThrow: false,\r\n        parseAtrulePrelude: true,\r\n        parseRulePrelude: true,\r\n        parseValue: true,\r\n        parseCustomProperty: false,\r\n\r\n        readSequence: sequence,\r\n\r\n        createList: function() {\r\n            return new List();\r\n        },\r\n        createSingleNodeList: function(node) {\r\n            return new List().appendData(node);\r\n        },\r\n        getFirstListNode: function(list) {\r\n            return list && list.first();\r\n        },\r\n        getLastListNode: function(list) {\r\n            return list.last();\r\n        },\r\n\r\n        parseWithFallback: function(consumer, fallback) {\r\n            var startToken = this.scanner.tokenIndex;\r\n\r\n            try {\r\n                return consumer.call(this);\r\n            } catch (e) {\r\n                if (this.onParseErrorThrow) {\r\n                    throw e;\r\n                }\r\n\r\n                var fallbackNode = fallback.call(this, startToken);\r\n\r\n                this.onParseErrorThrow = true;\r\n                this.onParseError(e, fallbackNode);\r\n                this.onParseErrorThrow = false;\r\n\r\n                return fallbackNode;\r\n            }\r\n        },\r\n\r\n        lookupNonWSType: function(offset) {\r\n            do {\r\n                var type = this.scanner.lookupType(offset++);\r\n                if (type !== WHITESPACE) {\r\n                    return type;\r\n                }\r\n            } while (type !== NULL);\r\n\r\n            return NULL;\r\n        },\r\n\r\n        eat: function(tokenType) {\r\n            if (this.scanner.tokenType !== tokenType) {\r\n                var offset = this.scanner.tokenStart;\r\n                var message = NAME[tokenType] + ' is expected';\r\n\r\n                // tweak message and offset\r\n                switch (tokenType) {\r\n                    case IDENT:\r\n                        // when identifier is expected but there is a function or url\r\n                        if (this.scanner.tokenType === FUNCTION || this.scanner.tokenType === URL) {\r\n                            offset = this.scanner.tokenEnd - 1;\r\n                            message = 'Identifier is expected but function found';\r\n                        } else {\r\n                            message = 'Identifier is expected';\r\n                        }\r\n                        break;\r\n\r\n                    case HASH:\r\n                        if (this.scanner.isDelim(NUMBERSIGN)) {\r\n                            this.scanner.next();\r\n                            offset++;\r\n                            message = 'Name is expected';\r\n                        }\r\n                        break;\r\n\r\n                    case PERCENTAGE:\r\n                        if (this.scanner.tokenType === NUMBER) {\r\n                            offset = this.scanner.tokenEnd;\r\n                            message = 'Percent sign is expected';\r\n                        }\r\n                        break;\r\n\r\n                    default:\r\n                        // when test type is part of another token show error for current position + 1\r\n                        // e.g. eat(HYPHENMINUS) will fail on \"-foo\", but pointing on \"-\" is odd\r\n                        if (this.scanner.source.charCodeAt(this.scanner.tokenStart) === tokenType) {\r\n                            offset = offset + 1;\r\n                        }\r\n                }\r\n\r\n                this.error(message, offset);\r\n            }\r\n\r\n            this.scanner.next();\r\n        },\r\n\r\n        consume: function(tokenType) {\r\n            var value = this.scanner.getTokenValue();\r\n\r\n            this.eat(tokenType);\r\n\r\n            return value;\r\n        },\r\n        consumeFunctionName: function() {\r\n            var name = this.scanner.source.substring(this.scanner.tokenStart, this.scanner.tokenEnd - 1);\r\n\r\n            this.eat(FUNCTION);\r\n\r\n            return name;\r\n        },\r\n\r\n        getLocation: function(start, end) {\r\n            if (this.needPositions) {\r\n                return this.locationMap.getLocationRange(\r\n                    start,\r\n                    end,\r\n                    this.filename\r\n                );\r\n            }\r\n\r\n            return null;\r\n        },\r\n        getLocationFromList: function(list) {\r\n            if (this.needPositions) {\r\n                var head = this.getFirstListNode(list);\r\n                var tail = this.getLastListNode(list);\r\n                return this.locationMap.getLocationRange(\r\n                    head !== null ? head.loc.start.offset - this.locationMap.startOffset : this.scanner.tokenStart,\r\n                    tail !== null ? tail.loc.end.offset - this.locationMap.startOffset : this.scanner.tokenStart,\r\n                    this.filename\r\n                );\r\n            }\r\n\r\n            return null;\r\n        },\r\n\r\n        error: function(message, offset) {\r\n            var location = typeof offset !== 'undefined' && offset < this.scanner.source.length\r\n                ? this.locationMap.getLocation(offset)\r\n                : this.scanner.eof\r\n                    ? this.locationMap.getLocation(findWhiteSpaceStart(this.scanner.source, this.scanner.source.length - 1))\r\n                    : this.locationMap.getLocation(this.scanner.tokenStart);\r\n\r\n            throw new SyntaxError(\r\n                message || 'Unexpected input',\r\n                this.scanner.source,\r\n                location.offset,\r\n                location.line,\r\n                location.column\r\n            );\r\n        }\r\n    };\r\n\r\n    config = processConfig(config || {});\r\n    for (var key in config) {\r\n        parser[key] = config[key];\r\n    }\r\n\r\n    return function(source, options) {\r\n        options = options || {};\r\n\r\n        var context = options.context || 'default';\r\n        var ast;\r\n\r\n        tokenize(source, parser.scanner);\r\n        parser.locationMap.setSource(\r\n            source,\r\n            options.offset,\r\n            options.line,\r\n            options.column\r\n        );\r\n\r\n        parser.filename = options.filename || '<unknown>';\r\n        parser.needPositions = Boolean(options.positions);\r\n        parser.onParseError = typeof options.onParseError === 'function' ? options.onParseError : noop;\r\n        parser.onParseErrorThrow = false;\r\n        parser.parseAtrulePrelude = 'parseAtrulePrelude' in options ? Boolean(options.parseAtrulePrelude) : true;\r\n        parser.parseRulePrelude = 'parseRulePrelude' in options ? Boolean(options.parseRulePrelude) : true;\r\n        parser.parseValue = 'parseValue' in options ? Boolean(options.parseValue) : true;\r\n        parser.parseCustomProperty = 'parseCustomProperty' in options ? Boolean(options.parseCustomProperty) : false;\r\n\r\n        if (!parser.context.hasOwnProperty(context)) {\r\n            throw new Error('Unknown context `' + context + '`');\r\n        }\r\n\r\n        ast = parser.context[context].call(parser, options);\r\n\r\n        if (!parser.scanner.eof) {\r\n            parser.error();\r\n        }\r\n\r\n        return ast;\r\n    };\r\n};\r\n","var hasOwnProperty = Object.prototype.hasOwnProperty;\r\n\r\nfunction processChildren(node, delimeter) {\r\n    var list = node.children;\r\n    var prev = null;\r\n\r\n    if (typeof delimeter !== 'function') {\r\n        list.forEach(this.node, this);\r\n    } else {\r\n        list.forEach(function(node) {\r\n            if (prev !== null) {\r\n                delimeter.call(this, prev);\r\n            }\r\n\r\n            this.node(node);\r\n            prev = node;\r\n        }, this);\r\n    }\r\n}\r\n\r\nmodule.exports = function createGenerator(config) {\r\n    function processNode(node) {\r\n        if (hasOwnProperty.call(types, node.type)) {\r\n            types[node.type].call(this, node);\r\n        } else {\r\n            throw new Error('Unknown node type: ' + node.type);\r\n        }\r\n    }\r\n\r\n    var types = {};\r\n\r\n    if (config.node) {\r\n        for (var name in config.node) {\r\n            types[name] = config.node[name].generate;\r\n        }\r\n    }\r\n\r\n    return function(node, options) {\r\n        var buffer = '';\r\n        var handlers = {\r\n            children: processChildren,\r\n            node: processNode,\r\n            chunk: function(chunk) {\r\n                buffer += chunk;\r\n            },\r\n            result: function() {\r\n                return buffer;\r\n            }\r\n        };\r\n\r\n        if (options) {\r\n            if (typeof options.decorator === 'function') {\r\n                handlers = options.decorator(handlers);\r\n            }\r\n        }\r\n\r\n        handlers.node(node);\r\n\r\n        return handlers.result();\r\n    };\r\n};\r\n","var List = require('../common/List');\r\n\r\nmodule.exports = function createConvertors(walk) {\r\n    return {\r\n        fromPlainObject: function(ast) {\r\n            walk(ast, {\r\n                enter: function(node) {\r\n                    if (node.children && node.children instanceof List === false) {\r\n                        node.children = new List().fromArray(node.children);\r\n                    }\r\n                }\r\n            });\r\n\r\n            return ast;\r\n        },\r\n        toPlainObject: function(ast) {\r\n            walk(ast, {\r\n                leave: function(node) {\r\n                    if (node.children && node.children instanceof List) {\r\n                        node.children = node.children.toArray();\r\n                    }\r\n                }\r\n            });\r\n\r\n            return ast;\r\n        }\r\n    };\r\n};\r\n","var hasOwnProperty = Object.prototype.hasOwnProperty;\r\nvar noop = function() {};\r\n\r\nfunction ensureFunction(value) {\r\n    return typeof value === 'function' ? value : noop;\r\n}\r\n\r\nfunction invokeForType(fn, type) {\r\n    return function(node, item, list) {\r\n        if (node.type === type) {\r\n            fn.call(this, node, item, list);\r\n        }\r\n    };\r\n}\r\n\r\nfunction getWalkersFromStructure(name, nodeType) {\r\n    var structure = nodeType.structure;\r\n    var walkers = [];\r\n\r\n    for (var key in structure) {\r\n        if (hasOwnProperty.call(structure, key) === false) {\r\n            continue;\r\n        }\r\n\r\n        var fieldTypes = structure[key];\r\n        var walker = {\r\n            name: key,\r\n            type: false,\r\n            nullable: false\r\n        };\r\n\r\n        if (!Array.isArray(structure[key])) {\r\n            fieldTypes = [structure[key]];\r\n        }\r\n\r\n        for (var i = 0; i < fieldTypes.length; i++) {\r\n            var fieldType = fieldTypes[i];\r\n            if (fieldType === null) {\r\n                walker.nullable = true;\r\n            } else if (typeof fieldType === 'string') {\r\n                walker.type = 'node';\r\n            } else if (Array.isArray(fieldType)) {\r\n                walker.type = 'list';\r\n            }\r\n        }\r\n\r\n        if (walker.type) {\r\n            walkers.push(walker);\r\n        }\r\n    }\r\n\r\n    if (walkers.length) {\r\n        return {\r\n            context: nodeType.walkContext,\r\n            fields: walkers\r\n        };\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\nfunction getTypesFromConfig(config) {\r\n    var types = {};\r\n\r\n    for (var name in config.node) {\r\n        if (hasOwnProperty.call(config.node, name)) {\r\n            var nodeType = config.node[name];\r\n\r\n            if (!nodeType.structure) {\r\n                throw new Error('Missed `structure` field in `' + name + '` node type definition');\r\n            }\r\n\r\n            types[name] = getWalkersFromStructure(name, nodeType);\r\n        }\r\n    }\r\n\r\n    return types;\r\n}\r\n\r\nfunction createTypeIterator(config, reverse) {\r\n    var fields = config.fields.slice();\r\n    var contextName = config.context;\r\n    var useContext = typeof contextName === 'string';\r\n\r\n    if (reverse) {\r\n        fields.reverse();\r\n    }\r\n\r\n    return function(node, context, walk) {\r\n        var prevContextValue;\r\n\r\n        if (useContext) {\r\n            prevContextValue = context[contextName];\r\n            context[contextName] = node;\r\n        }\r\n\r\n        for (var i = 0; i < fields.length; i++) {\r\n            var field = fields[i];\r\n            var ref = node[field.name];\r\n\r\n            if (!field.nullable || ref) {\r\n                if (field.type === 'list') {\r\n                    if (reverse) {\r\n                        ref.forEachRight(walk);\r\n                    } else {\r\n                        ref.forEach(walk);\r\n                    }\r\n                } else {\r\n                    walk(ref);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (useContext) {\r\n            context[contextName] = prevContextValue;\r\n        }\r\n    };\r\n}\r\n\r\nfunction createFastTraveralMap(iterators) {\r\n    return {\r\n        Atrule: {\r\n            StyleSheet: iterators.StyleSheet,\r\n            Atrule: iterators.Atrule,\r\n            Rule: iterators.Rule,\r\n            Block: iterators.Block\r\n        },\r\n        Rule: {\r\n            StyleSheet: iterators.StyleSheet,\r\n            Atrule: iterators.Atrule,\r\n            Rule: iterators.Rule,\r\n            Block: iterators.Block\r\n        },\r\n        Declaration: {\r\n            StyleSheet: iterators.StyleSheet,\r\n            Atrule: iterators.Atrule,\r\n            Rule: iterators.Rule,\r\n            Block: iterators.Block,\r\n            DeclarationList: iterators.DeclarationList\r\n        }\r\n    };\r\n}\r\n\r\nmodule.exports = function createWalker(config) {\r\n    var types = getTypesFromConfig(config);\r\n    var iteratorsNatural = {};\r\n    var iteratorsReverse = {};\r\n\r\n    for (var name in types) {\r\n        if (hasOwnProperty.call(types, name) && types[name] !== null) {\r\n            iteratorsNatural[name] = createTypeIterator(types[name], false);\r\n            iteratorsReverse[name] = createTypeIterator(types[name], true);\r\n        }\r\n    }\r\n\r\n    var fastTraversalIteratorsNatural = createFastTraveralMap(iteratorsNatural);\r\n    var fastTraversalIteratorsReverse = createFastTraveralMap(iteratorsReverse);\r\n\r\n    var walk = function(root, options) {\r\n        function walkNode(node, item, list) {\r\n            enter.call(context, node, item, list);\r\n\r\n            if (iterators.hasOwnProperty(node.type)) {\r\n                iterators[node.type](node, context, walkNode);\r\n            }\r\n\r\n            leave.call(context, node, item, list);\r\n        }\r\n\r\n        var enter = noop;\r\n        var leave = noop;\r\n        var iterators = iteratorsNatural;\r\n        var context = {\r\n            root: root,\r\n            stylesheet: null,\r\n            atrule: null,\r\n            atrulePrelude: null,\r\n            rule: null,\r\n            selector: null,\r\n            block: null,\r\n            declaration: null,\r\n            function: null\r\n        };\r\n\r\n        if (typeof options === 'function') {\r\n            enter = options;\r\n        } else if (options) {\r\n            enter = ensureFunction(options.enter);\r\n            leave = ensureFunction(options.leave);\r\n\r\n            if (options.reverse) {\r\n                iterators = iteratorsReverse;\r\n            }\r\n\r\n            if (options.visit) {\r\n                if (fastTraversalIteratorsNatural.hasOwnProperty(options.visit)) {\r\n                    iterators = options.reverse\r\n                        ? fastTraversalIteratorsReverse[options.visit]\r\n                        : fastTraversalIteratorsNatural[options.visit];\r\n                } else if (!types.hasOwnProperty(options.visit)) {\r\n                    throw new Error('Bad value `' + options.visit + '` for `visit` option (should be: ' + Object.keys(types).join(', ') + ')');\r\n                }\r\n\r\n                enter = invokeForType(enter, options.visit);\r\n                leave = invokeForType(leave, options.visit);\r\n            }\r\n        }\r\n\r\n        if (enter === noop && leave === noop) {\r\n            throw new Error('Neither `enter` nor `leave` walker handler is set or both aren\\'t a function');\r\n        }\r\n\r\n        // swap handlers in reverse mode to invert visit order\r\n        if (options.reverse) {\r\n            var tmp = enter;\r\n            enter = leave;\r\n            leave = tmp;\r\n        }\r\n\r\n        walkNode(root);\r\n    };\r\n\r\n    walk.find = function(ast, fn) {\r\n        var found = null;\r\n\r\n        walk(ast, function(node, item, list) {\r\n            if (found === null && fn.call(this, node, item, list)) {\r\n                found = node;\r\n            }\r\n        });\r\n\r\n        return found;\r\n    };\r\n\r\n    walk.findLast = function(ast, fn) {\r\n        var found = null;\r\n\r\n        walk(ast, {\r\n            reverse: true,\r\n            enter: function(node, item, list) {\r\n                if (found === null && fn.call(this, node, item, list)) {\r\n                    found = node;\r\n                }\r\n            }\r\n        });\r\n\r\n        return found;\r\n    };\r\n\r\n    walk.findAll = function(ast, fn) {\r\n        var found = [];\r\n\r\n        walk(ast, function(node, item, list) {\r\n            if (fn.call(this, node, item, list)) {\r\n                found.push(node);\r\n            }\r\n        });\r\n\r\n        return found;\r\n    };\r\n\r\n    return walk;\r\n};\r\n","var List = require('../common/List');\r\n\r\nmodule.exports = function clone(node) {\r\n    var result = {};\r\n\r\n    for (var key in node) {\r\n        var value = node[key];\r\n\r\n        if (value) {\r\n            if (Array.isArray(value) || value instanceof List) {\r\n                value = value.map(clone);\r\n            } else if (value.constructor === Object) {\r\n                value = clone(value);\r\n            }\r\n        }\r\n\r\n        result[key] = value;\r\n    }\r\n\r\n    return result;\r\n};\r\n","var hasOwnProperty = Object.prototype.hasOwnProperty;\r\nvar shape = {\r\n    generic: true,\r\n    types: {},\r\n    atrules: {},\r\n    properties: {},\r\n    parseContext: {},\r\n    scope: {},\r\n    atrule: ['parse'],\r\n    pseudo: ['parse'],\r\n    node: ['name', 'structure', 'parse', 'generate', 'walkContext']\r\n};\r\n\r\nfunction isObject(value) {\r\n    return value && value.constructor === Object;\r\n}\r\n\r\nfunction copy(value) {\r\n    if (isObject(value)) {\r\n        return Object.assign({}, value);\r\n    } else {\r\n        return value;\r\n    }\r\n}\r\nfunction extend(dest, src) {\r\n    for (var key in src) {\r\n        if (hasOwnProperty.call(src, key)) {\r\n            if (isObject(dest[key])) {\r\n                extend(dest[key], copy(src[key]));\r\n            } else {\r\n                dest[key] = copy(src[key]);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction mix(dest, src, shape) {\r\n    for (var key in shape) {\r\n        if (hasOwnProperty.call(shape, key) === false) {\r\n            continue;\r\n        }\r\n\r\n        if (shape[key] === true) {\r\n            if (key in src) {\r\n                if (hasOwnProperty.call(src, key)) {\r\n                    dest[key] = copy(src[key]);\r\n                }\r\n            }\r\n        } else if (shape[key]) {\r\n            if (isObject(shape[key])) {\r\n                var res = {};\r\n                extend(res, dest[key]);\r\n                extend(res, src[key]);\r\n                dest[key] = res;\r\n            } else if (Array.isArray(shape[key])) {\r\n                var res = {};\r\n                var innerShape = shape[key].reduce(function(s, k) {\r\n                    s[k] = true;\r\n                    return s;\r\n                }, {});\r\n                for (var name in dest[key]) {\r\n                    if (hasOwnProperty.call(dest[key], name)) {\r\n                        res[name] = {};\r\n                        if (dest[key] && dest[key][name]) {\r\n                            mix(res[name], dest[key][name], innerShape);\r\n                        }\r\n                    }\r\n                }\r\n                for (var name in src[key]) {\r\n                    if (hasOwnProperty.call(src[key], name)) {\r\n                        if (!res[name]) {\r\n                            res[name] = {};\r\n                        }\r\n                        if (src[key] && src[key][name]) {\r\n                            mix(res[name], src[key][name], innerShape);\r\n                        }\r\n                    }\r\n                }\r\n                dest[key] = res;\r\n            }\r\n        }\r\n    }\r\n    return dest;\r\n}\r\n\r\nmodule.exports = function(dest, src) {\r\n    return mix(dest, src, shape);\r\n};\r\n","var List = require('../common/List');\r\nvar SyntaxError = require('../common/SyntaxError');\r\nvar TokenStream = require('../common/TokenStream');\r\nvar Lexer = require('../lexer/Lexer');\r\nvar definitionSyntax = require('../definition-syntax');\r\nvar tokenize = require('../tokenizer');\r\nvar createParser = require('../parser/create');\r\nvar createGenerator = require('../generator/create');\r\nvar createConvertor = require('../convertor/create');\r\nvar createWalker = require('../walker/create');\r\nvar clone = require('../utils/clone');\r\nvar names = require('../utils/names');\r\nvar mix = require('./config/mix');\r\n\r\nfunction createSyntax(config) {\r\n    var parse = createParser(config);\r\n    var walk = createWalker(config);\r\n    var generate = createGenerator(config);\r\n    var convert = createConvertor(walk);\r\n\r\n    var syntax = {\r\n        List: List,\r\n        SyntaxError: SyntaxError,\r\n        TokenStream: TokenStream,\r\n        Lexer: Lexer,\r\n\r\n        vendorPrefix: names.vendorPrefix,\r\n        keyword: names.keyword,\r\n        property: names.property,\r\n        isCustomProperty: names.isCustomProperty,\r\n\r\n        definitionSyntax: definitionSyntax,\r\n        lexer: null,\r\n        createLexer: function(config) {\r\n            return new Lexer(config, syntax, syntax.lexer.structure);\r\n        },\r\n\r\n        tokenize: tokenize,\r\n        parse: parse,\r\n        walk: walk,\r\n        generate: generate,\r\n\r\n        find: walk.find,\r\n        findLast: walk.findLast,\r\n        findAll: walk.findAll,\r\n\r\n        clone: clone,\r\n        fromPlainObject: convert.fromPlainObject,\r\n        toPlainObject: convert.toPlainObject,\r\n\r\n        createSyntax: function(config) {\r\n            return createSyntax(mix({}, config));\r\n        },\r\n        fork: function(extension) {\r\n            var base = mix({}, config); // copy of config\r\n            return createSyntax(\r\n                typeof extension === 'function'\r\n                    ? extension(base, Object.assign)\r\n                    : mix(base, extension)\r\n            );\r\n        }\r\n    };\r\n\r\n    syntax.lexer = new Lexer({\r\n        generic: true,\r\n        types: config.types,\r\n        atrules: config.atrules,\r\n        properties: config.properties,\r\n        node: config.node\r\n    }, syntax);\r\n\r\n    return syntax;\r\n};\r\n\r\nexports.create = function(config) {\r\n    return createSyntax(mix({}, config));\r\n};\r\n","var mdnAtrules = require('mdn-data-animatable/css/at-rules.json');\r\nvar mdnProperties = require('mdn-data-animatable/css/properties.json');\r\nvar mdnSyntaxes = require('mdn-data-animatable/css/syntaxes.json');\r\nvar patch = require('./patch.json');\r\n\r\nfunction preprocessAtrules(dict) {\r\n    var result = Object.create(null);\r\n\r\n    for (var atruleName in dict) {\r\n        var atrule = dict[atruleName];\r\n        var descriptors = null;\r\n\r\n        if (atrule.descriptors) {\r\n            descriptors = Object.create(null);\r\n\r\n            for (var descriptor in atrule.descriptors) {\r\n                descriptors[descriptor] = atrule.descriptors[descriptor].syntax;\r\n            }\r\n        }\r\n\r\n        result[atruleName.substr(1)] = {\r\n            prelude: atrule.syntax.trim().match(/^@\\S+\\s+([^;\\{]*)/)[1].trim() || null,\r\n            descriptors\r\n        };\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nfunction buildDictionary(dict, patchDict) {\r\n    var result = {};\r\n\r\n    // copy all syntaxes for an original dict\r\n    for (var key in dict) {\r\n        result[key] = dict[key].syntax;\r\n    }\r\n\r\n    // apply a patch\r\n    for (var key in patchDict) {\r\n        if (key in dict) {\r\n            if (patchDict[key].syntax) {\r\n                result[key] = patchDict[key].syntax;\r\n            } else {\r\n                delete result[key];\r\n            }\r\n        } else {\r\n            if (patchDict[key].syntax) {\r\n                result[key] = patchDict[key].syntax;\r\n            }\r\n        }\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nmodule.exports = {\r\n    types: buildDictionary(mdnSyntaxes, patch.syntaxes),\r\n    atrules: preprocessAtrules(mdnAtrules),\r\n    properties: buildDictionary(mdnProperties, patch.properties)\r\n};\r\n","var cmpChar = require('../../tokenizer').cmpChar;\r\nvar isDigit = require('../../tokenizer').isDigit;\r\nvar TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar WHITESPACE = TYPE.WhiteSpace;\r\nvar COMMENT = TYPE.Comment;\r\nvar IDENT = TYPE.Ident;\r\nvar NUMBER = TYPE.Number;\r\nvar DIMENSION = TYPE.Dimension;\r\nvar PLUSSIGN = 0x002B;    // U+002B PLUS SIGN (+)\r\nvar HYPHENMINUS = 0x002D; // U+002D HYPHEN-MINUS (-)\r\nvar N = 0x006E;           // U+006E LATIN SMALL LETTER N (n)\r\nvar DISALLOW_SIGN = true;\r\nvar ALLOW_SIGN = false;\r\n\r\nfunction checkInteger(offset, disallowSign) {\r\n    var pos = this.scanner.tokenStart + offset;\r\n    var code = this.scanner.source.charCodeAt(pos);\r\n\r\n    if (code === PLUSSIGN || code === HYPHENMINUS) {\r\n        if (disallowSign) {\r\n            this.error('Number sign is not allowed');\r\n        }\r\n        pos++;\r\n    }\r\n\r\n    for (; pos < this.scanner.tokenEnd; pos++) {\r\n        if (!isDigit(this.scanner.source.charCodeAt(pos))) {\r\n            this.error('Integer is expected', pos);\r\n        }\r\n    }\r\n}\r\n\r\nfunction checkTokenIsInteger(disallowSign) {\r\n    return checkInteger.call(this, 0, disallowSign);\r\n}\r\n\r\nfunction expectCharCode(offset, code) {\r\n    if (!cmpChar(this.scanner.source, this.scanner.tokenStart + offset, code)) {\r\n        var msg = '';\r\n\r\n        switch (code) {\r\n            case N:\r\n                msg = 'N is expected';\r\n                break;\r\n            case HYPHENMINUS:\r\n                msg = 'HyphenMinus is expected';\r\n                break;\r\n        }\r\n\r\n        this.error(msg, this.scanner.tokenStart + offset);\r\n    }\r\n}\r\n\r\n// ... <signed-integer>\r\n// ... ['+' | '-'] <signless-integer>\r\nfunction consumeB() {\r\n    var offset = 0;\r\n    var sign = 0;\r\n    var type = this.scanner.tokenType;\r\n\r\n    while (type === WHITESPACE || type === COMMENT) {\r\n        type = this.scanner.lookupType(++offset);\r\n    }\r\n\r\n    if (type !== NUMBER) {\r\n        if (this.scanner.isDelim(PLUSSIGN, offset) ||\r\n            this.scanner.isDelim(HYPHENMINUS, offset)) {\r\n            sign = this.scanner.isDelim(PLUSSIGN, offset) ? PLUSSIGN : HYPHENMINUS;\r\n\r\n            do {\r\n                type = this.scanner.lookupType(++offset);\r\n            } while (type === WHITESPACE || type === COMMENT);\r\n\r\n            if (type !== NUMBER) {\r\n                this.scanner.skip(offset);\r\n                checkTokenIsInteger.call(this, DISALLOW_SIGN);\r\n            }\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    if (offset > 0) {\r\n        this.scanner.skip(offset);\r\n    }\r\n\r\n    if (sign === 0) {\r\n        type = this.scanner.source.charCodeAt(this.scanner.tokenStart);\r\n        if (type !== PLUSSIGN && type !== HYPHENMINUS) {\r\n            this.error('Number sign is expected');\r\n        }\r\n    }\r\n\r\n    checkTokenIsInteger.call(this, sign !== 0);\r\n    return sign === HYPHENMINUS ? '-' + this.consume(NUMBER) : this.consume(NUMBER);\r\n}\r\n\r\n// An+B microsyntax https://www.w3.org/TR/css-syntax-3/#anb\r\nmodule.exports = {\r\n    name: 'AnPlusB',\r\n    structure: {\r\n        a: [String, null],\r\n        b: [String, null]\r\n    },\r\n    parse: function() {\r\n        /* eslint-disable brace-style*/\r\n        var start = this.scanner.tokenStart;\r\n        var a = null;\r\n        var b = null;\r\n\r\n        // <integer>\r\n        if (this.scanner.tokenType === NUMBER) {\r\n            checkTokenIsInteger.call(this, ALLOW_SIGN);\r\n            b = this.consume(NUMBER);\r\n        }\r\n\r\n        // -n\r\n        // -n <signed-integer>\r\n        // -n ['+' | '-'] <signless-integer>\r\n        // -n- <signless-integer>\r\n        // <dashndashdigit-ident>\r\n        else if (this.scanner.tokenType === IDENT && cmpChar(this.scanner.source, this.scanner.tokenStart, HYPHENMINUS)) {\r\n            a = '-1';\r\n\r\n            expectCharCode.call(this, 1, N);\r\n\r\n            switch (this.scanner.getTokenLength()) {\r\n                // -n\r\n                // -n <signed-integer>\r\n                // -n ['+' | '-'] <signless-integer>\r\n                case 2:\r\n                    this.scanner.next();\r\n                    b = consumeB.call(this);\r\n                    break;\r\n\r\n                // -n- <signless-integer>\r\n                case 3:\r\n                    expectCharCode.call(this, 2, HYPHENMINUS);\r\n\r\n                    this.scanner.next();\r\n                    this.scanner.skipSC();\r\n\r\n                    checkTokenIsInteger.call(this, DISALLOW_SIGN);\r\n\r\n                    b = '-' + this.consume(NUMBER);\r\n                    break;\r\n\r\n                // <dashndashdigit-ident>\r\n                default:\r\n                    expectCharCode.call(this, 2, HYPHENMINUS);\r\n                    checkInteger.call(this, 3, DISALLOW_SIGN);\r\n                    this.scanner.next();\r\n\r\n                    b = this.scanner.substrToCursor(start + 2);\r\n            }\r\n        }\r\n\r\n        // '+'? n\r\n        // '+'? n <signed-integer>\r\n        // '+'? n ['+' | '-'] <signless-integer>\r\n        // '+'? n- <signless-integer>\r\n        // '+'? <ndashdigit-ident>\r\n        else if (this.scanner.tokenType === IDENT || (this.scanner.isDelim(PLUSSIGN) && this.scanner.lookupType(1) === IDENT)) {\r\n            var sign = 0;\r\n            a = '1';\r\n\r\n            // just ignore a plus\r\n            if (this.scanner.isDelim(PLUSSIGN)) {\r\n                sign = 1;\r\n                this.scanner.next();\r\n            }\r\n\r\n            expectCharCode.call(this, 0, N);\r\n\r\n            switch (this.scanner.getTokenLength()) {\r\n                // '+'? n\r\n                // '+'? n <signed-integer>\r\n                // '+'? n ['+' | '-'] <signless-integer>\r\n                case 1:\r\n                    this.scanner.next();\r\n                    b = consumeB.call(this);\r\n                    break;\r\n\r\n                // '+'? n- <signless-integer>\r\n                case 2:\r\n                    expectCharCode.call(this, 1, HYPHENMINUS);\r\n\r\n                    this.scanner.next();\r\n                    this.scanner.skipSC();\r\n\r\n                    checkTokenIsInteger.call(this, DISALLOW_SIGN);\r\n\r\n                    b = '-' + this.consume(NUMBER);\r\n                    break;\r\n\r\n                // '+'? <ndashdigit-ident>\r\n                default:\r\n                    expectCharCode.call(this, 1, HYPHENMINUS);\r\n                    checkInteger.call(this, 2, DISALLOW_SIGN);\r\n                    this.scanner.next();\r\n\r\n                    b = this.scanner.substrToCursor(start + sign + 1);\r\n            }\r\n        }\r\n\r\n        // <ndashdigit-dimension>\r\n        // <ndash-dimension> <signless-integer>\r\n        // <n-dimension>\r\n        // <n-dimension> <signed-integer>\r\n        // <n-dimension> ['+' | '-'] <signless-integer>\r\n        else if (this.scanner.tokenType === DIMENSION) {\r\n            var code = this.scanner.source.charCodeAt(this.scanner.tokenStart);\r\n            var sign = code === PLUSSIGN || code === HYPHENMINUS;\r\n\r\n            for (var i = this.scanner.tokenStart + sign; i < this.scanner.tokenEnd; i++) {\r\n                if (!isDigit(this.scanner.source.charCodeAt(i))) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (i === this.scanner.tokenStart + sign) {\r\n                this.error('Integer is expected', this.scanner.tokenStart + sign);\r\n            }\r\n\r\n            expectCharCode.call(this, i - this.scanner.tokenStart, N);\r\n            a = this.scanner.source.substring(start, i);\r\n\r\n            // <n-dimension>\r\n            // <n-dimension> <signed-integer>\r\n            // <n-dimension> ['+' | '-'] <signless-integer>\r\n            if (i + 1 === this.scanner.tokenEnd) {\r\n                this.scanner.next();\r\n                b = consumeB.call(this);\r\n            } else {\r\n                expectCharCode.call(this, i - this.scanner.tokenStart + 1, HYPHENMINUS);\r\n\r\n                // <ndash-dimension> <signless-integer>\r\n                if (i + 2 === this.scanner.tokenEnd) {\r\n                    this.scanner.next();\r\n                    this.scanner.skipSC();\r\n                    checkTokenIsInteger.call(this, DISALLOW_SIGN);\r\n                    b = '-' + this.consume(NUMBER);\r\n                }\r\n                // <ndashdigit-dimension>\r\n                else {\r\n                    checkInteger.call(this, i - this.scanner.tokenStart + 2, DISALLOW_SIGN);\r\n                    this.scanner.next();\r\n                    b = this.scanner.substrToCursor(i + 1);\r\n                }\r\n            }\r\n        } else {\r\n            this.error();\r\n        }\r\n\r\n        if (a !== null && a.charCodeAt(0) === PLUSSIGN) {\r\n            a = a.substr(1);\r\n        }\r\n\r\n        if (b !== null && b.charCodeAt(0) === PLUSSIGN) {\r\n            b = b.substr(1);\r\n        }\r\n\r\n        return {\r\n            type: 'AnPlusB',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            a: a,\r\n            b: b\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        var a = node.a !== null && node.a !== undefined;\r\n        var b = node.b !== null && node.b !== undefined;\r\n\r\n        if (a) {\r\n            this.chunk(\r\n                node.a === '+1' ? '+n' : // eslint-disable-line operator-linebreak, indent\r\n                node.a ===  '1' ?  'n' : // eslint-disable-line operator-linebreak, indent\r\n                node.a === '-1' ? '-n' : // eslint-disable-line operator-linebreak, indent\r\n                node.a + 'n'             // eslint-disable-line operator-linebreak, indent\r\n            );\r\n\r\n            if (b) {\r\n                b = String(node.b);\r\n                if (b.charAt(0) === '-' || b.charAt(0) === '+') {\r\n                    this.chunk(b.charAt(0));\r\n                    this.chunk(b.substr(1));\r\n                } else {\r\n                    this.chunk('+');\r\n                    this.chunk(b);\r\n                }\r\n            }\r\n        } else {\r\n            this.chunk(String(node.b));\r\n        }\r\n    }\r\n};\r\n","var tokenizer = require('../../tokenizer');\r\nvar TYPE = tokenizer.TYPE;\r\n\r\nvar WhiteSpace = TYPE.WhiteSpace;\r\nvar Semicolon = TYPE.Semicolon;\r\nvar LeftCurlyBracket = TYPE.LeftCurlyBracket;\r\nvar Delim = TYPE.Delim;\r\nvar EXCLAMATIONMARK = 0x0021; // U+0021 EXCLAMATION MARK (!)\r\n\r\nfunction getOffsetExcludeWS() {\r\n    if (this.scanner.tokenIndex > 0) {\r\n        if (this.scanner.lookupType(-1) === WhiteSpace) {\r\n            return this.scanner.tokenIndex > 1\r\n                ? this.scanner.getTokenStart(this.scanner.tokenIndex - 1)\r\n                : this.scanner.firstCharOffset;\r\n        }\r\n    }\r\n\r\n    return this.scanner.tokenStart;\r\n}\r\n\r\n// 0, 0, false\r\nfunction balanceEnd() {\r\n    return 0;\r\n}\r\n\r\n// LEFTCURLYBRACKET, 0, false\r\nfunction leftCurlyBracket(tokenType) {\r\n    return tokenType === LeftCurlyBracket ? 1 : 0;\r\n}\r\n\r\n// LEFTCURLYBRACKET, SEMICOLON, false\r\nfunction leftCurlyBracketOrSemicolon(tokenType) {\r\n    return tokenType === LeftCurlyBracket || tokenType === Semicolon ? 1 : 0;\r\n}\r\n\r\n// EXCLAMATIONMARK, SEMICOLON, false\r\nfunction exclamationMarkOrSemicolon(tokenType, source, offset) {\r\n    if (tokenType === Delim && source.charCodeAt(offset) === EXCLAMATIONMARK) {\r\n        return 1;\r\n    }\r\n\r\n    return tokenType === Semicolon ? 1 : 0;\r\n}\r\n\r\n// 0, SEMICOLON, true\r\nfunction semicolonIncluded(tokenType) {\r\n    return tokenType === Semicolon ? 2 : 0;\r\n}\r\n\r\nmodule.exports = {\r\n    name: 'Raw',\r\n    structure: {\r\n        value: String\r\n    },\r\n    parse: function(startToken, mode, excludeWhiteSpace) {\r\n        var startOffset = this.scanner.getTokenStart(startToken);\r\n        var endOffset;\r\n\r\n        this.scanner.skip(\r\n            this.scanner.getRawLength(startToken, mode || balanceEnd)\r\n        );\r\n\r\n        if (excludeWhiteSpace && this.scanner.tokenStart > startOffset) {\r\n            endOffset = getOffsetExcludeWS.call(this);\r\n        } else {\r\n            endOffset = this.scanner.tokenStart;\r\n        }\r\n\r\n        return {\r\n            type: 'Raw',\r\n            loc: this.getLocation(startOffset, endOffset),\r\n            value: this.scanner.source.substring(startOffset, endOffset)\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk(node.value);\r\n    },\r\n\r\n    mode: {\r\n        default: balanceEnd,\r\n        leftCurlyBracket: leftCurlyBracket,\r\n        leftCurlyBracketOrSemicolon: leftCurlyBracketOrSemicolon,\r\n        exclamationMarkOrSemicolon: exclamationMarkOrSemicolon,\r\n        semicolonIncluded: semicolonIncluded\r\n    }\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\nvar rawMode = require('./Raw').mode;\r\n\r\nvar ATKEYWORD = TYPE.AtKeyword;\r\nvar SEMICOLON = TYPE.Semicolon;\r\nvar LEFTCURLYBRACKET = TYPE.LeftCurlyBracket;\r\nvar RIGHTCURLYBRACKET = TYPE.RightCurlyBracket;\r\n\r\nfunction consumeRaw(startToken) {\r\n    return this.Raw(startToken, rawMode.leftCurlyBracketOrSemicolon, true);\r\n}\r\n\r\nfunction isDeclarationBlockAtrule() {\r\n    for (var offset = 1, type; type = this.scanner.lookupType(offset); offset++) {\r\n        if (type === RIGHTCURLYBRACKET) {\r\n            return true;\r\n        }\r\n\r\n        if (type === LEFTCURLYBRACKET ||\r\n            type === ATKEYWORD) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nmodule.exports = {\r\n    name: 'Atrule',\r\n    structure: {\r\n        name: String,\r\n        prelude: ['AtrulePrelude', 'Raw', null],\r\n        block: ['Block', null]\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n        var name;\r\n        var nameLowerCase;\r\n        var prelude = null;\r\n        var block = null;\r\n\r\n        this.eat(ATKEYWORD);\r\n\r\n        name = this.scanner.substrToCursor(start + 1);\r\n        nameLowerCase = name.toLowerCase();\r\n        this.scanner.skipSC();\r\n\r\n        // parse prelude\r\n        if (this.scanner.eof === false &&\r\n            this.scanner.tokenType !== LEFTCURLYBRACKET &&\r\n            this.scanner.tokenType !== SEMICOLON) {\r\n            if (this.parseAtrulePrelude) {\r\n                prelude = this.parseWithFallback(this.AtrulePrelude.bind(this, name), consumeRaw);\r\n\r\n                // turn empty AtrulePrelude into null\r\n                if (prelude.type === 'AtrulePrelude' && prelude.children.head === null) {\r\n                    prelude = null;\r\n                }\r\n            } else {\r\n                prelude = consumeRaw.call(this, this.scanner.tokenIndex);\r\n            }\r\n\r\n            this.scanner.skipSC();\r\n        }\r\n\r\n        switch (this.scanner.tokenType) {\r\n            case SEMICOLON:\r\n                this.scanner.next();\r\n                break;\r\n\r\n            case LEFTCURLYBRACKET:\r\n                if (this.atrule.hasOwnProperty(nameLowerCase) &&\r\n                    typeof this.atrule[nameLowerCase].block === 'function') {\r\n                    block = this.atrule[nameLowerCase].block.call(this);\r\n                } else {\r\n                    // TODO: should consume block content as Raw?\r\n                    block = this.Block(isDeclarationBlockAtrule.call(this));\r\n                }\r\n\r\n                break;\r\n        }\r\n\r\n        return {\r\n            type: 'Atrule',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            name: name,\r\n            prelude: prelude,\r\n            block: block\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk('@');\r\n        this.chunk(node.name);\r\n\r\n        if (node.prelude !== null) {\r\n            this.chunk(' ');\r\n            this.node(node.prelude);\r\n        }\r\n\r\n        if (node.block) {\r\n            this.node(node.block);\r\n        } else {\r\n            this.chunk(';');\r\n        }\r\n    },\r\n    walkContext: 'atrule'\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar SEMICOLON = TYPE.Semicolon;\r\nvar LEFTCURLYBRACKET = TYPE.LeftCurlyBracket;\r\n\r\nmodule.exports = {\r\n    name: 'AtrulePrelude',\r\n    structure: {\r\n        children: [[]]\r\n    },\r\n    parse: function(name) {\r\n        var children = null;\r\n\r\n        if (name !== null) {\r\n            name = name.toLowerCase();\r\n        }\r\n\r\n        this.scanner.skipSC();\r\n\r\n        if (this.atrule.hasOwnProperty(name) &&\r\n            typeof this.atrule[name].prelude === 'function') {\r\n            // custom consumer\r\n            children = this.atrule[name].prelude.call(this);\r\n        } else {\r\n            // default consumer\r\n            children = this.readSequence(this.scope.AtrulePrelude);\r\n        }\r\n\r\n        this.scanner.skipSC();\r\n\r\n        if (this.scanner.eof !== true &&\r\n            this.scanner.tokenType !== LEFTCURLYBRACKET &&\r\n            this.scanner.tokenType !== SEMICOLON) {\r\n            this.error('Semicolon or block is expected');\r\n        }\r\n\r\n        if (children === null) {\r\n            children = this.createList();\r\n        }\r\n\r\n        return {\r\n            type: 'AtrulePrelude',\r\n            loc: this.getLocationFromList(children),\r\n            children: children\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.children(node);\r\n    },\r\n    walkContext: 'atrulePrelude'\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar IDENT = TYPE.Ident;\r\nvar STRING = TYPE.String;\r\nvar COLON = TYPE.Colon;\r\nvar LEFTSQUAREBRACKET = TYPE.LeftSquareBracket;\r\nvar RIGHTSQUAREBRACKET = TYPE.RightSquareBracket;\r\nvar DOLLARSIGN = 0x0024;       // U+0024 DOLLAR SIGN ($)\r\nvar ASTERISK = 0x002A;         // U+002A ASTERISK (*)\r\nvar EQUALSSIGN = 0x003D;       // U+003D EQUALS SIGN (=)\r\nvar CIRCUMFLEXACCENT = 0x005E; // U+005E (^)\r\nvar VERTICALLINE = 0x007C;     // U+007C VERTICAL LINE (|)\r\nvar TILDE = 0x007E;            // U+007E TILDE (~)\r\n\r\nfunction getAttributeName() {\r\n    if (this.scanner.eof) {\r\n        this.error('Unexpected end of input');\r\n    }\r\n\r\n    var start = this.scanner.tokenStart;\r\n    var expectIdent = false;\r\n    var checkColon = true;\r\n\r\n    if (this.scanner.isDelim(ASTERISK)) {\r\n        expectIdent = true;\r\n        checkColon = false;\r\n        this.scanner.next();\r\n    } else if (!this.scanner.isDelim(VERTICALLINE)) {\r\n        this.eat(IDENT);\r\n    }\r\n\r\n    if (this.scanner.isDelim(VERTICALLINE)) {\r\n        if (this.scanner.source.charCodeAt(this.scanner.tokenStart + 1) !== EQUALSSIGN) {\r\n            this.scanner.next();\r\n            this.eat(IDENT);\r\n        } else if (expectIdent) {\r\n            this.error('Identifier is expected', this.scanner.tokenEnd);\r\n        }\r\n    } else if (expectIdent) {\r\n        this.error('Vertical line is expected');\r\n    }\r\n\r\n    if (checkColon && this.scanner.tokenType === COLON) {\r\n        this.scanner.next();\r\n        this.eat(IDENT);\r\n    }\r\n\r\n    return {\r\n        type: 'Identifier',\r\n        loc: this.getLocation(start, this.scanner.tokenStart),\r\n        name: this.scanner.substrToCursor(start)\r\n    };\r\n}\r\n\r\nfunction getOperator() {\r\n    var start = this.scanner.tokenStart;\r\n    var code = this.scanner.source.charCodeAt(start);\r\n\r\n    if (code !== EQUALSSIGN &&        // =\r\n        code !== TILDE &&             // ~=\r\n        code !== CIRCUMFLEXACCENT &&  // ^=\r\n        code !== DOLLARSIGN &&        // $=\r\n        code !== ASTERISK &&          // *=\r\n        code !== VERTICALLINE         // |=\r\n    ) {\r\n        this.error('Attribute selector (=, ~=, ^=, $=, *=, |=) is expected');\r\n    }\r\n\r\n    this.scanner.next();\r\n\r\n    if (code !== EQUALSSIGN) {\r\n        if (!this.scanner.isDelim(EQUALSSIGN)) {\r\n            this.error('Equal sign is expected');\r\n        }\r\n\r\n        this.scanner.next();\r\n    }\r\n\r\n    return this.scanner.substrToCursor(start);\r\n}\r\n\r\n// '[' <wq-name> ']'\r\n// '[' <wq-name> <attr-matcher> [ <string-token> | <ident-token> ] <attr-modifier>? ']'\r\nmodule.exports = {\r\n    name: 'AttributeSelector',\r\n    structure: {\r\n        name: 'Identifier',\r\n        matcher: [String, null],\r\n        value: ['String', 'Identifier', null],\r\n        flags: [String, null]\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n        var name;\r\n        var matcher = null;\r\n        var value = null;\r\n        var flags = null;\r\n\r\n        this.eat(LEFTSQUAREBRACKET);\r\n        this.scanner.skipSC();\r\n\r\n        name = getAttributeName.call(this);\r\n        this.scanner.skipSC();\r\n\r\n        if (this.scanner.tokenType !== RIGHTSQUAREBRACKET) {\r\n            // avoid case `[name i]`\r\n            if (this.scanner.tokenType !== IDENT) {\r\n                matcher = getOperator.call(this);\r\n\r\n                this.scanner.skipSC();\r\n\r\n                value = this.scanner.tokenType === STRING\r\n                    ? this.String()\r\n                    : this.Identifier();\r\n\r\n                this.scanner.skipSC();\r\n            }\r\n\r\n            // attribute flags\r\n            if (this.scanner.tokenType === IDENT) {\r\n                flags = this.scanner.getTokenValue();\r\n                this.scanner.next();\r\n\r\n                this.scanner.skipSC();\r\n            }\r\n        }\r\n\r\n        this.eat(RIGHTSQUAREBRACKET);\r\n\r\n        return {\r\n            type: 'AttributeSelector',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            name: name,\r\n            matcher: matcher,\r\n            value: value,\r\n            flags: flags\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        var flagsPrefix = ' ';\r\n\r\n        this.chunk('[');\r\n        this.node(node.name);\r\n\r\n        if (node.matcher !== null) {\r\n            this.chunk(node.matcher);\r\n\r\n            if (node.value !== null) {\r\n                this.node(node.value);\r\n\r\n                // space between string and flags is not required\r\n                if (node.value.type === 'String') {\r\n                    flagsPrefix = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        if (node.flags !== null) {\r\n            this.chunk(flagsPrefix);\r\n            this.chunk(node.flags);\r\n        }\r\n\r\n        this.chunk(']');\r\n    }\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\nvar rawMode = require('./Raw').mode;\r\n\r\nvar WHITESPACE = TYPE.WhiteSpace;\r\nvar COMMENT = TYPE.Comment;\r\nvar SEMICOLON = TYPE.Semicolon;\r\nvar ATKEYWORD = TYPE.AtKeyword;\r\nvar LEFTCURLYBRACKET = TYPE.LeftCurlyBracket;\r\nvar RIGHTCURLYBRACKET = TYPE.RightCurlyBracket;\r\n\r\nfunction consumeRaw(startToken) {\r\n    return this.Raw(startToken, null, true);\r\n}\r\nfunction consumeRule() {\r\n    return this.parseWithFallback(this.Rule, consumeRaw);\r\n}\r\nfunction consumeRawDeclaration(startToken) {\r\n    return this.Raw(startToken, rawMode.semicolonIncluded, true);\r\n}\r\nfunction consumeDeclaration() {\r\n    if (this.scanner.tokenType === SEMICOLON) {\r\n        return consumeRawDeclaration.call(this, this.scanner.tokenIndex);\r\n    }\r\n\r\n    var node = this.parseWithFallback(this.Declaration, consumeRawDeclaration);\r\n\r\n    if (this.scanner.tokenType === SEMICOLON) {\r\n        this.scanner.next();\r\n    }\r\n\r\n    return node;\r\n}\r\n\r\nmodule.exports = {\r\n    name: 'Block',\r\n    structure: {\r\n        children: [[\r\n            'Atrule',\r\n            'Rule',\r\n            'Declaration'\r\n        ]]\r\n    },\r\n    parse: function(isDeclaration) {\r\n        var consumer = isDeclaration ? consumeDeclaration : consumeRule;\r\n\r\n        var start = this.scanner.tokenStart;\r\n        var children = this.createList();\r\n\r\n        this.eat(LEFTCURLYBRACKET);\r\n\r\n        scan:\r\n        while (!this.scanner.eof) {\r\n            switch (this.scanner.tokenType) {\r\n                case RIGHTCURLYBRACKET:\r\n                    break scan;\r\n\r\n                case WHITESPACE:\r\n                case COMMENT:\r\n                    this.scanner.next();\r\n                    break;\r\n\r\n                case ATKEYWORD:\r\n                    children.push(this.parseWithFallback(this.Atrule, consumeRaw));\r\n                    break;\r\n\r\n                default:\r\n                    children.push(consumer.call(this));\r\n            }\r\n        }\r\n\r\n        if (!this.scanner.eof) {\r\n            this.eat(RIGHTCURLYBRACKET);\r\n        }\r\n\r\n        return {\r\n            type: 'Block',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            children: children\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk('{');\r\n        this.children(node, function(prev) {\r\n            if (prev.type === 'Declaration') {\r\n                this.chunk(';');\r\n            }\r\n        });\r\n        this.chunk('}');\r\n    },\r\n    walkContext: 'block'\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar LEFTSQUAREBRACKET = TYPE.LeftSquareBracket;\r\nvar RIGHTSQUAREBRACKET = TYPE.RightSquareBracket;\r\n\r\nmodule.exports = {\r\n    name: 'Brackets',\r\n    structure: {\r\n        children: [[]]\r\n    },\r\n    parse: function(readSequence, recognizer) {\r\n        var start = this.scanner.tokenStart;\r\n        var children = null;\r\n\r\n        this.eat(LEFTSQUAREBRACKET);\r\n\r\n        children = readSequence.call(this, recognizer);\r\n\r\n        if (!this.scanner.eof) {\r\n            this.eat(RIGHTSQUAREBRACKET);\r\n        }\r\n\r\n        return {\r\n            type: 'Brackets',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            children: children\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk('[');\r\n        this.children(node);\r\n        this.chunk(']');\r\n    }\r\n};\r\n","var CDC = require('../../tokenizer').TYPE.CDC;\r\n\r\nmodule.exports = {\r\n    name: 'CDC',\r\n    structure: [],\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n\r\n        this.eat(CDC); // -->\r\n\r\n        return {\r\n            type: 'CDC',\r\n            loc: this.getLocation(start, this.scanner.tokenStart)\r\n        };\r\n    },\r\n    generate: function() {\r\n        this.chunk('-->');\r\n    }\r\n};\r\n","var CDO = require('../../tokenizer').TYPE.CDO;\r\n\r\nmodule.exports = {\r\n    name: 'CDO',\r\n    structure: [],\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n\r\n        this.eat(CDO); // <!--\r\n\r\n        return {\r\n            type: 'CDO',\r\n            loc: this.getLocation(start, this.scanner.tokenStart)\r\n        };\r\n    },\r\n    generate: function() {\r\n        this.chunk('<!--');\r\n    }\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar IDENT = TYPE.Ident;\r\nvar FULLSTOP = 0x002E; // U+002E FULL STOP (.)\r\n\r\n// '.' ident\r\nmodule.exports = {\r\n    name: 'ClassSelector',\r\n    structure: {\r\n        name: String\r\n    },\r\n    parse: function() {\r\n        if (!this.scanner.isDelim(FULLSTOP)) {\r\n            this.error('Full stop is expected');\r\n        }\r\n\r\n        this.scanner.next();\r\n\r\n        return {\r\n            type: 'ClassSelector',\r\n            loc: this.getLocation(this.scanner.tokenStart - 1, this.scanner.tokenEnd),\r\n            name: this.consume(IDENT)\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk('.');\r\n        this.chunk(node.name);\r\n    }\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar IDENT = TYPE.Ident;\r\nvar PLUSSIGN = 0x002B;        // U+002B PLUS SIGN (+)\r\nvar SOLIDUS = 0x002F;         // U+002F SOLIDUS (/)\r\nvar GREATERTHANSIGN = 0x003E; // U+003E GREATER-THAN SIGN (>)\r\nvar TILDE = 0x007E;           // U+007E TILDE (~)\r\n\r\n// + | > | ~ | /deep/\r\nmodule.exports = {\r\n    name: 'Combinator',\r\n    structure: {\r\n        name: String\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n        var code = this.scanner.source.charCodeAt(this.scanner.tokenStart);\r\n\r\n        switch (code) {\r\n            case GREATERTHANSIGN:\r\n            case PLUSSIGN:\r\n            case TILDE:\r\n                this.scanner.next();\r\n                break;\r\n\r\n            case SOLIDUS:\r\n                this.scanner.next();\r\n\r\n                if (this.scanner.tokenType !== IDENT || this.scanner.lookupValue(0, 'deep') === false) {\r\n                    this.error('Identifier `deep` is expected');\r\n                }\r\n\r\n                this.scanner.next();\r\n\r\n                if (!this.scanner.isDelim(SOLIDUS)) {\r\n                    this.error('Solidus is expected');\r\n                }\r\n\r\n                this.scanner.next();\r\n                break;\r\n\r\n            default:\r\n                this.error('Combinator is expected');\r\n        }\r\n\r\n        return {\r\n            type: 'Combinator',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            name: this.scanner.substrToCursor(start)\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk(node.name);\r\n    }\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar COMMENT = TYPE.Comment;\r\nvar ASTERISK = 0x002A;        // U+002A ASTERISK (*)\r\nvar SOLIDUS = 0x002F;         // U+002F SOLIDUS (/)\r\n\r\n// '/*' .* '*/'\r\nmodule.exports = {\r\n    name: 'Comment',\r\n    structure: {\r\n        value: String\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n        var end = this.scanner.tokenEnd;\r\n\r\n        this.eat(COMMENT);\r\n\r\n        if ((end - start + 2) >= 2 &&\r\n            this.scanner.source.charCodeAt(end - 2) === ASTERISK &&\r\n            this.scanner.source.charCodeAt(end - 1) === SOLIDUS) {\r\n            end -= 2;\r\n        }\r\n\r\n        return {\r\n            type: 'Comment',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            value: this.scanner.source.substring(start + 2, end)\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk('/*');\r\n        this.chunk(node.value);\r\n        this.chunk('*/');\r\n    }\r\n};\r\n","var isCustomProperty = require('../../utils/names').isCustomProperty;\r\nvar TYPE = require('../../tokenizer').TYPE;\r\nvar rawMode = require('./Raw').mode;\r\n\r\nvar IDENT = TYPE.Ident;\r\nvar HASH = TYPE.Hash;\r\nvar COLON = TYPE.Colon;\r\nvar SEMICOLON = TYPE.Semicolon;\r\nvar DELIM = TYPE.Delim;\r\nvar EXCLAMATIONMARK = 0x0021; // U+0021 EXCLAMATION MARK (!)\r\nvar NUMBERSIGN = 0x0023;      // U+0023 NUMBER SIGN (#)\r\nvar DOLLARSIGN = 0x0024;      // U+0024 DOLLAR SIGN ($)\r\nvar AMPERSAND = 0x0026;       // U+0026 ANPERSAND (&)\r\nvar ASTERISK = 0x002A;        // U+002A ASTERISK (*)\r\nvar PLUSSIGN = 0x002B;        // U+002B PLUS SIGN (+)\r\nvar SOLIDUS = 0x002F;         // U+002F SOLIDUS (/)\r\n\r\nfunction consumeValueRaw(startToken) {\r\n    return this.Raw(startToken, rawMode.exclamationMarkOrSemicolon, true);\r\n}\r\n\r\nfunction consumeCustomPropertyRaw(startToken) {\r\n    return this.Raw(startToken, rawMode.exclamationMarkOrSemicolon, false);\r\n}\r\n\r\nfunction consumeValue() {\r\n    var startValueToken = this.scanner.tokenIndex;\r\n    var value = this.Value();\r\n\r\n    if (value.type !== 'Raw' &&\r\n        this.scanner.eof === false &&\r\n        this.scanner.tokenType !== SEMICOLON &&\r\n        this.scanner.isDelim(EXCLAMATIONMARK) === false &&\r\n        this.scanner.isBalanceEdge(startValueToken) === false) {\r\n        this.error();\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\nmodule.exports = {\r\n    name: 'Declaration',\r\n    structure: {\r\n        important: [Boolean, String],\r\n        property: String,\r\n        value: ['Value', 'Raw']\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n        var startToken = this.scanner.tokenIndex;\r\n        var property = readProperty.call(this);\r\n        var customProperty = isCustomProperty(property);\r\n        var parseValue = customProperty ? this.parseCustomProperty : this.parseValue;\r\n        var consumeRaw = customProperty ? consumeCustomPropertyRaw : consumeValueRaw;\r\n        var important = false;\r\n        var value;\r\n\r\n        this.scanner.skipSC();\r\n        this.eat(COLON);\r\n\r\n        if (!customProperty) {\r\n            this.scanner.skipSC();\r\n        }\r\n\r\n        if (parseValue) {\r\n            value = this.parseWithFallback(consumeValue, consumeRaw);\r\n        } else {\r\n            value = consumeRaw.call(this, this.scanner.tokenIndex);\r\n        }\r\n\r\n        if (this.scanner.isDelim(EXCLAMATIONMARK)) {\r\n            important = getImportant.call(this);\r\n            this.scanner.skipSC();\r\n        }\r\n\r\n        // Do not include semicolon to range per spec\r\n        // https://drafts.csswg.org/css-syntax/#declaration-diagram\r\n\r\n        if (this.scanner.eof === false &&\r\n            this.scanner.tokenType !== SEMICOLON &&\r\n            this.scanner.isBalanceEdge(startToken) === false) {\r\n            this.error();\r\n        }\r\n\r\n        return {\r\n            type: 'Declaration',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            important: important,\r\n            property: property,\r\n            value: value\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk(node.property);\r\n        this.chunk(':');\r\n        this.node(node.value);\r\n\r\n        if (node.important) {\r\n            this.chunk(node.important === true ? '!important' : '!' + node.important);\r\n        }\r\n    },\r\n    walkContext: 'declaration'\r\n};\r\n\r\nfunction readProperty() {\r\n    var start = this.scanner.tokenStart;\r\n    var prefix = 0;\r\n\r\n    // hacks\r\n    if (this.scanner.tokenType === DELIM) {\r\n        switch (this.scanner.source.charCodeAt(this.scanner.tokenStart)) {\r\n            case ASTERISK:\r\n            case DOLLARSIGN:\r\n            case PLUSSIGN:\r\n            case NUMBERSIGN:\r\n            case AMPERSAND:\r\n                this.scanner.next();\r\n                break;\r\n\r\n            // TODO: not sure we should support this hack\r\n            case SOLIDUS:\r\n                this.scanner.next();\r\n                if (this.scanner.isDelim(SOLIDUS)) {\r\n                    this.scanner.next();\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    if (prefix) {\r\n        this.scanner.skip(prefix);\r\n    }\r\n\r\n    if (this.scanner.tokenType === HASH) {\r\n        this.eat(HASH);\r\n    } else {\r\n        this.eat(IDENT);\r\n    }\r\n\r\n    return this.scanner.substrToCursor(start);\r\n}\r\n\r\n// ! ws* important\r\nfunction getImportant() {\r\n    this.eat(DELIM);\r\n    this.scanner.skipSC();\r\n\r\n    var important = this.consume(IDENT);\r\n\r\n    // store original value in case it differ from `important`\r\n    // for better original source restoring and hacks like `!ie` support\r\n    return important === 'important' ? true : important;\r\n}\r\n","var TYPE = require('../../tokenizer').TYPE;\r\nvar rawMode = require('./Raw').mode;\r\n\r\nvar WHITESPACE = TYPE.WhiteSpace;\r\nvar COMMENT = TYPE.Comment;\r\nvar SEMICOLON = TYPE.Semicolon;\r\n\r\nfunction consumeRaw(startToken) {\r\n    return this.Raw(startToken, rawMode.semicolonIncluded, true);\r\n}\r\n\r\nmodule.exports = {\r\n    name: 'DeclarationList',\r\n    structure: {\r\n        children: [[\r\n            'Declaration'\r\n        ]]\r\n    },\r\n    parse: function() {\r\n        var children = this.createList();\r\n\r\n        scan:\r\n        while (!this.scanner.eof) {\r\n            switch (this.scanner.tokenType) {\r\n                case WHITESPACE:\r\n                case COMMENT:\r\n                case SEMICOLON:\r\n                    this.scanner.next();\r\n                    break;\r\n\r\n                default:\r\n                    children.push(this.parseWithFallback(this.Declaration, consumeRaw));\r\n            }\r\n        }\r\n\r\n        return {\r\n            type: 'DeclarationList',\r\n            loc: this.getLocationFromList(children),\r\n            children: children\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.children(node, function(prev) {\r\n            if (prev.type === 'Declaration') {\r\n                this.chunk(';');\r\n            }\r\n        });\r\n    }\r\n};\r\n","var consumeNumber = require('../../tokenizer/utils').consumeNumber;\r\nvar TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar DIMENSION = TYPE.Dimension;\r\n\r\nmodule.exports = {\r\n    name: 'Dimension',\r\n    structure: {\r\n        value: String,\r\n        unit: String\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n        var numberEnd = consumeNumber(this.scanner.source, start);\r\n\r\n        this.eat(DIMENSION);\r\n\r\n        return {\r\n            type: 'Dimension',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            value: this.scanner.source.substring(start, numberEnd),\r\n            unit: this.scanner.source.substring(numberEnd, this.scanner.tokenStart)\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk(node.value);\r\n        this.chunk(node.unit);\r\n    }\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\r\n\r\n// <function-token> <sequence> )\r\nmodule.exports = {\r\n    name: 'Function',\r\n    structure: {\r\n        name: String,\r\n        children: [[]]\r\n    },\r\n    parse: function(readSequence, recognizer) {\r\n        var start = this.scanner.tokenStart;\r\n        var name = this.consumeFunctionName();\r\n        var nameLowerCase = name.toLowerCase();\r\n        var children;\r\n\r\n        children = recognizer.hasOwnProperty(nameLowerCase)\r\n            ? recognizer[nameLowerCase].call(this, recognizer)\r\n            : readSequence.call(this, recognizer);\r\n\r\n        if (!this.scanner.eof) {\r\n            this.eat(RIGHTPARENTHESIS);\r\n        }\r\n\r\n        return {\r\n            type: 'Function',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            name: name,\r\n            children: children\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk(node.name);\r\n        this.chunk('(');\r\n        this.children(node);\r\n        this.chunk(')');\r\n    },\r\n    walkContext: 'function'\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar HASH = TYPE.Hash;\r\n\r\n// '#' ident\r\nmodule.exports = {\r\n    name: 'HexColor',\r\n    structure: {\r\n        value: String\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n\r\n        this.eat(HASH);\r\n\r\n        return {\r\n            type: 'HexColor',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            value: this.scanner.substrToCursor(start + 1)\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk('#');\r\n        this.chunk(node.value);\r\n    }\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar IDENT = TYPE.Ident;\r\n\r\nmodule.exports = {\r\n    name: 'Identifier',\r\n    structure: {\r\n        name: String\r\n    },\r\n    parse: function() {\r\n        return {\r\n            type: 'Identifier',\r\n            loc: this.getLocation(this.scanner.tokenStart, this.scanner.tokenEnd),\r\n            name: this.consume(IDENT)\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk(node.name);\r\n    }\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar HASH = TYPE.Hash;\r\n\r\n// <hash-token>\r\nmodule.exports = {\r\n    name: 'IdSelector',\r\n    structure: {\r\n        name: String\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n\r\n        // TODO: check value is an ident\r\n        this.eat(HASH);\r\n\r\n        return {\r\n            type: 'IdSelector',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            name: this.scanner.substrToCursor(start + 1)\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk('#');\r\n        this.chunk(node.name);\r\n    }\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar IDENT = TYPE.Ident;\r\nvar NUMBER = TYPE.Number;\r\nvar DIMENSION = TYPE.Dimension;\r\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\r\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\r\nvar COLON = TYPE.Colon;\r\nvar DELIM = TYPE.Delim;\r\n\r\nmodule.exports = {\r\n    name: 'MediaFeature',\r\n    structure: {\r\n        name: String,\r\n        value: ['Identifier', 'Number', 'Dimension', 'Ratio', null]\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n        var name;\r\n        var value = null;\r\n\r\n        this.eat(LEFTPARENTHESIS);\r\n        this.scanner.skipSC();\r\n\r\n        name = this.consume(IDENT);\r\n        this.scanner.skipSC();\r\n\r\n        if (this.scanner.tokenType !== RIGHTPARENTHESIS) {\r\n            this.eat(COLON);\r\n            this.scanner.skipSC();\r\n\r\n            switch (this.scanner.tokenType) {\r\n                case NUMBER:\r\n                    if (this.lookupNonWSType(1) === DELIM) {\r\n                        value = this.Ratio();\r\n                    } else {\r\n                        value = this.Number();\r\n                    }\r\n\r\n                    break;\r\n\r\n                case DIMENSION:\r\n                    value = this.Dimension();\r\n                    break;\r\n\r\n                case IDENT:\r\n                    value = this.Identifier();\r\n\r\n                    break;\r\n\r\n                default:\r\n                    this.error('Number, dimension, ratio or identifier is expected');\r\n            }\r\n\r\n            this.scanner.skipSC();\r\n        }\r\n\r\n        this.eat(RIGHTPARENTHESIS);\r\n\r\n        return {\r\n            type: 'MediaFeature',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            name: name,\r\n            value: value\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk('(');\r\n        this.chunk(node.name);\r\n        if (node.value !== null) {\r\n            this.chunk(':');\r\n            this.node(node.value);\r\n        }\r\n        this.chunk(')');\r\n    }\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar WHITESPACE = TYPE.WhiteSpace;\r\nvar COMMENT = TYPE.Comment;\r\nvar IDENT = TYPE.Ident;\r\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\r\n\r\nmodule.exports = {\r\n    name: 'MediaQuery',\r\n    structure: {\r\n        children: [[\r\n            'Identifier',\r\n            'MediaFeature',\r\n            'WhiteSpace'\r\n        ]]\r\n    },\r\n    parse: function() {\r\n        this.scanner.skipSC();\r\n\r\n        var children = this.createList();\r\n        var child = null;\r\n        var space = null;\r\n\r\n        scan:\r\n        while (!this.scanner.eof) {\r\n            switch (this.scanner.tokenType) {\r\n                case COMMENT:\r\n                    this.scanner.next();\r\n                    continue;\r\n\r\n                case WHITESPACE:\r\n                    space = this.WhiteSpace();\r\n                    continue;\r\n\r\n                case IDENT:\r\n                    child = this.Identifier();\r\n                    break;\r\n\r\n                case LEFTPARENTHESIS:\r\n                    child = this.MediaFeature();\r\n                    break;\r\n\r\n                default:\r\n                    break scan;\r\n            }\r\n\r\n            if (space !== null) {\r\n                children.push(space);\r\n                space = null;\r\n            }\r\n\r\n            children.push(child);\r\n        }\r\n\r\n        if (child === null) {\r\n            this.error('Identifier or parenthesis is expected');\r\n        }\r\n\r\n        return {\r\n            type: 'MediaQuery',\r\n            loc: this.getLocationFromList(children),\r\n            children: children\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.children(node);\r\n    }\r\n};\r\n","var COMMA = require('../../tokenizer').TYPE.Comma;\r\n\r\nmodule.exports = {\r\n    name: 'MediaQueryList',\r\n    structure: {\r\n        children: [[\r\n            'MediaQuery'\r\n        ]]\r\n    },\r\n    parse: function(relative) {\r\n        var children = this.createList();\r\n\r\n        this.scanner.skipSC();\r\n\r\n        while (!this.scanner.eof) {\r\n            children.push(this.MediaQuery(relative));\r\n\r\n            if (this.scanner.tokenType !== COMMA) {\r\n                break;\r\n            }\r\n\r\n            this.scanner.next();\r\n        }\r\n\r\n        return {\r\n            type: 'MediaQueryList',\r\n            loc: this.getLocationFromList(children),\r\n            children: children\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.children(node, function() {\r\n            this.chunk(',');\r\n        });\r\n    }\r\n};\r\n","var NUMBER = require('../../tokenizer').TYPE.Number;\r\n\r\nmodule.exports = {\r\n    name: 'Number',\r\n    structure: {\r\n        value: String\r\n    },\r\n    parse: function() {\r\n        return {\r\n            type: 'Number',\r\n            loc: this.getLocation(this.scanner.tokenStart, this.scanner.tokenEnd),\r\n            value: this.consume(NUMBER)\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk(node.value);\r\n    }\r\n};\r\n","// '/' | '*' | ',' | ':' | '+' | '-'\r\nmodule.exports = {\r\n    name: 'Operator',\r\n    structure: {\r\n        value: String\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n\r\n        this.scanner.next();\r\n\r\n        return {\r\n            type: 'Operator',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            value: this.scanner.substrToCursor(start)\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk(node.value);\r\n    }\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\r\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\r\n\r\nmodule.exports = {\r\n    name: 'Parentheses',\r\n    structure: {\r\n        children: [[]]\r\n    },\r\n    parse: function(readSequence, recognizer) {\r\n        var start = this.scanner.tokenStart;\r\n        var children = null;\r\n\r\n        this.eat(LEFTPARENTHESIS);\r\n\r\n        children = readSequence.call(this, recognizer);\r\n\r\n        if (!this.scanner.eof) {\r\n            this.eat(RIGHTPARENTHESIS);\r\n        }\r\n\r\n        return {\r\n            type: 'Parentheses',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            children: children\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk('(');\r\n        this.children(node);\r\n        this.chunk(')');\r\n    }\r\n};\r\n","var consumeNumber = require('../../tokenizer/utils').consumeNumber;\r\nvar TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar PERCENTAGE = TYPE.Percentage;\r\n\r\nmodule.exports = {\r\n    name: 'Percentage',\r\n    structure: {\r\n        value: String\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n        var numberEnd = consumeNumber(this.scanner.source, start);\r\n\r\n        this.eat(PERCENTAGE);\r\n\r\n        return {\r\n            type: 'Percentage',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            value: this.scanner.source.substring(start, numberEnd)\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk(node.value);\r\n        this.chunk('%');\r\n    }\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar IDENT = TYPE.Ident;\r\nvar FUNCTION = TYPE.Function;\r\nvar COLON = TYPE.Colon;\r\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\r\n\r\n// : [ <ident> | <function-token> <any-value>? ) ]\r\nmodule.exports = {\r\n    name: 'PseudoClassSelector',\r\n    structure: {\r\n        name: String,\r\n        children: [['Raw'], null]\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n        var children = null;\r\n        var name;\r\n        var nameLowerCase;\r\n\r\n        this.eat(COLON);\r\n\r\n        if (this.scanner.tokenType === FUNCTION) {\r\n            name = this.consumeFunctionName();\r\n            nameLowerCase = name.toLowerCase();\r\n\r\n            if (this.pseudo.hasOwnProperty(nameLowerCase)) {\r\n                this.scanner.skipSC();\r\n                children = this.pseudo[nameLowerCase].call(this);\r\n                this.scanner.skipSC();\r\n            } else {\r\n                children = this.createList();\r\n                children.push(\r\n                    this.Raw(this.scanner.tokenIndex, null, false)\r\n                );\r\n            }\r\n\r\n            this.eat(RIGHTPARENTHESIS);\r\n        } else {\r\n            name = this.consume(IDENT);\r\n        }\r\n\r\n        return {\r\n            type: 'PseudoClassSelector',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            name: name,\r\n            children: children\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk(':');\r\n        this.chunk(node.name);\r\n\r\n        if (node.children !== null) {\r\n            this.chunk('(');\r\n            this.children(node);\r\n            this.chunk(')');\r\n        }\r\n    },\r\n    walkContext: 'function'\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar IDENT = TYPE.Ident;\r\nvar FUNCTION = TYPE.Function;\r\nvar COLON = TYPE.Colon;\r\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\r\n\r\n// :: [ <ident> | <function-token> <any-value>? ) ]\r\nmodule.exports = {\r\n    name: 'PseudoElementSelector',\r\n    structure: {\r\n        name: String,\r\n        children: [['Raw'], null]\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n        var children = null;\r\n        var name;\r\n        var nameLowerCase;\r\n\r\n        this.eat(COLON);\r\n        this.eat(COLON);\r\n\r\n        if (this.scanner.tokenType === FUNCTION) {\r\n            name = this.consumeFunctionName();\r\n            nameLowerCase = name.toLowerCase();\r\n\r\n            if (this.pseudo.hasOwnProperty(nameLowerCase)) {\r\n                this.scanner.skipSC();\r\n                children = this.pseudo[nameLowerCase].call(this);\r\n                this.scanner.skipSC();\r\n            } else {\r\n                children = this.createList();\r\n                children.push(\r\n                    this.Raw(this.scanner.tokenIndex, null, false)\r\n                );\r\n            }\r\n\r\n            this.eat(RIGHTPARENTHESIS);\r\n        } else {\r\n            name = this.consume(IDENT);\r\n        }\r\n\r\n        return {\r\n            type: 'PseudoElementSelector',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            name: name,\r\n            children: children\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk('::');\r\n        this.chunk(node.name);\r\n\r\n        if (node.children !== null) {\r\n            this.chunk('(');\r\n            this.children(node);\r\n            this.chunk(')');\r\n        }\r\n    },\r\n    walkContext: 'function'\r\n};\r\n","var isDigit = require('../../tokenizer').isDigit;\r\nvar TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar NUMBER = TYPE.Number;\r\nvar DELIM = TYPE.Delim;\r\nvar SOLIDUS = 0x002F;  // U+002F SOLIDUS (/)\r\nvar FULLSTOP = 0x002E; // U+002E FULL STOP (.)\r\n\r\n// Terms of <ratio> should be a positive numbers (not zero or negative)\r\n// (see https://drafts.csswg.org/mediaqueries-3/#values)\r\n// However, -o-min-device-pixel-ratio takes fractional values as a ratio's term\r\n// and this is using by various sites. Therefore we relax checking on parse\r\n// to test a term is unsigned number without an exponent part.\r\n// Additional checking may be applied on lexer validation.\r\nfunction consumeNumber() {\r\n    this.scanner.skipWS();\r\n\r\n    var value = this.consume(NUMBER);\r\n\r\n    for (var i = 0; i < value.length; i++) {\r\n        var code = value.charCodeAt(i);\r\n        if (!isDigit(code) && code !== FULLSTOP) {\r\n            this.error('Unsigned number is expected', this.scanner.tokenStart - value.length + i);\r\n        }\r\n    }\r\n\r\n    if (Number(value) === 0) {\r\n        this.error('Zero number is not allowed', this.scanner.tokenStart - value.length);\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n// <positive-integer> S* '/' S* <positive-integer>\r\nmodule.exports = {\r\n    name: 'Ratio',\r\n    structure: {\r\n        left: String,\r\n        right: String\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n        var left = consumeNumber.call(this);\r\n        var right;\r\n\r\n        this.scanner.skipWS();\r\n\r\n        if (!this.scanner.isDelim(SOLIDUS)) {\r\n            this.error('Solidus is expected');\r\n        }\r\n        this.eat(DELIM);\r\n        right = consumeNumber.call(this);\r\n\r\n        return {\r\n            type: 'Ratio',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            left: left,\r\n            right: right\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk(node.left);\r\n        this.chunk('/');\r\n        this.chunk(node.right);\r\n    }\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\nvar rawMode = require('./Raw').mode;\r\n\r\nvar LEFTCURLYBRACKET = TYPE.LeftCurlyBracket;\r\n\r\nfunction consumeRaw(startToken) {\r\n    return this.Raw(startToken, rawMode.leftCurlyBracket, true);\r\n}\r\n\r\nfunction consumePrelude() {\r\n    var prelude = this.SelectorList();\r\n\r\n    if (prelude.type !== 'Raw' &&\r\n        this.scanner.eof === false &&\r\n        this.scanner.tokenType !== LEFTCURLYBRACKET) {\r\n        this.error();\r\n    }\r\n\r\n    return prelude;\r\n}\r\n\r\nmodule.exports = {\r\n    name: 'Rule',\r\n    structure: {\r\n        prelude: ['SelectorList', 'Raw'],\r\n        block: ['Block']\r\n    },\r\n    parse: function() {\r\n        var startToken = this.scanner.tokenIndex;\r\n        var startOffset = this.scanner.tokenStart;\r\n        var prelude;\r\n        var block;\r\n\r\n        if (this.parseRulePrelude) {\r\n            prelude = this.parseWithFallback(consumePrelude, consumeRaw);\r\n        } else {\r\n            prelude = consumeRaw.call(this, startToken);\r\n        }\r\n\r\n        block = this.Block(true);\r\n\r\n        return {\r\n            type: 'Rule',\r\n            loc: this.getLocation(startOffset, this.scanner.tokenStart),\r\n            prelude: prelude,\r\n            block: block\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.node(node.prelude);\r\n        this.node(node.block);\r\n    },\r\n    walkContext: 'rule'\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar COMMA = TYPE.Comma;\r\n\r\nmodule.exports = {\r\n    name: 'SelectorList',\r\n    structure: {\r\n        children: [[\r\n            'Selector',\r\n            'Raw'\r\n        ]]\r\n    },\r\n    parse: function() {\r\n        var children = this.createList();\r\n\r\n        while (!this.scanner.eof) {\r\n            children.push(this.Selector());\r\n\r\n            if (this.scanner.tokenType === COMMA) {\r\n                this.scanner.next();\r\n                continue;\r\n            }\r\n\r\n            break;\r\n        }\r\n\r\n        return {\r\n            type: 'SelectorList',\r\n            loc: this.getLocationFromList(children),\r\n            children: children\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.children(node, function() {\r\n            this.chunk(',');\r\n        });\r\n    },\r\n    walkContext: 'selector'\r\n};\r\n","var STRING = require('../../tokenizer').TYPE.String;\r\n\r\nmodule.exports = {\r\n    name: 'String',\r\n    structure: {\r\n        value: String\r\n    },\r\n    parse: function() {\r\n        return {\r\n            type: 'String',\r\n            loc: this.getLocation(this.scanner.tokenStart, this.scanner.tokenEnd),\r\n            value: this.consume(STRING)\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk(node.value);\r\n    }\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar WHITESPACE = TYPE.WhiteSpace;\r\nvar COMMENT = TYPE.Comment;\r\nvar ATKEYWORD = TYPE.AtKeyword;\r\nvar CDO = TYPE.CDO;\r\nvar CDC = TYPE.CDC;\r\nvar EXCLAMATIONMARK = 0x0021; // U+0021 EXCLAMATION MARK (!)\r\n\r\nfunction consumeRaw(startToken) {\r\n    return this.Raw(startToken, null, false);\r\n}\r\n\r\nmodule.exports = {\r\n    name: 'StyleSheet',\r\n    structure: {\r\n        children: [[\r\n            'Comment',\r\n            'CDO',\r\n            'CDC',\r\n            'Atrule',\r\n            'Rule',\r\n            'Raw'\r\n        ]]\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n        var children = this.createList();\r\n        var child;\r\n\r\n        scan:\r\n        while (!this.scanner.eof) {\r\n            switch (this.scanner.tokenType) {\r\n                case WHITESPACE:\r\n                    this.scanner.next();\r\n                    continue;\r\n\r\n                case COMMENT:\r\n                    // ignore comments except exclamation comments (i.e. /*! .. */) on top level\r\n                    if (this.scanner.source.charCodeAt(this.scanner.tokenStart + 2) !== EXCLAMATIONMARK) {\r\n                        this.scanner.next();\r\n                        continue;\r\n                    }\r\n\r\n                    child = this.Comment();\r\n                    break;\r\n\r\n                case CDO: // <!--\r\n                    child = this.CDO();\r\n                    break;\r\n\r\n                case CDC: // -->\r\n                    child = this.CDC();\r\n                    break;\r\n\r\n                // CSS Syntax Module Level 3\r\n                // §2.2 Error handling\r\n                // At the \"top level\" of a stylesheet, an <at-keyword-token> starts an at-rule.\r\n                case ATKEYWORD:\r\n                    child = this.parseWithFallback(this.Atrule, consumeRaw);\r\n                    break;\r\n\r\n                // Anything else starts a qualified rule ...\r\n                default:\r\n                    child = this.parseWithFallback(this.Rule, consumeRaw);\r\n            }\r\n\r\n            children.push(child);\r\n        }\r\n\r\n        return {\r\n            type: 'StyleSheet',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            children: children\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.children(node);\r\n    },\r\n    walkContext: 'stylesheet'\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar IDENT = TYPE.Ident;\r\nvar ASTERISK = 0x002A;     // U+002A ASTERISK (*)\r\nvar VERTICALLINE = 0x007C; // U+007C VERTICAL LINE (|)\r\n\r\nfunction eatIdentifierOrAsterisk() {\r\n    if (this.scanner.tokenType !== IDENT &&\r\n        this.scanner.isDelim(ASTERISK) === false) {\r\n        this.error('Identifier or asterisk is expected');\r\n    }\r\n\r\n    this.scanner.next();\r\n}\r\n\r\n// ident\r\n// ident|ident\r\n// ident|*\r\n// *\r\n// *|ident\r\n// *|*\r\n// |ident\r\n// |*\r\nmodule.exports = {\r\n    name: 'TypeSelector',\r\n    structure: {\r\n        name: String\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n\r\n        if (this.scanner.isDelim(VERTICALLINE)) {\r\n            this.scanner.next();\r\n            eatIdentifierOrAsterisk.call(this);\r\n        } else {\r\n            eatIdentifierOrAsterisk.call(this);\r\n\r\n            if (this.scanner.isDelim(VERTICALLINE)) {\r\n                this.scanner.next();\r\n                eatIdentifierOrAsterisk.call(this);\r\n            }\r\n        }\r\n\r\n        return {\r\n            type: 'TypeSelector',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            name: this.scanner.substrToCursor(start)\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk(node.name);\r\n    }\r\n};\r\n","var isHexDigit = require('../../tokenizer').isHexDigit;\r\nvar cmpChar = require('../../tokenizer').cmpChar;\r\nvar TYPE = require('../../tokenizer').TYPE;\r\nvar NAME = require('../../tokenizer').NAME;\r\n\r\nvar IDENT = TYPE.Ident;\r\nvar NUMBER = TYPE.Number;\r\nvar DIMENSION = TYPE.Dimension;\r\nvar PLUSSIGN = 0x002B;     // U+002B PLUS SIGN (+)\r\nvar HYPHENMINUS = 0x002D;  // U+002D HYPHEN-MINUS (-)\r\nvar QUESTIONMARK = 0x003F; // U+003F QUESTION MARK (?)\r\nvar U = 0x0075;            // U+0075 LATIN SMALL LETTER U (u)\r\n\r\nfunction eatHexSequence(offset, allowDash) {\r\n    for (var pos = this.scanner.tokenStart + offset, len = 0; pos < this.scanner.tokenEnd; pos++) {\r\n        var code = this.scanner.source.charCodeAt(pos);\r\n\r\n        if (code === HYPHENMINUS && allowDash && len !== 0) {\r\n            if (eatHexSequence.call(this, offset + len + 1, false) === 0) {\r\n                this.error();\r\n            }\r\n\r\n            return -1;\r\n        }\r\n\r\n        if (!isHexDigit(code)) {\r\n            this.error(\r\n                allowDash && len !== 0\r\n                    ? 'HyphenMinus' + (len < 6 ? ' or hex digit' : '') + ' is expected'\r\n                    : (len < 6 ? 'Hex digit is expected' : 'Unexpected input'),\r\n                pos\r\n            );\r\n        }\r\n\r\n        if (++len > 6) {\r\n            this.error('Too many hex digits', pos);\r\n        };\r\n    }\r\n\r\n    this.scanner.next();\r\n    return len;\r\n}\r\n\r\nfunction eatQuestionMarkSequence(max) {\r\n    var count = 0;\r\n\r\n    while (this.scanner.isDelim(QUESTIONMARK)) {\r\n        if (++count > max) {\r\n            this.error('Too many question marks');\r\n        }\r\n\r\n        this.scanner.next();\r\n    }\r\n}\r\n\r\nfunction startsWith(code) {\r\n    if (this.scanner.source.charCodeAt(this.scanner.tokenStart) !== code) {\r\n        this.error(NAME[code] + ' is expected');\r\n    }\r\n}\r\n\r\n// https://drafts.csswg.org/css-syntax/#urange\r\n// Informally, the <urange> production has three forms:\r\n// U+0001\r\n//      Defines a range consisting of a single code point, in this case the code point \"1\".\r\n// U+0001-00ff\r\n//      Defines a range of codepoints between the first and the second value, in this case\r\n//      the range between \"1\" and \"ff\" (255 in decimal) inclusive.\r\n// U+00??\r\n//      Defines a range of codepoints where the \"?\" characters range over all hex digits,\r\n//      in this case defining the same as the value U+0000-00ff.\r\n// In each form, a maximum of 6 digits is allowed for each hexadecimal number (if you treat \"?\" as a hexadecimal digit).\r\n//\r\n// <urange> =\r\n//   u '+' <ident-token> '?'* |\r\n//   u <dimension-token> '?'* |\r\n//   u <number-token> '?'* |\r\n//   u <number-token> <dimension-token> |\r\n//   u <number-token> <number-token> |\r\n//   u '+' '?'+\r\nfunction scanUnicodeRange() {\r\n    var hexLength = 0;\r\n\r\n    // u '+' <ident-token> '?'*\r\n    // u '+' '?'+\r\n    if (this.scanner.isDelim(PLUSSIGN)) {\r\n        this.scanner.next();\r\n\r\n        if (this.scanner.tokenType === IDENT) {\r\n            hexLength = eatHexSequence.call(this, 0, true);\r\n            if (hexLength > 0) {\r\n                eatQuestionMarkSequence.call(this, 6 - hexLength);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (this.scanner.isDelim(QUESTIONMARK)) {\r\n            this.scanner.next();\r\n            eatQuestionMarkSequence.call(this, 5);\r\n            return;\r\n        }\r\n\r\n        this.error('Hex digit or question mark is expected');\r\n        return;\r\n    }\r\n\r\n    // u <number-token> '?'*\r\n    // u <number-token> <dimension-token>\r\n    // u <number-token> <number-token>\r\n    if (this.scanner.tokenType === NUMBER) {\r\n        startsWith.call(this, PLUSSIGN);\r\n        hexLength = eatHexSequence.call(this, 1, true);\r\n\r\n        if (this.scanner.isDelim(QUESTIONMARK)) {\r\n            eatQuestionMarkSequence.call(this, 6 - hexLength);\r\n            return;\r\n        }\r\n\r\n        if (this.scanner.tokenType === DIMENSION ||\r\n            this.scanner.tokenType === NUMBER) {\r\n            startsWith.call(this, HYPHENMINUS);\r\n            eatHexSequence.call(this, 1, false);\r\n            return;\r\n        }\r\n\r\n        return;\r\n    }\r\n\r\n    // u <dimension-token> '?'*\r\n    if (this.scanner.tokenType === DIMENSION) {\r\n        startsWith.call(this, PLUSSIGN);\r\n        hexLength = eatHexSequence.call(this, 1, true);\r\n\r\n        if (hexLength > 0) {\r\n            eatQuestionMarkSequence.call(this, 6 - hexLength);\r\n        }\r\n\r\n        return;\r\n    }\r\n\r\n    this.error();\r\n}\r\n\r\nmodule.exports = {\r\n    name: 'UnicodeRange',\r\n    structure: {\r\n        value: String\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n\r\n        // U or u\r\n        if (!cmpChar(this.scanner.source, start, U)) {\r\n            this.error('U is expected');\r\n        }\r\n\r\n        if (!cmpChar(this.scanner.source, start + 1, PLUSSIGN)) {\r\n            this.error('Plus sign is expected');\r\n        }\r\n\r\n        this.scanner.next();\r\n        scanUnicodeRange.call(this);\r\n\r\n        return {\r\n            type: 'UnicodeRange',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            value: this.scanner.substrToCursor(start)\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk(node.value);\r\n    }\r\n};\r\n","var isWhiteSpace = require('../../tokenizer').isWhiteSpace;\r\nvar cmpStr = require('../../tokenizer').cmpStr;\r\nvar TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar FUNCTION = TYPE.Function;\r\nvar URL = TYPE.Url;\r\nvar RIGHTPARENTHESIS = TYPE.RightParenthesis;\r\n\r\n// <url-token> | <function-token> <string> )\r\nmodule.exports = {\r\n    name: 'Url',\r\n    structure: {\r\n        value: ['String', 'Raw']\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n        var value;\r\n\r\n        switch (this.scanner.tokenType) {\r\n            case URL:\r\n                var rawStart = start + 4;\r\n                var rawEnd = this.scanner.tokenEnd - 1;\r\n\r\n                while (rawStart < rawEnd && isWhiteSpace(this.scanner.source.charCodeAt(rawStart))) {\r\n                    rawStart++;\r\n                }\r\n\r\n                while (rawStart < rawEnd && isWhiteSpace(this.scanner.source.charCodeAt(rawEnd - 1))) {\r\n                    rawEnd--;\r\n                }\r\n\r\n                value = {\r\n                    type: 'Raw',\r\n                    loc: this.getLocation(rawStart, rawEnd),\r\n                    value: this.scanner.source.substring(rawStart, rawEnd)\r\n                };\r\n\r\n                this.eat(URL);\r\n                break;\r\n\r\n            case FUNCTION:\r\n                if (!cmpStr(this.scanner.source, this.scanner.tokenStart, this.scanner.tokenEnd, 'url(')) {\r\n                    this.error('Function name must be `url`');\r\n                }\r\n\r\n                this.eat(FUNCTION);\r\n                this.scanner.skipSC();\r\n                value = this.String();\r\n                this.scanner.skipSC();\r\n                this.eat(RIGHTPARENTHESIS);\r\n                break;\r\n\r\n            default:\r\n                this.error('Url or Function is expected');\r\n        }\r\n\r\n        return {\r\n            type: 'Url',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            value: value\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk('url');\r\n        this.chunk('(');\r\n        this.node(node.value);\r\n        this.chunk(')');\r\n    }\r\n};\r\n","var WHITESPACE = require('../../tokenizer').TYPE.WhiteSpace;\r\nvar SPACE = Object.freeze({\r\n    type: 'WhiteSpace',\r\n    loc: null,\r\n    value: ' '\r\n});\r\n\r\nmodule.exports = {\r\n    name: 'WhiteSpace',\r\n    structure: {\r\n        value: String\r\n    },\r\n    parse: function() {\r\n        this.eat(WHITESPACE);\r\n        return SPACE;\r\n\r\n        // return {\r\n        //     type: 'WhiteSpace',\r\n        //     loc: this.getLocation(this.scanner.tokenStart, this.scanner.tokenEnd),\r\n        //     value: this.consume(WHITESPACE)\r\n        // };\r\n    },\r\n    generate: function(node) {\r\n        this.chunk(node.value);\r\n    }\r\n};\r\n","module.exports = {\r\n    AnPlusB: require('./AnPlusB'),\r\n    Atrule: require('./Atrule'),\r\n    AtrulePrelude: require('./AtrulePrelude'),\r\n    AttributeSelector: require('./AttributeSelector'),\r\n    Block: require('./Block'),\r\n    Brackets: require('./Brackets'),\r\n    CDC: require('./CDC'),\r\n    CDO: require('./CDO'),\r\n    ClassSelector: require('./ClassSelector'),\r\n    Combinator: require('./Combinator'),\r\n    Comment: require('./Comment'),\r\n    Declaration: require('./Declaration'),\r\n    DeclarationList: require('./DeclarationList'),\r\n    Dimension: require('./Dimension'),\r\n    Function: require('./Function'),\r\n    HexColor: require('./HexColor'),\r\n    Identifier: require('./Identifier'),\r\n    IdSelector: require('./IdSelector'),\r\n    MediaFeature: require('./MediaFeature'),\r\n    MediaQuery: require('./MediaQuery'),\r\n    MediaQueryList: require('./MediaQueryList'),\r\n    Nth: require('./Nth'),\r\n    Number: require('./Number'),\r\n    Operator: require('./Operator'),\r\n    Parentheses: require('./Parentheses'),\r\n    Percentage: require('./Percentage'),\r\n    PseudoClassSelector: require('./PseudoClassSelector'),\r\n    PseudoElementSelector: require('./PseudoElementSelector'),\r\n    Ratio: require('./Ratio'),\r\n    Raw: require('./Raw'),\r\n    Rule: require('./Rule'),\r\n    Selector: require('./Selector'),\r\n    SelectorList: require('./SelectorList'),\r\n    String: require('./String'),\r\n    StyleSheet: require('./StyleSheet'),\r\n    TypeSelector: require('./TypeSelector'),\r\n    UnicodeRange: require('./UnicodeRange'),\r\n    Url: require('./Url'),\r\n    Value: require('./Value'),\r\n    WhiteSpace: require('./WhiteSpace')\r\n};\r\n","module.exports = {\r\n    name: 'Nth',\r\n    structure: {\r\n        nth: ['AnPlusB', 'Identifier'],\r\n        selector: ['SelectorList', null]\r\n    },\r\n    parse: function(allowOfClause) {\r\n        this.scanner.skipSC();\r\n\r\n        var start = this.scanner.tokenStart;\r\n        var end = start;\r\n        var selector = null;\r\n        var query;\r\n\r\n        if (this.scanner.lookupValue(0, 'odd') || this.scanner.lookupValue(0, 'even')) {\r\n            query = this.Identifier();\r\n        } else {\r\n            query = this.AnPlusB();\r\n        }\r\n\r\n        this.scanner.skipSC();\r\n\r\n        if (allowOfClause && this.scanner.lookupValue(0, 'of')) {\r\n            this.scanner.next();\r\n\r\n            selector = this.SelectorList();\r\n\r\n            if (this.needPositions) {\r\n                end = this.getLastListNode(selector.children).loc.end.offset;\r\n            }\r\n        } else {\r\n            if (this.needPositions) {\r\n                end = query.loc.end.offset;\r\n            }\r\n        }\r\n\r\n        return {\r\n            type: 'Nth',\r\n            loc: this.getLocation(start, end),\r\n            nth: query,\r\n            selector: selector\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.node(node.nth);\r\n        if (node.selector !== null) {\r\n            this.chunk(' of ');\r\n            this.node(node.selector);\r\n        }\r\n    }\r\n};\r\n","module.exports = {\r\n    name: 'Selector',\r\n    structure: {\r\n        children: [[\r\n            'TypeSelector',\r\n            'IdSelector',\r\n            'ClassSelector',\r\n            'AttributeSelector',\r\n            'PseudoClassSelector',\r\n            'PseudoElementSelector',\r\n            'Combinator',\r\n            'WhiteSpace'\r\n        ]]\r\n    },\r\n    parse: function() {\r\n        var children = this.readSequence(this.scope.Selector);\r\n\r\n        // nothing were consumed\r\n        if (this.getFirstListNode(children) === null) {\r\n            this.error('Selector is expected');\r\n        }\r\n\r\n        return {\r\n            type: 'Selector',\r\n            loc: this.getLocationFromList(children),\r\n            children: children\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.children(node);\r\n    }\r\n};\r\n","module.exports = {\r\n    name: 'Value',\r\n    structure: {\r\n        children: [[]]\r\n    },\r\n    parse: function() {\r\n        var start = this.scanner.tokenStart;\r\n        var children = this.readSequence(this.scope.Value);\r\n\r\n        return {\r\n            type: 'Value',\r\n            loc: this.getLocation(start, this.scanner.tokenStart),\r\n            children: children\r\n        };\r\n    },\r\n    generate: function(node) {\r\n        this.children(node);\r\n    }\r\n};\r\n","var data = require('../../../data');\r\n\r\nmodule.exports = {\r\n    generic: true,\r\n    types: data.types,\r\n    atrules: data.atrules,\r\n    properties: data.properties,\r\n    node: require('../node')\r\n};\r\n","var cmpChar = require('../../tokenizer').cmpChar;\r\nvar cmpStr = require('../../tokenizer').cmpStr;\r\nvar TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar IDENT = TYPE.Ident;\r\nvar STRING = TYPE.String;\r\nvar NUMBER = TYPE.Number;\r\nvar FUNCTION = TYPE.Function;\r\nvar URL = TYPE.Url;\r\nvar HASH = TYPE.Hash;\r\nvar DIMENSION = TYPE.Dimension;\r\nvar PERCENTAGE = TYPE.Percentage;\r\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\r\nvar LEFTSQUAREBRACKET = TYPE.LeftSquareBracket;\r\nvar COMMA = TYPE.Comma;\r\nvar DELIM = TYPE.Delim;\r\nvar NUMBERSIGN = 0x0023;  // U+0023 NUMBER SIGN (#)\r\nvar ASTERISK = 0x002A;    // U+002A ASTERISK (*)\r\nvar PLUSSIGN = 0x002B;    // U+002B PLUS SIGN (+)\r\nvar HYPHENMINUS = 0x002D; // U+002D HYPHEN-MINUS (-)\r\nvar SOLIDUS = 0x002F;     // U+002F SOLIDUS (/)\r\nvar U = 0x0075;           // U+0075 LATIN SMALL LETTER U (u)\r\n\r\nmodule.exports = function defaultRecognizer(context) {\r\n    switch (this.scanner.tokenType) {\r\n        case HASH:\r\n            return this.HexColor();\r\n\r\n        case COMMA:\r\n            context.space = null;\r\n            context.ignoreWSAfter = true;\r\n            return this.Operator();\r\n\r\n        case LEFTPARENTHESIS:\r\n            return this.Parentheses(this.readSequence, context.recognizer);\r\n\r\n        case LEFTSQUAREBRACKET:\r\n            return this.Brackets(this.readSequence, context.recognizer);\r\n\r\n        case STRING:\r\n            return this.String();\r\n\r\n        case DIMENSION:\r\n            return this.Dimension();\r\n\r\n        case PERCENTAGE:\r\n            return this.Percentage();\r\n\r\n        case NUMBER:\r\n            return this.Number();\r\n\r\n        case FUNCTION:\r\n            return cmpStr(this.scanner.source, this.scanner.tokenStart, this.scanner.tokenEnd, 'url(')\r\n                ? this.Url()\r\n                : this.Function(this.readSequence, context.recognizer);\r\n\r\n        case URL:\r\n            return this.Url();\r\n\r\n        case IDENT:\r\n            // check for unicode range, it should start with u+ or U+\r\n            if (cmpChar(this.scanner.source, this.scanner.tokenStart, U) &&\r\n                cmpChar(this.scanner.source, this.scanner.tokenStart + 1, PLUSSIGN)) {\r\n                return this.UnicodeRange();\r\n            } else {\r\n                return this.Identifier();\r\n            }\r\n\r\n        case DELIM:\r\n            var code = this.scanner.source.charCodeAt(this.scanner.tokenStart);\r\n\r\n            if (code === SOLIDUS ||\r\n                code === ASTERISK ||\r\n                code === PLUSSIGN ||\r\n                code === HYPHENMINUS) {\r\n                return this.Operator(); // TODO: replace with Delim\r\n            }\r\n\r\n            // TODO: produce a node with Delim node type\r\n\r\n            if (code === NUMBERSIGN) {\r\n                this.error('Hex or identifier is expected', this.scanner.tokenStart + 1);\r\n            }\r\n\r\n            break;\r\n    }\r\n};\r\n","module.exports = {\r\n    getNode: require('./default')\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar DELIM = TYPE.Delim;\r\nvar IDENT = TYPE.Ident;\r\nvar DIMENSION = TYPE.Dimension;\r\nvar PERCENTAGE = TYPE.Percentage;\r\nvar NUMBER = TYPE.Number;\r\nvar HASH = TYPE.Hash;\r\nvar COLON = TYPE.Colon;\r\nvar LEFTSQUAREBRACKET = TYPE.LeftSquareBracket;\r\nvar NUMBERSIGN = 0x0023;      // U+0023 NUMBER SIGN (#)\r\nvar ASTERISK = 0x002A;        // U+002A ASTERISK (*)\r\nvar PLUSSIGN = 0x002B;        // U+002B PLUS SIGN (+)\r\nvar SOLIDUS = 0x002F;         // U+002F SOLIDUS (/)\r\nvar FULLSTOP = 0x002E;        // U+002E FULL STOP (.)\r\nvar GREATERTHANSIGN = 0x003E; // U+003E GREATER-THAN SIGN (>)\r\nvar VERTICALLINE = 0x007C;    // U+007C VERTICAL LINE (|)\r\nvar TILDE = 0x007E;           // U+007E TILDE (~)\r\n\r\nfunction getNode(context) {\r\n    switch (this.scanner.tokenType) {\r\n        case LEFTSQUAREBRACKET:\r\n            return this.AttributeSelector();\r\n\r\n        case HASH:\r\n            return this.IdSelector();\r\n\r\n        case COLON:\r\n            if (this.scanner.lookupType(1) === COLON) {\r\n                return this.PseudoElementSelector();\r\n            } else {\r\n                return this.PseudoClassSelector();\r\n            }\r\n\r\n        case IDENT:\r\n            return this.TypeSelector();\r\n\r\n        case NUMBER:\r\n        case PERCENTAGE:\r\n            return this.Percentage();\r\n\r\n        case DIMENSION:\r\n            // throws when .123ident\r\n            if (this.scanner.source.charCodeAt(this.scanner.tokenStart) === FULLSTOP) {\r\n                this.error('Identifier is expected', this.scanner.tokenStart + 1);\r\n            }\r\n            break;\r\n\r\n        case DELIM:\r\n            var code = this.scanner.source.charCodeAt(this.scanner.tokenStart);\r\n\r\n            switch (code) {\r\n                case PLUSSIGN:\r\n                case GREATERTHANSIGN:\r\n                case TILDE:\r\n                    context.space = null;\r\n                    context.ignoreWSAfter = true;\r\n                    return this.Combinator();\r\n\r\n                case SOLIDUS:  // /deep/\r\n                    return this.Combinator();\r\n\r\n                case FULLSTOP:\r\n                    return this.ClassSelector();\r\n\r\n                case ASTERISK:\r\n                case VERTICALLINE:\r\n                    return this.TypeSelector();\r\n\r\n                case NUMBERSIGN:\r\n                    return this.IdSelector();\r\n            }\r\n\r\n            break;\r\n    }\r\n};\r\n\r\nmodule.exports = {\r\n    getNode: getNode\r\n};\r\n","// https://drafts.csswg.org/css-images-4/#element-notation\r\n// https://developer.mozilla.org/en-US/docs/Web/CSS/element\r\nmodule.exports = function() {\r\n    this.scanner.skipSC();\r\n\r\n    var children = this.createSingleNodeList(\r\n        this.IdSelector()\r\n    );\r\n\r\n    this.scanner.skipSC();\r\n\r\n    return children;\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\nvar rawMode = require('../node/Raw').mode;\r\n\r\nvar COMMA = TYPE.Comma;\r\n\r\n// var( <ident> , <value>? )\r\nmodule.exports = function() {\r\n    var children = this.createList();\r\n\r\n    this.scanner.skipSC();\r\n\r\n    // NOTE: Don't check more than a first argument is an ident, rest checks are for lexer\r\n    children.push(this.Identifier());\r\n\r\n    this.scanner.skipSC();\r\n\r\n    if (this.scanner.tokenType === COMMA) {\r\n        children.push(this.Operator());\r\n        children.push(this.parseCustomProperty\r\n            ? this.Value(null)\r\n            : this.Raw(this.scanner.tokenIndex, rawMode.exclamationMarkOrSemicolon, false)\r\n        );\r\n    }\r\n\r\n    return children;\r\n};\r\n","module.exports = {\r\n    AtrulePrelude: require('./atrulePrelude'),\r\n    Selector: require('./selector'),\r\n    Value: require('./value')\r\n};\r\n","module.exports = {\r\n    getNode: require('./default'),\r\n    '-moz-element': require('../function/element'),\r\n    'element': require('../function/element'),\r\n    'expression': require('../function/expression'),\r\n    'var': require('../function/var')\r\n};\r\n","// legacy IE function\r\n// expression( <any-value> )\r\nmodule.exports = function() {\r\n    return this.createSingleNodeList(\r\n        this.Raw(this.scanner.tokenIndex, null, false)\r\n    );\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar STRING = TYPE.String;\r\nvar IDENT = TYPE.Ident;\r\nvar URL = TYPE.Url;\r\nvar FUNCTION = TYPE.Function;\r\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\r\n\r\nmodule.exports = {\r\n    parse: {\r\n        prelude: function() {\r\n            var children = this.createList();\r\n\r\n            this.scanner.skipSC();\r\n\r\n            switch (this.scanner.tokenType) {\r\n                case STRING:\r\n                    children.push(this.String());\r\n                    break;\r\n\r\n                case URL:\r\n                case FUNCTION:\r\n                    children.push(this.Url());\r\n                    break;\r\n\r\n                default:\r\n                    this.error('String or url() is expected');\r\n            }\r\n\r\n            if (this.lookupNonWSType(0) === IDENT ||\r\n                this.lookupNonWSType(0) === LEFTPARENTHESIS) {\r\n                children.push(this.WhiteSpace());\r\n                children.push(this.MediaQueryList());\r\n            }\r\n\r\n            return children;\r\n        },\r\n        block: null\r\n    }\r\n};\r\n","var TYPE = require('../../tokenizer').TYPE;\r\n\r\nvar WHITESPACE = TYPE.WhiteSpace;\r\nvar COMMENT = TYPE.Comment;\r\nvar IDENT = TYPE.Ident;\r\nvar FUNCTION = TYPE.Function;\r\nvar COLON = TYPE.Colon;\r\nvar LEFTPARENTHESIS = TYPE.LeftParenthesis;\r\n\r\nfunction consumeRaw() {\r\n    return this.createSingleNodeList(\r\n        this.Raw(this.scanner.tokenIndex, null, false)\r\n    );\r\n}\r\n\r\nfunction parentheses() {\r\n    this.scanner.skipSC();\r\n\r\n    if (this.scanner.tokenType === IDENT &&\r\n        this.lookupNonWSType(1) === COLON) {\r\n        return this.createSingleNodeList(\r\n            this.Declaration()\r\n        );\r\n    }\r\n\r\n    return readSequence.call(this);\r\n}\r\n\r\nfunction readSequence() {\r\n    var children = this.createList();\r\n    var space = null;\r\n    var child;\r\n\r\n    this.scanner.skipSC();\r\n\r\n    scan:\r\n    while (!this.scanner.eof) {\r\n        switch (this.scanner.tokenType) {\r\n            case WHITESPACE:\r\n                space = this.WhiteSpace();\r\n                continue;\r\n\r\n            case COMMENT:\r\n                this.scanner.next();\r\n                continue;\r\n\r\n            case FUNCTION:\r\n                child = this.Function(consumeRaw, this.scope.AtrulePrelude);\r\n                break;\r\n\r\n            case IDENT:\r\n                child = this.Identifier();\r\n                break;\r\n\r\n            case LEFTPARENTHESIS:\r\n                child = this.Parentheses(parentheses, this.scope.AtrulePrelude);\r\n                break;\r\n\r\n            default:\r\n                break scan;\r\n        }\r\n\r\n        if (space !== null) {\r\n            children.push(space);\r\n            space = null;\r\n        }\r\n\r\n        children.push(child);\r\n    }\r\n\r\n    return children;\r\n}\r\n\r\nmodule.exports = {\r\n    parse: {\r\n        prelude: function() {\r\n            var children = readSequence.call(this);\r\n\r\n            if (this.getFirstListNode(children) === null) {\r\n                this.error('Condition is expected');\r\n            }\r\n\r\n            return children;\r\n        },\r\n        block: function() {\r\n            return this.Block(false);\r\n        }\r\n    }\r\n};\r\n","module.exports = {\r\n    parse: function selectorList() {\r\n        return this.createSingleNodeList(\r\n            this.SelectorList()\r\n        );\r\n    }\r\n};\r\n","var ALLOW_OF_CLAUSE = true;\r\n\r\nmodule.exports = {\r\n    parse: function nthWithOfClause() {\r\n        return this.createSingleNodeList(\r\n            this.Nth(ALLOW_OF_CLAUSE)\r\n        );\r\n    }\r\n};\r\n","var DISALLOW_OF_CLAUSE = false;\r\n\r\nmodule.exports = {\r\n    parse: function nth() {\r\n        return this.createSingleNodeList(\r\n            this.Nth(DISALLOW_OF_CLAUSE)\r\n        );\r\n    }\r\n};\r\n","module.exports = {\r\n    parseContext: {\r\n        default: 'StyleSheet',\r\n        stylesheet: 'StyleSheet',\r\n        atrule: 'Atrule',\r\n        atrulePrelude: function(options) {\r\n            return this.AtrulePrelude(options.atrule ? String(options.atrule) : null);\r\n        },\r\n        mediaQueryList: 'MediaQueryList',\r\n        mediaQuery: 'MediaQuery',\r\n        rule: 'Rule',\r\n        selectorList: 'SelectorList',\r\n        selector: 'Selector',\r\n        block: function() {\r\n            return this.Block(true);\r\n        },\r\n        declarationList: 'DeclarationList',\r\n        declaration: 'Declaration',\r\n        value: 'Value'\r\n    },\r\n    scope: require('../scope'),\r\n    atrule: require('../atrule'),\r\n    pseudo: require('../pseudo'),\r\n    node: require('../node')\r\n};\r\n","module.exports = {\r\n    'font-face': require('./font-face'),\r\n    'import': require('./import'),\r\n    'media': require('./media'),\r\n    'page': require('./page'),\r\n    'supports': require('./supports')\r\n};\r\n","module.exports = {\r\n    parse: {\r\n        prelude: null,\r\n        block: function() {\r\n            return this.Block(true);\r\n        }\r\n    }\r\n};\r\n","module.exports = {\r\n    parse: {\r\n        prelude: function() {\r\n            return this.createSingleNodeList(\r\n                this.MediaQueryList()\r\n            );\r\n        },\r\n        block: function() {\r\n            return this.Block(false);\r\n        }\r\n    }\r\n};\r\n","module.exports = {\r\n    parse: {\r\n        prelude: function() {\r\n            return this.createSingleNodeList(\r\n                this.SelectorList()\r\n            );\r\n        },\r\n        block: function() {\r\n            return this.Block(true);\r\n        }\r\n    }\r\n};\r\n","module.exports = {\r\n    'dir': require('./dir'),\r\n    'has': require('./has'),\r\n    'lang': require('./lang'),\r\n    'matches': require('./matches'),\r\n    'not': require('./not'),\r\n    'nth-child': require('./nth-child'),\r\n    'nth-last-child': require('./nth-last-child'),\r\n    'nth-last-of-type': require('./nth-last-of-type'),\r\n    'nth-of-type': require('./nth-of-type'),\r\n    'slotted': require('./slotted')\r\n};\r\n","module.exports = {\r\n    parse: function() {\r\n        return this.createSingleNodeList(\r\n            this.Identifier()\r\n        );\r\n    }\r\n};\r\n","module.exports = {\r\n    parse: function() {\r\n        return this.createSingleNodeList(\r\n            this.SelectorList()\r\n        );\r\n    }\r\n};\r\n","module.exports = {\r\n    parse: function() {\r\n        return this.createSingleNodeList(\r\n            this.Identifier()\r\n        );\r\n    }\r\n};\r\n","module.exports = require('./common/selectorList');\r\n","module.exports = require('./common/selectorList');\r\n","module.exports = require('./common/nthWithOfClause');\r\n","module.exports = require('./common/nthWithOfClause');\r\n","module.exports = require('./common/nth');\r\n","module.exports = require('./common/nth');\r\n","module.exports = {\r\n    parse: function compoundSelector() {\r\n        return this.createSingleNodeList(\r\n            this.Selector()\r\n        );\r\n    }\r\n};\r\n","module.exports = {\r\n    node: require('../node')\r\n};\r\n","module.exports = require('./syntax');\r\n","function merge() {\r\n    var dest = {};\r\n\r\n    for (var i = 0; i < arguments.length; i++) {\r\n        var src = arguments[i];\r\n        for (var key in src) {\r\n            dest[key] = src[key];\r\n        }\r\n    }\r\n\r\n    return dest;\r\n}\r\n\r\nmodule.exports = require('./create').create(\r\n    merge(\r\n        require('./config/lexer'),\r\n        require('./config/parser'),\r\n        require('./config/walker')\r\n    )\r\n);\r\n","import isNumber from 'lodash.isnumber'\nimport isPlainObject from 'lodash.isplainobject'\nimport isString from 'lodash.isstring'\nimport { parse, walk, lexer } from 'css-tree-animatable'\nimport patch from 'css-tree-animatable/data/patch.json'\nimport mdnProperties from 'mdn-data-animatable/css/properties.json'\nimport mdnSyntaxes from 'mdn-data-animatable/css/syntaxes.json'\nimport nonAnimatable from 'mdn-data-animatable/css/non-animatable.json'\nimport popularIndex from './popularIndex.json'\n\nconst properties = []\nObject.keys(lexer.properties).forEach((key) => {\n  if (!nonAnimatable.includes(key)) {\n    properties.push(key)\n  }\n})\n\nconst isAnimatable = (value, returnCssProperty = false) => {\n  let property = value.toLowerCase().trim()\n  if (property === 'cssoffset') {\n    property = property.substr(3)\n  }\n  if (properties.includes(property)) {\n    return returnCssProperty ? property : true\n  }\n  if (property.includes('-')) {\n    return returnCssProperty ? '' : false\n  }\n  property = property.replace(/-/g, '')\n  for (const prop of properties) {\n    if (property === prop.replace(/-/g, '')) {\n      return returnCssProperty ? prop : true\n    }\n  }\n  return returnCssProperty ? '' : false\n}\n\nconst cssToJs = (value, webAnimationsAPI = true) => {\n  let property = isAnimatable(value, true)\n  if (!property) {\n    return ''\n  }\n  if (webAnimationsAPI) {\n    if (property === 'offset') {\n      property = 'css-' + property\n    }\n  }\n  return property.replace(/-([a-z])/g, (match, letter) => {\n    return letter.toUpperCase()\n  })\n}\n\nconst jsToCss = (value) => {\n  return isAnimatable(value, true)\n}\n\nconst popular = (start = 0, end = 10) => {\n  const popular = []\n  let notInPopular\n  if (end >= popularIndex.length) {\n    notInPopular = properties.filter((property) => !popularIndex.includes(properties.indexOf(property)))\n  }\n  for (let i = start; i < end; i++) {\n    if (popularIndex[i] || popularIndex[i] === 0) {\n      popular.push(properties[popularIndex[i]])\n    } else {\n      const property = notInPopular[i - popularIndex.length]\n      if (!property) {\n        break\n      }\n      popular.push(property)\n    }\n  }\n  return popular\n}\n\nconst syntaxes = { main: '', links: {}, order: [] }\n\nconst getSyntaxes = (syntax) => {\n  const propertyMatches = syntax.match(/<'[a-zA-Z0-9-()]+'>/g)\n  if (Array.isArray(propertyMatches)) {\n    propertyMatches.forEach((key) => {\n      const prop = key.slice(2, -2)\n      const propertySyntax = mdnProperties[prop]\n      syntaxes[key] = propertySyntax.syntax\n      syntaxes.order.push(key)\n      getSyntaxes(propertySyntax.syntax)\n    })\n  }\n  const syntaxMatches = syntax.match(/<[a-zA-Z0-9-()]+>/g)\n  if (Array.isArray(syntaxMatches)) {\n    syntaxMatches.forEach((key) => {\n      const prop = key.slice(1, -1)\n      if (!syntaxes[key]) {\n        const syntaxSyntax = mdnSyntaxes[prop]\n        const patchSyntax = patch.syntaxes[prop]\n        if (syntaxSyntax) {\n          syntaxes[key] = syntaxSyntax.syntax\n          syntaxes.order.push(key)\n          getSyntaxes(syntaxSyntax.syntax)\n        } else if (patchSyntax) {\n          syntaxes[key] = patchSyntax.syntax\n          syntaxes.order.push(key)\n          getSyntaxes(patchSyntax.syntax)\n        } else if (!['url-token', 'any-value', 'function-token', 'hex-color', 'declaration-value', 'hash-token', 'zero'].includes(prop)) {\n          syntaxes.links[key] = 'https://developer.mozilla.org/docs/Web/CSS/' + prop.replace(/flex/, 'flex_value')\n        }\n      }\n    })\n  }\n}\n\nconst syntax = (value) => {\n  for (const member in syntaxes) delete syntaxes[member]\n  syntaxes.main = ''\n  syntaxes.links = {}\n  syntaxes.order = []\n  const property = isAnimatable(value, true)\n  if (property) {\n    const syntax = mdnProperties[property].syntax\n    syntaxes.main = syntax\n    getSyntaxes(syntax)\n  } else {\n    syntaxes.main = `Error: ${value} is not an animatable CSS property.`\n  }\n  return syntaxes\n}\n\nconst validate = (obj, returnError = true) => {\n  const errors = []\n  if (!isPlainObject(obj)) {\n    errors.push({ name: 'TypeError', message: 'Argument is not a plain object.' })\n  } else {\n    for (let [key, value] of Object.entries(obj)) {\n      if (!isString(value) && !isNumber(value)) {\n        errors.push({ name: 'TypeError', message: 'Property value must be a string or a number. ' + typeof value + ' given.' })\n      } else {\n        const property = isAnimatable(key, true)\n        if (!property) {\n          errors.push({ name: 'MatchError', message: key + ' is not an animatable CSS property.' })\n        } else {\n          let ast\n          try {\n            ast = parse(`${property}: ${value}`, {\n              context: 'declaration',\n              onParseError: (error) => {\n                errors.push(error)\n              },\n            })\n            walk(ast, {\n              visit: 'Declaration',\n              enter: function (node) {\n                const error = lexer.matchDeclaration(node).error\n                if (error) {\n                  errors.push(error)\n                }\n              },\n            })\n          } catch (error) {\n            errors.push(error)\n          }\n        }\n      }\n    }\n  }\n  return !errors.length ? true : returnError ? errors[errors.length - 1] : false\n}\n\nconst propertyFormat = (property, format) => {\n  switch (format) {\n    case 'css':\n      property = jsToCss(property)\n      break\n    case 'js':\n      property = cssToJs(property, false)\n      break\n    default:\n      property = cssToJs(property)\n  }\n  return property\n}\n\nconst sanitize = (obj, format = 'waapi') => {\n  format = format.toString().toLowerCase()\n  let sanitized = {}\n  if (Array.isArray(obj)) {\n    sanitized = []\n    obj.forEach((key) => {\n      const property = isAnimatable(key, true)\n      if (property) {\n        sanitized.push(propertyFormat(property, format))\n      }\n    })\n  } else if (isPlainObject(obj)) {\n    for (let [key, value] of Object.entries(obj)) {\n      const object = {}\n      object[key] = value\n      if (validate(object, false)) {\n        sanitized[propertyFormat(key, format)] = value\n      }\n    }\n  } else if (isString(obj)) {\n    switch (format) {\n      case 'css':\n        return jsToCss(obj)\n      case 'js':\n        return cssToJs(obj, false)\n      default:\n        return cssToJs(obj)\n    }\n  }\n  return sanitized\n}\n\nexport default {\n  properties: properties,\n  cssToJs: cssToJs,\n  jsToCss: jsToCss,\n  isAnimatable: isAnimatable,\n  popular: popular,\n  syntax: syntax,\n  validate: validate,\n  sanitize: sanitize,\n}\n","import functions from './functions'\n\nexport default {\n  properties: functions.properties.map((val) => functions.cssToJs(val)),\n  propertiesCSS: functions.properties,\n  propertiesJS: functions.properties.map((val) => functions.cssToJs(val, false)),\n}\n","import arrays from './arrays'\nimport functions from './functions'\n\nexport const properties = arrays.properties\nexport const propertiesCSS = arrays.propertiesCSS\nexport const propertiesJS = arrays.propertiesJS\nexport const cssToJs = functions.cssToJs\nexport const jsToCss = functions.jsToCss\nexport const isAnimatable = functions.isAnimatable\nexport const popular = functions.popular\nexport const syntax = functions.syntax\nexport const validate = functions.validate\nexport const sanitize = functions.sanitize\n"],"names":["objectToString","Object","prototype","toString","lodash_isnumber","value","isObjectLike","call","funcProto","Function","objectProto","funcToString","hasOwnProperty","objectCtorString","getPrototype","func","transform","arg","overArg","getPrototypeOf","lodash_isplainobject","result","e","isHostObject","proto","Ctor","constructor","isArray","Array","lodash_isstring","createItem","data","prev","next","allocateCursor","node","cursor","cursors","releaseCursor","List","this","head","tail","updateCursors","prevOld","prevNew","nextOld","nextNew","getSize","size","fromArray","array","i","length","item","toArray","push","toJSON","isEmpty","first","last","each","fn","context","undefined","forEach","eachRight","forEachRight","nextUntil","start","prevUntil","some","map","appendData","filter","clear","copy","insert","prepend","prependData","append","before","Error","insertData","remove","pop","unshift","shift","prependList","list","insertList","appendList","replace","oldItem","newItemOrList","List_1","createCustomError","name","message","error","create","SyntaxError","errorStack","defineProperty","get","stack","require$$0","TAB_REPLACEMENT","sourceFragment","extraLines","processLines","end","lines","slice","line","idx","num","String","maxNumLength","join","source","split","column","startLine","Math","max","endLine","min","cutLeft","substr","match","OFFSET_CORRECTION","MAX_LINE_LENGTH","Boolean","_SyntaxError","offset","isNaN","parseError","TYPE","EOF","Ident","AtKeyword","Hash","BadString","Url","BadUrl","Delim","Number","Percentage","Dimension","WhiteSpace","CDO","CDC","Colon","Semicolon","Comma","LeftSquareBracket","RightSquareBracket","LeftParenthesis","RightParenthesis","LeftCurlyBracket","RightCurlyBracket","Comment","NAME","keys","reduce","key","_const","isDigit","code","isUppercaseLetter","isLowercaseLetter","isLetter","isNonAscii","isNameStart","isNonPrintable","isNewline","isWhiteSpace","isValidEscape","second","CATEGORY","Eof","Digit","NameStart","NonPrintable","charCodeCategory","charCodeDefinitions","isHexDigit","isName","isIdentifierStart","third","isNumberStart","isBOM","getCharCode","charCodeAt","getNewlineLength","cmpChar","testStr","referenceCode","findDecimalNumberEnd","consumeEscaped","maxOffset","utils","consumeName","consumeNumber","sign","consumeBadUrlRemnants","cmpStr","referenceStr","testCode","findWhiteSpaceStart","findWhiteSpaceEnd","require$$1","WHITESPACE","COMMENT","OFFSET_MASK","TYPE_SHIFT","TokenStream","offsetAndType","balance","reset","eof","tokenIndex","tokenType","tokenStart","firstCharOffset","tokenEnd","lookupType","tokenCount","lookupOffset","lookupValue","getTokenStart","getRawLength","startToken","mode","balanceEnd","loop","isBalanceEdge","pos","isDelim","getTokenValue","substring","getTokenLength","substrToCursor","skipWS","skipTokenCount","skip","skipSC","dump","type","chunk","TokenStream_1","noop","generate","decorate","forceBraces","compact","multiplier","combinator","terms","term","explicit","generateSequence","disallowEmpty","comma","opts","generateTypeOpts","generate_1","options","getLocation","point","loc","referenceName","reference","syntax","matchResult","details","tokens","longestMatch","mismatchOffset","entries","css","fromMatchResult","badNode","rawMessage","keywords","properties","isCustomProperty","str","getVendorPrefix","secondDashIndex","indexOf","names","keyword","toLowerCase","custom","vendor","freeze","basename","prefix","property","hack","vendorPrefix","SafeUint32Array","Uint32Array","adoptBuffer","buffer","constants","require$$2","require$$3","require$$4","tokenize","stream","sourceLength","consumeNumericToken","consumeIdentLikeToken","nameStartOffset","consumeUrlToken","consumeStringToken","endingCodePoint","nextCode","balanceCloseType","balanceStart","balancePrev","tokenizer","DELIM","IDENT","NUMBER","DIMENSION","HYPHENMINUS","DISALLOW_SIGN","token","getNextToken","checkInteger","valueOffset","disallowSign","consumeB","offset_","startsWith","hexSequence","allowDash","hexlen","withQuestionMarkSequence","consumed","anPlusB","urange","consumedHexLength","cssWideKeywords","calcFunctionNames","charCode","index","eqStr","actual","expected","eqStrAny","isPostfixIeHack","outOfRange","numEnd","consumeFunction","startIdx","calc","expectedTokenType","dimension","numberEnd","reverseSolidusOffset","unit","zero","generic","ident-token","function-token","at-keyword-token","hash-token","string-token","bad-string-token","url-token","bad-url-token","delim-token","number-token","percentage-token","dimension-token","whitespace-token","CDO-token","CDC-token","colon-token","semicolon-token","comma-token","[-token","]-token","(-token",")-token","{-token","}-token","string","ident","custom-ident","custom-property-name","hex-color","id-selector","an-plus-b","declaration-value","level","scan","any-value","angle","deg","grad","rad","turn","decibel","db","frequency","hz","khz","flex","fr","px","mm","cm","in","pt","pc","q","em","ex","ch","rem","vh","vw","vmin","vmax","vm","resolution","dpi","dpcm","dppx","x","semitones","st","time","s","ms","percentage","number","integer","-ms-legacy-expression","input","Tokenizer","nextCharCode","nextNonWsCode","findWsEnd","substringToPos","eat","fromCharCode","peek","charAt","LEFTCURLYBRACKET","NAME_CHAR","createCharMap","test","COMBINATOR_PRECEDENCE"," ","&&","||","|","scanSpaces","scanWord","scanNumber","scanString","readMultiplierRange","maybeMultiplied","range","readMultiplier","maybeToken","readType","readTypeRange","regroupTerms","combinators","createGroup","sort","a","b","subgroupStart","splice","readImplicitGroup","prevToken","prevTokenPos","readKeywordOrFunction","readGroup","readProperty","parse","parse_1","ensureFunction","walk","enter","leave","tokenStream","astToTokens","decorator","handlers","curNode","len","nodes","children","tmp","prepareTokens","nodesOffset","nodesIndex","currentNode","MATCH","MISMATCH","DISALLOW_EMPTY","createCondition","thenBranch","elseBranch","else","then","isFunctionType","isEnumCapatible","buildGroupMatchGraph","atLeastOneTermMatched","all","thenClause","newGroupTerm","buildMatchGraph","matchTerm","buildMultiplierMatchGraph","matchGraph","syntaxTree","ref","EXIT_REASON_MATCH","reverseList","areStringsEqualCaseInsensitive","isCommaContextStart","isCommaContextEnd","internalMatch","state","syntaxes","moveToNextToken","nextIndex","stateSnapshotFromSyntax","nextState","matchStack","syntaxStack","thenStack","pushThenStack","pushElseStack","elseStack","addTokenToMatch","syntaxStash","closeSyntax","iterationCount","exitReason","mask","matchFlag","lastTokenIndex","floor","syntaxDict","dictSyntax","keywordName","console","warn","reason","iterations","host","hostStack","getTrace","shouldPutToTrace","matched","hasMatch","matchNode","testNode","trace","isType","isProperty","isKeyword","getFirstMatchNode","getLastMatchNode","search","matchFragments","lexer","ast","fragments","findFragments","parent","isValidNumber","isFinite","isValidLocation","createNodeStructureChecker","fields","valid","fieldType","processStructure","nodeType","structure","docs","docsTypes","fieldTypes","check","SyntaxReferenceError","MatchError","require$$5","require$$7","matchAsTree","require$$8","require$$9","require$$10","getStructureFromConfig","config","cssWideKeywordsWithExpression","dumpMapSyntax","syntaxAsAst","buildMatchResult","matchSyntax","useCommon","valueHasVar","valueCommonSyntax","Lexer","atrules","types","addType_","addAtrule_","addProperty_","checkStructure","collectWarning","warns","createDescriptor","descriptor","prelude","descriptors","res","matchAtrulePrelude","atruleName","atrule","atrulePreludeSyntax","getAtrulePrelude","matchAtruleDescriptor","descriptorName","atruleEntry","atruleDescriptorSyntax","matchDeclaration","matchProperty","propertyName","propertySyntax","getProperty","matchType","typeName","typeSyntax","getType","findValueFragments","findDeclarationValueFragments","declaration","findAllFragments","visit","apply","bind","getAtruleDescriptor","declarators","validate","broken","brokenMap","brokenTypes","brokenProperties","pretty","JSON","stringify","Lexer_1","definitionSyntax","OffsetToLocation","columns","linesAndColumnsComputed","setSource","startOffset","startColumn","ensureLinesAndColumnsComputed","computeLinesAndColumns","filename","getLocationRange","OffsetToLocation_1","require$$6","sequence","recognizer","createList","child","space","ignoreWS","ignoreWSAfter","scanner","getNode","FUNCTION","URL","HASH","PERCENTAGE","createParseContext","processChildren","delimeter","invokeForType","getWalkersFromStructure","walkers","walker","nullable","walkContext","createTypeIterator","reverse","contextName","useContext","prevContextValue","field","createFastTraveralMap","iterators","Atrule","StyleSheet","Rule","Block","Declaration","DeclarationList","shape","parseContext","scope","pseudo","isObject","assign","extend","dest","src","mix","innerShape","k","createParser","parser","locationMap","needPositions","onParseError","onParseErrorThrow","parseAtrulePrelude","parseRulePrelude","parseValue","parseCustomProperty","readSequence","createSingleNodeList","getFirstListNode","getLastListNode","parseWithFallback","consumer","fallback","fallbackNode","lookupNonWSType","consume","consumeFunctionName","getLocationFromList","location","parserConfig","processConfig","positions","createGenerator","processNode","createConvertor","fromPlainObject","toPlainObject","createWalker","getTypesFromConfig","iteratorsNatural","iteratorsReverse","fastTraversalIteratorsNatural","fastTraversalIteratorsReverse","root","stylesheet","atrulePrelude","rule","selector","block","function","walkNode","find","found","findLast","findAll","clone","require$$11","createSyntax","convert","createLexer","fork","extension","base","mdnAtrules","mdnProperties","patch","buildDictionary","dict","patchDict","trim","preprocessAtrules","PLUSSIGN","N","checkTokenIsInteger","expectCharCode","msg","AnPlusB","getOffsetExcludeWS","Raw","excludeWhiteSpace","endOffset","default","leftCurlyBracket","leftCurlyBracketOrSemicolon","exclamationMarkOrSemicolon","semicolonIncluded","rawMode","ATKEYWORD","SEMICOLON","RIGHTCURLYBRACKET","consumeRaw","isDeclarationBlockAtrule","nameLowerCase","AtrulePrelude","STRING","COLON","LEFTSQUAREBRACKET","RIGHTSQUAREBRACKET","getAttributeName","expectIdent","checkColon","getOperator","AttributeSelector","matcher","flags","Identifier","flagsPrefix","consumeRule","consumeRawDeclaration","consumeDeclaration","isDeclaration","Brackets","CDC_1","CDO_1","ClassSelector","Combinator","consumeValueRaw","consumeCustomPropertyRaw","consumeValue","startValueToken","Value","important","customProperty","getImportant","RIGHTPARENTHESIS","_Function","HexColor","IdSelector","LEFTPARENTHESIS","MediaFeature","Ratio","MediaQuery","COMMA","MediaQueryList","relative","_Number","Operator","Parentheses","PseudoClassSelector","PseudoElementSelector","left","right","consumePrelude","SelectorList","Selector","_String","eatIdentifierOrAsterisk","TypeSelector","eatHexSequence","eatQuestionMarkSequence","count","scanUnicodeRange","hexLength","UnicodeRange","rawStart","rawEnd","SPACE","require$$12","require$$13","require$$14","require$$15","require$$16","require$$17","require$$18","require$$19","require$$20","Nth","nth","allowOfClause","query","require$$22","require$$23","require$$24","require$$25","require$$26","require$$27","require$$28","require$$29","require$$30","require$$32","require$$33","require$$34","require$$35","require$$36","require$$37","_default","element","-moz-element","expression","var","_import","parentheses","selectorList","nthWithOfClause","mediaQueryList","mediaQuery","declarationList","font-face","import","media","page","supports","dir","has","lang","matches","not","nth-child","nth-last-child","nth-last-of-type","nth-of-type","slotted","lib","arguments","merge","nonAnimatable","includes","isAnimatable","returnCssProperty","prop","cssToJs","webAnimationsAPI","letter","toUpperCase","jsToCss","main","links","order","getSyntaxes","propertyMatches","syntaxMatches","syntaxSyntax","mdnSyntaxes","patchSyntax","obj","returnError","errors","isPlainObject","isString","isNumber","propertyFormat","format","popular","notInPopular","popularIndex","member","sanitize","sanitized","object","functions","val","propertiesCSS","propertiesJS","arrays"],"mappings":"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"}